<!DOCTYPE html>

<html>
<head>
  <title>Default Binding Handlers</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1>Default Binding Handlers</h1>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2>data-if</h2>
<p>Adds a handler to show or hide the element if the value is truthy or falsey. Actually removes the element from the DOM
when hidden, replacing it with a non-visible placeholder.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">data-if</span>=<span class="value">"user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/account"</span>&gt;</span>My Account<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">data-if</span>=<span class="value">"user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/logout"</span>&gt;</span>Sign Out<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">data-if</span>=<span class="value">"!user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/login"</span>&gt;</span>Sign In<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>
<p><em>Result if <code>user</code> is null:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">style</span>=<span class="value">"display:none"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/account"</span>&gt;</span>My Account<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">style</span>=<span class="value">"display:none"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/logout"</span>&gt;</span>Sign Out<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/login"</span>&gt;</span>Sign In<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addHandler <span class="string">'if'</span>, (element, expr, controller) -&gt;
	placeholder = $(<span class="string">'&lt;script type="text/if-placeholder"&gt;&lt;!--'</span> + expr + <span class="string">'--&gt;&lt;/script&gt;'</span>).remove().get(<span class="number">0</span>)
	elem = element.get(<span class="number">0</span>)
	
	controller.watch expr, (value) -&gt;
		<span class="keyword">if</span> value
			<span class="keyword">unless</span> elem.parentNode
				placeholder.parentNode.replaceChild elem, placeholder
		<span class="keyword">else</span>
			<span class="keyword">unless</span> placeholder.parentNode
				elem.parentNode.replaceChild placeholder, elem</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2>data-text</h2>
<p>Adds a handler to display text inside an element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span> <span class="attribute">data-text</span>=<span class="value">"post.title"</span>&gt;</span>Title<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"info"</span>&gt;</span>
  Written by
  <span class="tag">&lt;<span class="title">span</span> <span class="attribute">data-text</span>=<span class="value">"post.author.name"</span>&gt;</span>author<span class="tag">&lt;/<span class="title">span</span>&gt;</span>
  on
  <span class="tag">&lt;<span class="title">span</span> <span class="attribute">data-text</span>=<span class="value">"post.date.toLocaleDateString()"</span>&gt;</span>date<span class="tag">&lt;/<span class="title">span</span>&gt;</span>.
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span>&gt;</span>Little Red<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"info"</span>&gt;</span>
  Written by
  <span class="tag">&lt;<span class="title">span</span>&gt;</span>Jacob Wright<span class="tag">&lt;/<span class="title">span</span>&gt;</span>
  on
  <span class="tag">&lt;<span class="title">span</span>&gt;</span>10/16/2013<span class="tag">&lt;/<span class="title">span</span>&gt;</span>.
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addHandler <span class="string">'text'</span>, (element, expr, controller) -&gt;
	controller.watch expr, (value) -&gt;
		element.text(<span class="keyword">if</span> value? <span class="keyword">then</span> value <span class="keyword">else</span> <span class="string">''</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2>data-html</h2>
<p>Adds a handler to display unescaped HTML inside an element. Be sure it&#39;s trusted!</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span> <span class="attribute">data-text</span>=<span class="value">"post.title"</span>&gt;</span>Title<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">data-html</span>=<span class="value">"post.body"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span>&gt;</span>Little Red<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span>&gt;</span>
  <span class="tag">&lt;<span class="title">p</span>&gt;</span>Little Red Riding Hood is a story about a little girl.<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
  <span class="tag">&lt;<span class="title">p</span>&gt;</span>
    More info can be found on
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://en.wikipedia.org/wiki/Little_Red_Riding_Hood"</span>&gt;</span>Wikipedia<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addHandler <span class="string">'bind-html'</span>, (element, expr, controller) -&gt;
	controller.watch expr, (value) -&gt;
		element.html(<span class="keyword">if</span> value? <span class="keyword">then</span> value <span class="keyword">else</span> <span class="string">''</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2>data-class</h2>
<p>Adds a handler to add classes to an element. If the value of the expression is a string, that string will be set as the
class attribute. If the value is an array of strings, those will be set as the element classes. These two methods
overwrite any existing classes. If the value is an object, each property of that object will be toggled on or off in
the class list depending on whether the value of the property is truthy or falsey.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">data-class</span>=<span class="value">"theClasses"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"btn primary"</span> <span class="attribute">data-class</span>=<span class="value">"{highlight:ready}"</span>&gt;</span><span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result if <code>theClases</code> equals “red blue” and <code>ready</code> is <code>true</code>:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"red blue"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"btn primary highlight"</span>&gt;</span><span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addHandler <span class="string">'class'</span>, (element, expr, controller) -&gt;
	controller.watch expr, (value) -&gt;
		<span class="keyword">if</span> Array.isArray(value)
			value = value.join(<span class="string">' '</span>)
		
		<span class="keyword">if</span> <span class="keyword">typeof</span> value <span class="keyword">is</span> <span class="string">'string'</span>
			element.attr(<span class="string">'class'</span>, value)
		<span class="keyword">else</span> <span class="keyword">if</span> value <span class="keyword">and</span> <span class="keyword">typeof</span> value <span class="keyword">is</span> <span class="string">'object'</span>
			<span class="keyword">for</span> own className, toggle <span class="keyword">of</span> value
				<span class="keyword">if</span> toggle
					element.addClass(className)
				<span class="keyword">else</span>
					element.removeClass(className)</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2>data-active</h2>
<p>Adds a handler to add the class “active” to an element if the expression is truthy, or if no expression is
provided it adds the “active” class if the element or it‘s first anchor child’s href matches the URL in the browser.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"btn btn-primary"</span> <span class="attribute">data-active</span>=<span class="value">"formValid"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span>

<span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">data-active</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/posts"</span>&gt;</span>My Blog<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">data-active</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/account"</span>&gt;</span>My Account<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">data-active</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/profile"</span>&gt;</span>Profile<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>
<p><em>Result if <code>formValid</code> is <code>true</code> and the browser is at &quot;<a href="http://www.example.com/account">http://www.example.com/account</a>&quot;:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"btn btn-primary active"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span>

<span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/posts"</span>&gt;</span>My Blog<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">class</span>=<span class="value">"active"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/account"</span>&gt;</span>My Account<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/profile"</span>&gt;</span>Profile<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addHandler <span class="string">'active'</span>, (element, expr, controller) -&gt;
	<span class="keyword">if</span> expr
		controller.watch expr, (value) -&gt;
			<span class="keyword">if</span> value
				element.addClass(<span class="string">'active'</span>)
			<span class="keyword">else</span>
				element.removeClass(<span class="string">'active'</span>)
	<span class="keyword">else</span>
		<span class="function"><span class="title">refresh</span></span> = -&gt;
			<span class="keyword">if</span> link.length <span class="keyword">and</span> link.get(<span class="number">0</span>).href <span class="keyword">is</span> location.href
				element.addClass(<span class="string">'active'</span>)
			<span class="keyword">else</span>
				element.removeClass(<span class="string">'active'</span>)
		
		link = element
			.filter(<span class="string">'a[href],a[data-attr^="href:"]'</span>)
			.add(element.find(<span class="string">'a[href],a[data-attr^="href:"]'</span>))
			.first()
		<span class="keyword">if</span> link.attr(<span class="string">'data-href'</span>)
			link.<span class="literal">on</span> <span class="string">'hrefChanged'</span>, refresh
		$(document).<span class="literal">on</span> <span class="string">'urlChange'</span>, refresh
		element.<span class="literal">on</span> <span class="string">'elementRemove'</span>, -&gt; $(document).<span class="literal">off</span> <span class="string">'urlChange'</span>, refresh
		refresh()

Path.<span class="function"><span class="title">onchange</span></span> = -&gt;
	$(document).trigger(<span class="string">'urlChange'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2>data-value</h2>
<p>Adds a handler which sets the value of an HTML form element. This handler also updates the data as it is changed in
the form element, providing two way binding.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">label</span>&gt;</span>First Name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"firstName"</span> <span class="attribute">data-value</span>=<span class="value">"user.firstName"</span>&gt;</span>

<span class="tag">&lt;<span class="title">label</span>&gt;</span>Last Name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"lastName"</span> <span class="attribute">data-value</span>=<span class="value">"user.lastName"</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">label</span>&gt;</span>First Name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"firstName"</span> <span class="attribute">value</span>=<span class="value">"Jacob"</span>&gt;</span>

<span class="tag">&lt;<span class="title">label</span>&gt;</span>Last Name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"lastName"</span> <span class="attribute">value</span>=<span class="value">"Wright"</span>&gt;</span></code></pre>
<p>And when the user changes the text in the first input to “Jac”, <code>user.firstName</code> will be updated immediately with the
value of <code>&#39;Jac&#39;</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addHandler <span class="string">'value'</span>, (element, expr, controller) -&gt;
	observer = controller.watch expr, (value) -&gt;
		<span class="keyword">if</span> element.val() <span class="keyword">isnt</span> value
			element.val(value)
	
	setter = controller.getBoundEval expr + <span class="string">' = value'</span>, <span class="string">'value'</span>
	setter element.val()
	
	element.<span class="literal">on</span> <span class="string">'keydown keyup change'</span>, -&gt; <span class="comment"># TODO set up the listeners which will update the value, not just for text inputs</span>
		<span class="keyword">if</span> element.val() <span class="keyword">isnt</span> observer.oldValue
			setter element.val()
			observer.skipNextSync() <span class="comment"># don't update this observer, user changed it</span>
			controller.syncView() <span class="comment"># update other expressions looking at this data</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2>data-[event]</h2>
<p>Adds a handler for each event name in the array. When the event is triggered the expression will be run.</p>
<p><strong>Events:</strong></p>
<ul>
<li>data-click</li>
<li>data-dblclick</li>
<li>data-submit</li>
<li>data-change</li>
<li>data-focus</li>
<li>data-blur</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">form</span> <span class="attribute">data-submit</span>=<span class="value">"saveUser()"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"firstName"</span> <span class="attribute">value</span>=<span class="value">"Jacob"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">button</span>&gt;</span>Save<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></code></pre>
<p><em>Result (events don&#39;t affect the HTML):</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">form</span>&gt;</span>
  <span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"firstName"</span> <span class="attribute">value</span>=<span class="value">"Jacob"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">button</span>&gt;</span>Save<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>[ <span class="string">'click'</span>, <span class="string">'dblclick'</span>, <span class="string">'submit'</span>, <span class="string">'change'</span>, <span class="string">'focus'</span>, <span class="string">'blur'</span> ]
	.forEach (name) -&gt;
		Binding.addEventHandler(name)</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2>data-[key event]</h2>
<p>Adds a handler which is triggered when the keydown event&#39;s <code>keyCode</code> property matches.</p>
<p><strong>Key Events:</strong></p>
<ul>
<li>data-enter</li>
<li>data-esc</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">data-enter</span>=<span class="value">"window.alert(element.val())"</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">input</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>keyCodes = { enter: <span class="number">13</span>, esc: <span class="number">27</span> }
<span class="keyword">for</span> own name, keyCode <span class="keyword">of</span> keyCodes
	Binding.addKeyEventHandler(name, keyCode)</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <h2>data-[attribute]</h2>
<p>Adds a handler to set the attribute of element to the value of the expression.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li>data-href</li>
<li>data-src</li>
<li>data-id</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">data-src</span>=<span class="value">"user.avatarUrl"</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"http://cdn.example.com/avatars/jacwright-small.png"</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>attribs = [ <span class="string">'href'</span>, <span class="string">'src'</span>, <span class="string">'id'</span> ]
<span class="keyword">for</span> name <span class="keyword">in</span> attribs
	Binding.addAttributeHandler(name)</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h2>data-[toggle attribute]</h2>
<p>Adds a handler to toggle an attribute on or off if the expression is truthy or falsey.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li>data-checked</li>
<li>data-disabled</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">label</span>&gt;</span>Is Administrator<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"checkbox"</span> <span class="attribute">data-checked</span>=<span class="value">"user.isAdmin"</span>&gt;</span>
<span class="tag">&lt;<span class="title">button</span> <span class="attribute">data-disabled</span>=<span class="value">"isProcessing"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span></code></pre>
<p><em>Result if <code>isProcessing</code> is <code>true</code> and <code>user.isAdmin</code> is false:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">label</span>&gt;</span>Is Administrator<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"checkbox"</span>&gt;</span>
<span class="tag">&lt;<span class="title">button</span> <span class="attribute">disabled</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>[ <span class="string">'checked'</span>, <span class="string">'disabled'</span> ].forEach (name) -&gt;
	Binding.addAttributeToggleHandler(name)</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h2>data-repeat</h2>
<p>Adds a handler to duplicate an element for each item in an array. Creates a new controller for each item, optionally
running the controller definition if <code>data-controller</code> is set on the element after <code>data-repeat</code>. The expression must
be of the format <code>itemName in arrayName</code> where <code>itemName</code> is the name each item inside the array will be referenced
by inside the element. <code>arrayName</code> is any expression, e.g. <code>post in user.getPosts()</code>.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">data-repeat</span>=<span class="value">"post in posts"</span> <span class="attribute">data-class</span>=<span class="value">"{featured:post.isFeatured}"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">h1</span> <span class="attribute">data-text</span>=<span class="value">"post.title"</span>&gt;</span>Title<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">data-html</span>=<span class="value">"post.body"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result if there are 2 posts and the first one is featured:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"featured"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">h1</span>&gt;</span>Little Red<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
  <span class="tag">&lt;<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>Little Red Riding Hood is a story about a little girl.<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>
      More info can be found on
      <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://en.wikipedia.org/wiki/Little_Red_Riding_Hood"</span>&gt;</span>Wikipedia<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">p</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span>&gt;</span>
  <span class="tag">&lt;<span class="title">h1</span>&gt;</span>Big Blue<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
  <span class="tag">&lt;<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>Some thoughts on the New York Giants.<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>
      More info can be found on
      <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://en.wikipedia.org/wiki/New_York_Giants"</span>&gt;</span>Wikipedia<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">p</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addBlockHandler <span class="string">'repeat'</span>, (element, expr, controller) -&gt;
	orig = expr
	[ itemName, expr ] = expr.split <span class="regexp">/\s+in\s+/</span>
	<span class="keyword">unless</span> itemName <span class="keyword">and</span> expr
		<span class="keyword">throw</span> <span class="string">'Invalid data-repeat "'</span>
		+ orig
		+ <span class="string">'". Requires the format "todo in todos"'</span>
		+ <span class="string">' or "key, prop in todos".'</span> 
	
	controllerName = element.attr(<span class="string">'data-controller'</span>)
	element.removeAttr(<span class="string">'data-controller'</span>)
	[ itemName, propName ] = itemName.split <span class="regexp">/\s*,\s*/</span>
	
	template = element <span class="comment"># use a placeholder for the element and the element as a template</span>
	placeholder = $(<span class="string">'&lt;script type="text/repeat-placeholder"&gt;&lt;!--'</span> + expr + <span class="string">'--&gt;&lt;/script&gt;'</span>).replaceAll(template)
	elements = $()
	extend = {}
	value = <span class="literal">null</span>
			
	<span class="function"><span class="title">createElement</span></span> = (item) -&gt;
		newElement = template.clone()
		<span class="keyword">unless</span> Array.isArray(value)
			extend[propName] = item <span class="keyword">if</span> propName
			extend[itemName] = value[item]
		<span class="keyword">else</span>
			extend[itemName] = item
		Controller.create newElement, controller, controllerName, extend
		newElement.get(<span class="number">0</span>)
	
	controller.watch expr, (newValue, oldValue, splices) -&gt;
		value = newValue
		
		<span class="keyword">if</span> <span class="keyword">not</span> splices <span class="comment"># first time setup (or changing from/to an array value)</span>
			<span class="keyword">if</span> elements.length
				elements.eq(<span class="number">0</span>).replaceWith(placeholder)
				elements.remove()
				elements = $()
			
			<span class="keyword">if</span> newValue <span class="keyword">and</span> <span class="keyword">not</span> Array.isArray(newValue) <span class="keyword">and</span> <span class="keyword">typeof</span> newValue <span class="keyword">is</span> <span class="string">'object'</span>
				newValue = Object.keys newValue
			
			<span class="keyword">if</span> Array.isArray(value) <span class="keyword">and</span> value.length
				value.forEach (item) -&gt;
					elements.push createElement item
				placeholder.after(elements).remove()
		
		<span class="keyword">else</span> <span class="keyword">if</span> Array.isArray(value) <span class="keyword">or</span> (value <span class="keyword">and</span> <span class="keyword">typeof</span> value <span class="keyword">is</span> <span class="string">'object'</span>)
			<span class="keyword">unless</span> Array.isArray(value)
				splices = equality.array Object.keys(value, oldValue)
			
			splices.forEach (splice) -&gt;
				args = [splice.index, splice.removed.length]
				
				newElements = []
				addIndex = splice.index
				<span class="keyword">while</span> (addIndex &lt; splice.index + splice.addedCount)
					item = value[addIndex]
					newElements.push createElement item
					addIndex++
				
				removedElements = $ elements.splice.apply(elements, args.concat(newElements))
				
				<span class="keyword">if</span> removedElements.length
					<span class="keyword">if</span> elements.length <span class="keyword">is</span> <span class="number">0</span>
						removedElements.eq(<span class="number">0</span>).replaceWith(placeholder)
					removedElements.remove()
				
				<span class="keyword">if</span> newElements.length
					<span class="keyword">if</span> splice.index <span class="keyword">is</span> <span class="number">0</span>
						<span class="keyword">if</span> placeholder.parent().length
							placeholder.after(newElements).remove()
						<span class="keyword">else</span>
							elements.eq(newElements.length).before(newElements)
					<span class="keyword">else</span>
						elements.eq(splice.index - <span class="number">1</span>).after(newElements)</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h2>data-partial</h2>
<p>Adds a handler to set the contents of the element with the template and controller by that name. The expression may
be just the name of the template/controller, or it may be of the format <code>expr as itemName with partialName</code> where
<code>expr</code> is an expression who&#39;s value will be set to <code>itemName</code> on the conroller in the partial. Note: any binding
attributes which appear after <code>data-partial</code> will have the new value available if using the special format.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="comment">&lt;!--&lt;div data-partial="userInfo"&gt;&lt;/div&gt;--&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">data-partial</span>=<span class="value">"getUser() as user with userInfo"</span> <span class="attribute">data-class</span>=<span class="value">"{administrator:user.isAdmin}"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>

<span class="tag">&lt;<span class="title">script</span> <span class="attribute">name</span>=<span class="value">"userInfo"</span> <span class="attribute">type</span>=<span class="value">"text/html"</span>&gt;</span><span class="javascript">
  &lt;span data-text=<span class="string">"user.name"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="title">span</span>&gt;</span>
</span></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="comment">&lt;!--&lt;div data-partial="userInfo"&gt;&lt;/div&gt;--&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"administrator"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">span</span>&gt;</span>Jacob<span class="tag">&lt;/<span class="title">span</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addBlockHandler <span class="string">'partial'</span>, (element, expr, controller) -&gt;
	parts = expr.split <span class="regexp">/\s+as\s+\s+with\s+/</span>
	name = parts.pop()
	[ expr, itemName ] = parts
	
	<span class="keyword">if</span> expr <span class="keyword">and</span> itemName
		extend = {}
		extend[itemName] = controller.eval expr
		controller.watch expr, <span class="literal">true</span>, (value) -&gt;
			newController[itemName] = value
	
	element.html chip.getTemplate(name)
	newController = Controller.create element, controller, name, extend</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h2>data-controller</h2>
<p>Adds a handler to create a new controller for this element and its descendants. The value of the attribute is the
controller definition name which will be run if provided. Use this when you want to sandbox controller values (such
as a form) or provide functionality provided by that controller to the element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">form</span> <span class="attribute">data-controller</span>=<span class="value">"userForm"</span> <span class="attribute">data-submit</span>=<span class="value">"saveUser()"</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></code></pre>
<p><em>Result if <code>formValid</code> is <code>true</code> and the browser is at &quot;<a href="http://www.example.com/account">http://www.example.com/account</a>&quot;:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">form</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>Binding.addBlockHandler <span class="string">'controller'</span>, (element, controllerName, controller) -&gt;
	Controller.create(element, controller, controllerName)</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
