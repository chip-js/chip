<!DOCTYPE html>

<html>
<head>
  <title>Default Bindings</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1>Default Bindings</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre>

chip.binding <span class="string">'debug'</span>, (element, expr, controller) -&gt;
	controller.watch expr, (value) -&gt;
		console.info <span class="string">'Debug:'</span>, expr, <span class="string">'='</span>, value</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2>chip-text</h2>
<p>Adds a handler to display text inside an element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span> <span class="attribute">chip-text</span>=<span class="value">"post.title"</span>&gt;</span>Title<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"info"</span>&gt;</span>
  Written by
  <span class="tag">&lt;<span class="title">span</span> <span class="attribute">chip-text</span>=<span class="value">"post.author.name"</span>&gt;</span>author<span class="tag">&lt;/<span class="title">span</span>&gt;</span>
  on
  <span class="tag">&lt;<span class="title">span</span> <span class="attribute">chip-text</span>=<span class="value">"post.date.toLocaleDateString()"</span>&gt;</span>date<span class="tag">&lt;/<span class="title">span</span>&gt;</span>.
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span>&gt;</span>Little Red<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"info"</span>&gt;</span>
  Written by
  <span class="tag">&lt;<span class="title">span</span>&gt;</span>Jacob Wright<span class="tag">&lt;/<span class="title">span</span>&gt;</span>
  on
  <span class="tag">&lt;<span class="title">span</span>&gt;</span>10/16/2013<span class="tag">&lt;/<span class="title">span</span>&gt;</span>.
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'text'</span>, (element, expr, controller) -&gt;
	controller.watch expr, (value) -&gt;
		element.text(<span class="keyword">if</span> value? <span class="keyword">then</span> value <span class="keyword">else</span> <span class="string">''</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2>chip-html</h2>
<p>Adds a handler to display unescaped HTML inside an element. Be sure it&#39;s trusted!</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span> <span class="attribute">chip-text</span>=<span class="value">"post.title"</span>&gt;</span>Title<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">chip-html</span>=<span class="value">"post.body"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span>&gt;</span>Little Red<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span>&gt;</span>
  <span class="tag">&lt;<span class="title">p</span>&gt;</span>Little Red Riding Hood is a story about a little girl.<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
  <span class="tag">&lt;<span class="title">p</span>&gt;</span>
    More info can be found on
    <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://en.wikipedia.org/wiki/Little_Red_Riding_Hood"</span>&gt;</span>Wikipedia<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">p</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'html'</span>, (element, expr, controller) -&gt;
	controller.watch expr, (value) -&gt;
		element.html(<span class="keyword">if</span> value? <span class="keyword">then</span> value <span class="keyword">else</span> <span class="string">''</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2>chip-trim</h2>
<p>Adds a handler to trim whitespace text nodes inside an element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">chip-trim</span> <span class="attribute">class</span>=<span class="value">"info"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">span</span> <span class="attribute">chip-text</span>=<span class="value">"post.author.name"</span>&gt;</span>author<span class="tag">&lt;/<span class="title">span</span>&gt;</span>
  <span class="tag">&lt;<span class="title">span</span> <span class="attribute">chip-text</span>=<span class="value">"post.date.toLocaleDateString()"</span>&gt;</span>date<span class="tag">&lt;/<span class="title">span</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"info"</span>&gt;</span><span class="tag">&lt;<span class="title">span</span>&gt;</span>Jacob Wright<span class="tag">&lt;/<span class="title">span</span>&gt;</span><span class="tag">&lt;<span class="title">span</span>&gt;</span>10/16/2013<span class="tag">&lt;/<span class="title">span</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'trim'</span>, (element, expr, controller) -&gt;
	node = element.get(<span class="number">0</span>).firstChild
	<span class="keyword">while</span> node
		next = node.nextSibling
		<span class="keyword">if</span> node.nodeType <span class="keyword">is</span> Node.TEXT_NODE
			<span class="keyword">if</span> node.nodeValue.match <span class="regexp">/^\s*$/</span>
				node.parentNode.removeChild node
			<span class="keyword">else</span>
				node.textContent = node.textContent.trim()
		node = next</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2>chip-translate</h2>
<p>Adds a handler to translate the text inside an element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span> <span class="attribute">chip-translate</span>&gt;</span>Welcome <span class="tag">&lt;<span class="title">span</span> <span class="attribute">chip-text</span>=<span class="value">"name"</span>&gt;</span><span class="tag">&lt;/<span class="title">span</span>&gt;</span>!<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></code></pre>
<p><em>Initial Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span>&gt;</span>Welcome <span class="tag">&lt;<span class="title">span</span>&gt;</span>Jacob<span class="tag">&lt;/<span class="title">span</span>&gt;</span>!<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></code></pre>
<p><em>Result after changing the translations with</em></p>
<pre><code>app.translate({<span class="string">"Welcome %{0}!"</span>:<span class="string">"Sup %{0} Yo!"</span>})</code></pre>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">h1</span>&gt;</span>Sup <span class="tag">&lt;<span class="title">span</span>&gt;</span>Jacob<span class="tag">&lt;/<span class="title">span</span>&gt;</span> Yo!<span class="tag">&lt;/<span class="title">h1</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'translate'</span>, (element, expr, controller) -&gt;
	nodes = element.get(<span class="number">0</span>).childNodes
	text = <span class="string">''</span>
	placeholders = []
	<span class="keyword">for</span> node, i <span class="keyword">in</span> nodes
		<span class="keyword">if</span> node.nodeType <span class="keyword">is</span> <span class="number">3</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Don&#39;t include whitespace at the beginning and end of the translated string</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			<span class="keyword">unless</span> node.nodeValue.trim() <span class="keyword">is</span> <span class="string">''</span> <span class="keyword">and</span> (i <span class="keyword">is</span> <span class="number">0</span> <span class="keyword">or</span> i <span class="keyword">is</span> nodes.length - <span class="number">1</span>)
				text += node.nodeValue
		<span class="keyword">else</span> <span class="keyword">if</span> node.nodeType <span class="keyword">is</span> <span class="number">1</span>
			text += <span class="string">'%{'</span> + placeholders.length + <span class="string">'}'</span>
			placeholders.push node
	
	<span class="function"><span class="title">refresh</span></span> = -&gt;
		translation = controller.translations[text] <span class="keyword">or</span> text
		exp = <span class="regexp">/%{(\d+)}/g</span>
		nodes = []
		lastIndex = <span class="number">0</span>
		<span class="keyword">while</span> (match = exp.exec translation)
			startIndex = exp.lastIndex - match[<span class="number">0</span>].length
			<span class="keyword">if</span> lastIndex <span class="keyword">isnt</span> startIndex
				nodes.push document.createTextNode translation.slice lastIndex, startIndex
			nodes.push placeholders[match[<span class="number">1</span>]]
			lastIndex = exp.lastIndex
		
		<span class="keyword">if</span> lastIndex <span class="keyword">isnt</span> translation.length
			nodes.push document.createTextNode translation.slice lastIndex
		
		element.html nodes
	
	element.<span class="literal">on</span> <span class="string">'remove'</span>, -&gt; controller.<span class="literal">off</span> <span class="string">'translationChange'</span>, refresh
	controller.<span class="literal">on</span> <span class="string">'translationChange'</span>, refresh</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>don&#39;t process if no translation is loaded</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> controller.translations[text]
		refresh()</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2>chip-class</h2>
<p>Adds a handler to add classes to an element. If the value of the expression is a string, that string will be set as the
class attribute. If the value is an array of strings, those will be set as the element classes. These two methods
overwrite any existing classes. If the value is an object, each property of that object will be toggled on or off in
the class list depending on whether the value of the property is truthy or falsey.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">chip-class</span>=<span class="value">"theClasses"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"btn primary"</span> <span class="attribute">chip-class</span>=<span class="value">"{highlight:ready}"</span>&gt;</span><span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result if <code>theClases</code> equals “red blue” and <code>ready</code> is <code>true</code>:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"red blue"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"btn primary highlight"</span>&gt;</span><span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'class'</span>, (element, expr, controller) -&gt;
	controller.watch expr, (value) -&gt;
		<span class="keyword">if</span> Array.isArray(value)
			value = value.join(<span class="string">' '</span>)
		
		<span class="keyword">if</span> <span class="keyword">typeof</span> value <span class="keyword">is</span> <span class="string">'string'</span>
			element.attr(<span class="string">'class'</span>, value)
		<span class="keyword">else</span> <span class="keyword">if</span> value <span class="keyword">and</span> <span class="keyword">typeof</span> value <span class="keyword">is</span> <span class="string">'object'</span>
			<span class="keyword">for</span> own className, toggle <span class="keyword">of</span> value
				<span class="keyword">if</span> toggle
					element.addClass(className)
				<span class="keyword">else</span>
					element.removeClass(className)</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2>chip-active</h2>
<p>Adds a handler to add the class “active” to an element if the expression is truthy, or if no expression is
provided it adds the “active” class if the element or it‘s first anchor child’s href matches the URL in the browser.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"btn btn-primary"</span> <span class="attribute">chip-active</span>=<span class="value">"formValid"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span>

<span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-active</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/posts"</span>&gt;</span>My Blog<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-active</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/account"</span>&gt;</span>My Account<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-active</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/profile"</span>&gt;</span>Profile<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>
<p><em>Result if <code>formValid</code> is <code>true</code> and the browser is at &quot;<a href="http://www.example.com/account">http://www.example.com/account</a>&quot;:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"btn btn-primary active"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span>

<span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/posts"</span>&gt;</span>My Blog<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">class</span>=<span class="value">"active"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/account"</span>&gt;</span>My Account<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/profile"</span>&gt;</span>Profile<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'active'</span>, (element, expr, controller) -&gt;
	<span class="keyword">if</span> expr
		controller.watch expr, (value) -&gt;
			<span class="keyword">if</span> value
				element.addClass(<span class="string">'active'</span>)
			<span class="keyword">else</span>
				element.removeClass(<span class="string">'active'</span>)
	<span class="keyword">else</span>
		<span class="function"><span class="title">refresh</span></span> = -&gt;
			<span class="keyword">if</span> link.length <span class="keyword">and</span> link.get(<span class="number">0</span>).href <span class="keyword">is</span> location.href
				element.addClass(<span class="string">'active'</span>)
			<span class="keyword">else</span>
				element.removeClass(<span class="string">'active'</span>)
		
		link = element
			.filter(<span class="string">'a'</span>)
			.add(element.find(<span class="string">'a'</span>))
			.first()
		link.<span class="literal">on</span> <span class="string">'hrefChanged'</span>, refresh
		controller.<span class="literal">on</span> <span class="string">'urlChange'</span>, refresh
		element.<span class="literal">on</span> <span class="string">'remove'</span>, -&gt; controller.<span class="literal">off</span> <span class="string">'urlChange'</span>, refresh
		refresh()</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <h2>chip-active-section</h2>
<p>The same as active except that the active class is added for any URL which starts with the link (marks active for the
whole section.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'active-section'</span>, (element, expr, controller) -&gt;
	<span class="function"><span class="title">refresh</span></span> = -&gt;
		<span class="keyword">if</span> link.length <span class="keyword">and</span> location.href.indexOf(link.get(<span class="number">0</span>).href) <span class="keyword">is</span> <span class="number">0</span>
			element.addClass(<span class="string">'active'</span>)
		<span class="keyword">else</span>
			element.removeClass(<span class="string">'active'</span>)
	
	link = element
		.filter(<span class="string">'a'</span>)
		.add(element.find(<span class="string">'a'</span>))
		.first()
	link.<span class="literal">on</span> <span class="string">'hrefChanged'</span>, refresh
	controller.<span class="literal">on</span> <span class="string">'urlChange'</span>, refresh
	element.<span class="literal">on</span> <span class="string">'remove'</span>, -&gt; controller.<span class="literal">off</span> <span class="string">'urlChange'</span>, refresh
	refresh()</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h2>chip-value</h2>
<p>Adds a handler which sets the value of an HTML form element. This handler also updates the data as it is changed in
the form element, providing two way binding.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">label</span>&gt;</span>First Name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"firstName"</span> <span class="attribute">chip-value</span>=<span class="value">"user.firstName"</span>&gt;</span>

<span class="tag">&lt;<span class="title">label</span>&gt;</span>Last Name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"lastName"</span> <span class="attribute">chip-value</span>=<span class="value">"user.lastName"</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">label</span>&gt;</span>First Name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"firstName"</span> <span class="attribute">value</span>=<span class="value">"Jacob"</span>&gt;</span>

<span class="tag">&lt;<span class="title">label</span>&gt;</span>Last Name<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">name</span>=<span class="value">"lastName"</span> <span class="attribute">value</span>=<span class="value">"Wright"</span>&gt;</span></code></pre>
<p>And when the user changes the text in the first input to “Jac”, <code>user.firstName</code> will be updated immediately with the
value of <code>&#39;Jac&#39;</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'value'</span>, (element, expr, controller) -&gt;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Handles input (checkboxes, radios), select, textarea, option</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	getValue =
		<span class="keyword">if</span> element.attr(<span class="string">'type'</span>) <span class="keyword">is</span> <span class="string">'checkbox'</span> <span class="comment"># Handles checkboxes</span>
			-&gt; element.prop(<span class="string">'checked'</span>)
		<span class="keyword">else</span> <span class="keyword">if</span> element.<span class="keyword">is</span>(<span class="string">':not(input,select,textarea,option)'</span>) <span class="comment"># Handles a group of radio inputs</span>
			-&gt; element.find(<span class="string">'input:radio:checked'</span>).val()
		<span class="keyword">else</span> <span class="comment"># Handles other form inputs</span>
			-&gt; element.val()
	
	setValue =
		<span class="keyword">if</span> element.attr(<span class="string">'type'</span>) <span class="keyword">is</span> <span class="string">'checkbox'</span>
			(value) -&gt; element.prop(<span class="string">'checked'</span>, value)
		<span class="keyword">else</span> <span class="keyword">if</span> element.<span class="keyword">is</span>(<span class="string">':not(input,select,textarea,option)'</span>) <span class="comment"># Handles a group of radio inputs</span>
			(value) -&gt;
				element.find(<span class="string">'input:radio:checked'</span>).prop(<span class="string">'checked'</span>, <span class="literal">false</span>) <span class="comment"># in case the value isn't found in radios</span>
				element.find(<span class="string">'input:radio[value="'</span> + value + <span class="string">'"]'</span>).prop(<span class="string">'checked'</span>, <span class="literal">true</span>)
		<span class="keyword">else</span>
			(value) -&gt; element.val(value)
	
	observer = controller.watch expr, (value) -&gt;
		<span class="keyword">if</span> `<span class="javascript">getValue() != value</span>` <span class="comment"># Allows for string/number equality</span>
			setValue value</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Skips setting values on option elements since the user cannot change these with user input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">return</span> <span class="keyword">if</span> element.<span class="keyword">is</span> <span class="string">'option'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Sets initial element value. For SELECT elements allows child option element values to be set first.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="keyword">if</span> element.<span class="keyword">is</span>(<span class="string">'select'</span>)
		setTimeout -&gt;
			setValue controller.eval expr
			controller.evalSetter expr, getValue()
	<span class="keyword">else</span>
		controller.evalSetter expr, getValue()
	
	events = element.attr(<span class="string">'chip-value-events'</span>) <span class="keyword">or</span> <span class="string">'change'</span>
	element.removeAttr(<span class="string">'chip-value-events'</span>)
	
	element.<span class="literal">on</span> events, -&gt;
		<span class="keyword">if</span> getValue() <span class="keyword">isnt</span> observer.oldValue
			controller.evalSetter expr, getValue()
			observer.skipNextSync() <span class="comment"># don't update this observer, user changed it</span>
			controller.sync() <span class="comment"># update other expressions looking at this data</span></pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2>chip-[event]</h2>
<p>Adds a handler for each event name in the array. When the event is triggered the expression will be run.</p>
<p><strong>Events:</strong></p>
<ul>
<li>chip-click</li>
<li>chip-dblclick</li>
<li>chip-submit</li>
<li>chip-change</li>
<li>chip-focus</li>
<li>chip-blur</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">form</span> <span class="attribute">chip-submit</span>=<span class="value">"saveUser()"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"firstName"</span> <span class="attribute">value</span>=<span class="value">"Jacob"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">button</span>&gt;</span>Save<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></code></pre>
<p><em>Result (events don&#39;t affect the HTML):</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">form</span>&gt;</span>
  <span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"firstName"</span> <span class="attribute">value</span>=<span class="value">"Jacob"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">button</span>&gt;</span>Save<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>[ <span class="string">'click'</span>, <span class="string">'dblclick'</span>, <span class="string">'submit'</span>, <span class="string">'change'</span>, <span class="string">'focus'</span>, <span class="string">'blur'</span>, <span class="string">'keydown'</span>, <span class="string">'keyup'</span>, <span class="string">'paste'</span> ]
	.forEach (name) -&gt;
		chip.eventBinding(name)</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <h2>chip-[key event]</h2>
<p>Adds a handler which is triggered when the keydown event&#39;s <code>keyCode</code> property matches.</p>
<p><strong>Key Events:</strong></p>
<ul>
<li>chip-enter</li>
<li>chip-esc</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">chip-enter</span>=<span class="value">"window.alert(element.val())"</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">input</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>keyCodes = { enter: <span class="number">13</span>, esc: <span class="number">27</span> }
<span class="keyword">for</span> own name, keyCode <span class="keyword">of</span> keyCodes
	chip.keyEventBinding(name, keyCode)</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h2>chip-[control key event]</h2>
<p>Adds a handler which is triggered when the keydown event&#39;s <code>keyCode</code> property matches and the ctrlKey or metaKey is
pressed.</p>
<p><strong>Key Events:</strong></p>
<ul>
<li>chip-ctrl-enter</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">chip-ctrl-enter</span>=<span class="value">"window.alert(element.val())"</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">input</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.keyEventBinding(<span class="string">'ctrl-enter'</span>, keyCodes.enter, <span class="literal">true</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <h2>chip-[attribute]</h2>
<p>Adds a handler to set the attribute of element to the value of the expression.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li>chip-href</li>
<li>chip-src</li>
<li>chip-id</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">chip-src</span>=<span class="value">"user.avatarUrl"</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"http://cdn.example.com/avatars/jacwright-small.png"</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>attribs = [ <span class="string">'href'</span>, <span class="string">'src'</span>, <span class="string">'id'</span> ]
<span class="keyword">for</span> name <span class="keyword">in</span> attribs
	chip.attributeBinding(name)</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <h2>chip-[toggle attribute]</h2>
<p>Adds a handler to toggle an attribute on or off if the expression is truthy or falsey.</p>
<p><strong>Attributes:</strong></p>
<ul>
<li>chip-checked</li>
<li>chip-disabled</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">label</span>&gt;</span>Is Administrator<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"checkbox"</span> <span class="attribute">chip-checked</span>=<span class="value">"user.isAdmin"</span>&gt;</span>
<span class="tag">&lt;<span class="title">button</span> <span class="attribute">chip-disabled</span>=<span class="value">"isProcessing"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span></code></pre>
<p><em>Result if <code>isProcessing</code> is <code>true</code> and <code>user.isAdmin</code> is false:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">label</span>&gt;</span>Is Administrator<span class="tag">&lt;/<span class="title">label</span>&gt;</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"checkbox"</span>&gt;</span>
<span class="tag">&lt;<span class="title">button</span> <span class="attribute">disabled</span>&gt;</span>Submit<span class="tag">&lt;/<span class="title">button</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>[ <span class="string">'checked'</span>, <span class="string">'disabled'</span> ].forEach (name) -&gt;
	chip.attributeToggleBinding(name)</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <h2>animateIn/animateOut</h2>
<p>Adds a jquery plugin to allow an element to use CSS3 transitions or animations to animate in or out of the page. This
is used with chip-if, chip-each, etc. to show and hide elements.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>$.fn.<span class="function"><span class="title">animateIn</span></span> = (callback) -&gt;
	<span class="keyword">if</span> <span class="property">@parent</span>().length
		placeholder = $(<span class="string">'&lt;!----&gt;'</span>)
		<span class="property">@before</span>(placeholder)
		<span class="property">@detach</span>()
	
	<span class="property">@addClass</span> <span class="string">'animate-in'</span>
	
	<span class="keyword">if</span> placeholder
		placeholder.after(<span class="keyword">this</span>)
		placeholder.remove()
	
	setTimeout =&gt;
		<span class="property">@removeClass</span> <span class="string">'animate-in'</span>
		<span class="keyword">if</span> callback
			<span class="keyword">if</span> <span class="property">@cssDuration</span>(<span class="string">'transition'</span>) <span class="keyword">or</span> <span class="property">@cssDuration</span>(<span class="string">'animation'</span>)
				<span class="property">@one</span> <span class="string">'webkittransitionend transitionend webkitanimationend animationend'</span>, -&gt; callback()
			<span class="keyword">else</span>
				callback()
	<span class="keyword">return</span> <span class="keyword">this</span>

$.fn.<span class="function"><span class="title">animateOut</span></span> = (dontRemove, callback) -&gt;
	<span class="keyword">if</span> <span class="keyword">typeof</span> dontRemove <span class="keyword">is</span> <span class="string">'function'</span>
		callback = dontRemove
		dontRemove = <span class="literal">false</span>
	
	<span class="property">@triggerHandler</span> <span class="string">'remove'</span> <span class="keyword">unless</span> dontRemove
	duration = <span class="property">@cssDuration</span>(<span class="string">'transition'</span>) <span class="keyword">or</span> <span class="property">@cssDuration</span>(<span class="string">'animation'</span>)
	<span class="keyword">if</span> duration
		<span class="property">@addClass</span> <span class="string">'animate-out'</span>
		<span class="function"><span class="title">done</span></span> = =&gt;
			clearTimeout timeout
			<span class="property">@off</span> <span class="string">'webkittransitionend transitionend webkitanimationend animationend'</span>, done
			<span class="property">@removeClass</span> <span class="string">'animate-out'</span>
			<span class="keyword">if</span> callback <span class="keyword">then</span> callback() <span class="keyword">else</span> <span class="property">@remove</span>()
		
		<span class="property">@one</span> <span class="string">'webkittransitionend transitionend webkitanimationend animationend'</span>, done</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>backup to ensure it “finishes”</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>		timeout = setTimeout done, duration + <span class="number">100</span>
	<span class="keyword">else</span>
		<span class="keyword">if</span> callback <span class="keyword">then</span> callback() <span class="keyword">else</span> <span class="keyword">unless</span> dontRemove <span class="keyword">then</span> <span class="property">@remove</span>()
	
	<span class="keyword">return</span> <span class="keyword">this</span>

$.fn.<span class="function"><span class="title">cssDuration</span></span> = (property) -&gt;
	time = <span class="property">@css</span>(property + <span class="string">'-duration'</span>) <span class="keyword">or</span> <span class="property">@css</span>(<span class="string">'-webkit-'</span> + property + <span class="string">'-duration'</span>)
	millis = parseFloat time
	millis *= <span class="number">1000</span> <span class="keyword">if</span> <span class="regexp">/\ds/</span>.test time
	millis <span class="keyword">or</span> <span class="number">0</span></pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <h2>chip-if</h2>
<p>Adds a handler to show or hide the element if the value is truthy or falsey. Actually removes the element from the DOM
when hidden, replacing it with a non-visible placeholder and not needlessly executing bindings inside.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-if</span>=<span class="value">"user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/account"</span>&gt;</span>My Account<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-if</span>=<span class="value">"user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/logout"</span>&gt;</span>Sign Out<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-if</span>=<span class="value">"!user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/login"</span>&gt;</span>Sign In<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>
<p><em>Result if <code>user</code> is null:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="comment">&lt;!--chip-if="user"--&gt;</span>
  <span class="comment">&lt;!--chip-if="user"--&gt;</span>
  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/login"</span>&gt;</span>Sign In<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'if'</span>, <span class="number">50</span>, (element, expr, controller) -&gt;
	prefix = controller.app.bindingPrefix
	template = element <span class="comment"># use a placeholder for the element and the element as a template</span>
	placeholder = $(<span class="string">"&lt;!--<span class="subst">#{prefix}</span>if=\"<span class="subst">#{expr}</span>\"--&gt;"</span>).replaceAll(template)
	controllerName = element.attr(prefix + <span class="string">'controller'</span>)
	element.removeAttr(prefix + <span class="string">'controller'</span>)
	
	controller.watch expr, (value) -&gt;
		<span class="keyword">if</span> value
			<span class="keyword">if</span> placeholder.parent().length
				element = template.clone().animateIn()
				controller.child element: element, name: controllerName, passthrough: <span class="literal">true</span>
				placeholder.replaceWith(element)
		<span class="keyword">else</span>
			<span class="keyword">unless</span> placeholder.parent().length
				element.animateOut -&gt;
					element.replaceWith placeholder</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <h2>chip-unless</h2>
<p>Adds a handler to show or hide the element if the value is truthy or falsey. Actually removes the element from the DOM
when hidden, replacing it with a non-visible placeholder and not needlessly executing bindings inside.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-if</span>=<span class="value">"user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/account"</span>&gt;</span>My Account<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-if</span>=<span class="value">"user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/logout"</span>&gt;</span>Sign Out<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
  <span class="tag">&lt;<span class="title">li</span> <span class="attribute">chip-unless</span>=<span class="value">"user"</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/login"</span>&gt;</span>Sign In<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>
<p><em>Result if <code>user</code> is null:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">ul</span> <span class="attribute">class</span>=<span class="value">"header-links"</span>&gt;</span>
  <span class="comment">&lt;!--chip-if="user"--&gt;</span>
  <span class="comment">&lt;!--chip-if="user"--&gt;</span>
  <span class="tag">&lt;<span class="title">li</span>&gt;</span><span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"/login"</span>&gt;</span>Sign In<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">li</span>&gt;</span>
<span class="tag">&lt;/<span class="title">ul</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'unless'</span>, <span class="number">50</span>, (element, expr, controller) -&gt;
	prefix = controller.app.bindingPrefix
	template = element <span class="comment"># use a placeholder for the element and the element as a template</span>
	placeholder = $(<span class="string">"&lt;!--<span class="subst">#{prefix}</span>unless=\"<span class="subst">#{expr}</span>\"--&gt;"</span>).replaceAll(template)
	controllerName = element.attr(prefix + <span class="string">'controller'</span>)
	element.removeAttr(prefix + <span class="string">'controller'</span>)
	
	controller.watch expr, (value) -&gt;
		<span class="keyword">unless</span> value
			<span class="keyword">if</span> placeholder.parent().length
				element = template.clone().animateIn()
				controller.child element: element, name: controllerName, passthrough: <span class="literal">true</span>
				placeholder.replaceWith(element)
		<span class="keyword">else</span>
			<span class="keyword">unless</span> placeholder.parent().length
				element.before placeholder
				element.animateOut()</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <h2>chip-each</h2>
<p>Adds a handler to duplicate an element for each item in an array. Creates a new controller for each item, optionally
running the controller definition if <code>chip-controller</code> is set on the element after <code>chip-each</code>. The expression must
be of the format <code>itemName in arrayName</code> where <code>itemName</code> is the name each item inside the array will be referenced
by inside the element. <code>arrayName</code> is any expression, e.g. <code>post in user.getPosts()</code>.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">chip-each</span>=<span class="value">"post in posts"</span> <span class="attribute">chip-class</span>=<span class="value">"{featured:post.isFeatured}"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">h1</span> <span class="attribute">chip-text</span>=<span class="value">"post.title"</span>&gt;</span>Title<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">chip-html</span>=<span class="value">"post.body"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>
<p><em>Result if there are 2 posts and the first one is featured:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"featured"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">h1</span>&gt;</span>Little Red<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
  <span class="tag">&lt;<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>Little Red Riding Hood is a story about a little girl.<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>
      More info can be found on
      <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://en.wikipedia.org/wiki/Little_Red_Riding_Hood"</span>&gt;</span>Wikipedia<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">p</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span>&gt;</span>
  <span class="tag">&lt;<span class="title">h1</span>&gt;</span>Big Blue<span class="tag">&lt;/<span class="title">h1</span>&gt;</span>
  <span class="tag">&lt;<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>Some thoughts on the New York Giants.<span class="tag">&lt;/<span class="title">p</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span>&gt;</span>
      More info can be found on
      <span class="tag">&lt;<span class="title">a</span> <span class="attribute">href</span>=<span class="value">"http://en.wikipedia.org/wiki/New_York_Giants"</span>&gt;</span>Wikipedia<span class="tag">&lt;/<span class="title">a</span>&gt;</span>
    <span class="tag">&lt;/<span class="title">p</span>&gt;</span>
  <span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'each'</span>, <span class="number">100</span>, (element, expr, controller) -&gt;
	prefix = controller.app.bindingPrefix
	orig = expr
	[ itemName, expr ] = expr.split <span class="regexp">/\s+in\s+/</span>
	<span class="keyword">unless</span> itemName <span class="keyword">and</span> expr
		<span class="keyword">throw</span> <span class="string">"Invalid <span class="subst">#{prefix}</span>each=\""</span> +
			orig +
			<span class="string">'". Requires the format "item in list"'</span> +
			<span class="string">' or "key, propery in object".'</span>
	
	controllerName = element.attr(prefix + <span class="string">'controller'</span>)
	element.removeAttr(prefix + <span class="string">'controller'</span>)
	[ itemName, propName ] = itemName.split <span class="regexp">/\s*,\s*/</span>
	
	template = element <span class="comment"># use a placeholder for the element and the element as a template</span>
	placeholder = $(<span class="string">"&lt;!--<span class="subst">#{prefix}</span>each=\"<span class="subst">#{expr}</span>\"--&gt;"</span>).replaceAll(template)
	elements = $()
	properties = {}
	value = <span class="literal">null</span>
			
	<span class="function"><span class="title">createElement</span></span> = (item, index) -&gt;
		newElement = template.clone()
		<span class="keyword">unless</span> Array.isArray(value)
			properties[propName] = item <span class="keyword">if</span> propName
			properties[itemName] = value[item]
		<span class="keyword">else</span>
			properties[itemName] = item
			properties.index = index
		controller.child element: newElement, name: controllerName, properties: properties
		newElement.get(<span class="number">0</span>)
	
	controller.watch expr, (newValue, oldValue, splices) -&gt;
		value = newValue
		
		<span class="keyword">if</span> <span class="keyword">not</span> splices <span class="comment"># first time setup (or changing from/to an array value)</span>
			<span class="keyword">if</span> elements.length
				elements.eq(<span class="number">0</span>).replaceWith(placeholder)
				elements.remove()
				elements = $()
			
			<span class="keyword">if</span> newValue <span class="keyword">and</span> <span class="keyword">not</span> Array.isArray(newValue) <span class="keyword">and</span> <span class="keyword">typeof</span> newValue <span class="keyword">is</span> <span class="string">'object'</span>
				newValue = Object.keys newValue
			
			<span class="keyword">if</span> Array.isArray(value) <span class="keyword">and</span> value.length
				value.forEach (item, index) -&gt;
					elements.push createElement item, index
				placeholder.after(elements).remove()
		
		<span class="keyword">else</span> <span class="keyword">if</span> Array.isArray(value) <span class="keyword">or</span> (value <span class="keyword">and</span> <span class="keyword">typeof</span> value <span class="keyword">is</span> <span class="string">'object'</span>)
			<span class="keyword">unless</span> Array.isArray(value)
				splices = compare.arrays Object.keys(value), Object.keys(oldValue)
			
			hasNew = <span class="number">0</span>
			splices.forEach (splice) -&gt; hasNew += splice.addedCount

			splices.forEach (splice) -&gt;
				args = [splice.index, splice.removed.length]
				
				newElements = []
				addIndex = splice.index
				<span class="keyword">while</span> (addIndex &lt; splice.index + splice.addedCount)
					item = value[addIndex]
					newElements.push createElement item, addIndex
					addIndex++
				
				removedElements = $ elements.splice.apply(elements, args.concat(newElements))
				
				<span class="keyword">if</span> removedElements.length
					<span class="keyword">if</span> elements.length - newElements.length <span class="keyword">is</span> <span class="number">0</span> <span class="comment"># removing all existing elements</span>
						removedElements.eq(<span class="number">0</span>).before(placeholder)
					<span class="keyword">if</span> hasNew
						removedElements.remove()
					<span class="keyword">else</span>
						removedElements.animateOut()
				
				<span class="keyword">if</span> newElements.length
					$(newElements).animateIn()
					<span class="keyword">if</span> splice.index <span class="keyword">is</span> <span class="number">0</span>
						<span class="keyword">if</span> placeholder.parent().length
							placeholder.after(newElements).remove()
						<span class="keyword">else</span>
							elements.eq(newElements.length).before(newElements)
					<span class="keyword">else</span>
						elements.eq(splice.index - <span class="number">1</span>).after(newElements)</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <h2>chip-partial</h2>
<p>Adds a handler to set the contents of the element with the template and controller by that name. The expression may
be just the name of the template/controller, or it may be of the format <code>expr as itemName with partialName</code> where
<code>expr</code> is an expression who&#39;s value will be set to <code>itemName</code> on the conroller in the partial. Note: any binding
attributes which appear after <code>chip-partial</code> will have the new value available if using the special format.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="comment">&lt;!--&lt;div chip-partial="userInfo"&gt;&lt;/div&gt;--&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">chip-partial</span>=<span class="value">"getUser() as user with userInfo"</span> <span class="attribute">chip-class</span>=<span class="value">"{administrator:user.isAdmin}"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>

<span class="tag">&lt;<span class="title">script</span> <span class="attribute">name</span>=<span class="value">"userInfo"</span> <span class="attribute">type</span>=<span class="value">"text/html"</span>&gt;</span><span class="javascript">
  &lt;span chip-text=<span class="string">"user.name"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="title">span</span>&gt;</span>
</span></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></code></pre>
<p><em>Result:</em></p>
<pre><code class="lang-xml"><span class="comment">&lt;!--&lt;div chip-partial="userInfo"&gt;&lt;/div&gt;--&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"administrator"</span>&gt;</span>
  <span class="tag">&lt;<span class="title">span</span>&gt;</span>Jacob<span class="tag">&lt;/<span class="title">span</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'partial'</span>, <span class="number">50</span>, (element, expr, controller) -&gt;
	parts = expr.split <span class="regexp">/\s+as\s+|\s+with\s+/</span>
	nameExpr = parts.pop()
	[ itemExpr, itemName ] = parts
	childController = <span class="literal">null</span>
	properties = {}
	
	<span class="keyword">if</span> itemExpr <span class="keyword">and</span> itemName
		controller.watch itemExpr, <span class="literal">true</span>, (value) -&gt;
			childController[itemName] = value
	
	controller.watch nameExpr, (name) -&gt;
		<span class="keyword">return</span> <span class="keyword">unless</span> name?
		element.animateOut -&gt;
			element.html controller.template(name)
			<span class="keyword">if</span> itemExpr <span class="keyword">and</span> itemName
				properties[itemName] = controller.eval itemExpr
			element.animateIn()
			childController = controller.child element: element, name: name, properties: properties</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <h2>chip-controller</h2>
<p>Adds a handler to create a new controller for this element and its descendants. The value of the attribute is the
controller definition name which will be run if provided. Use this when you want to sandbox controller values (such
as a form) or provide functionality provided by that controller to the element.</p>
<p><strong>Example:</strong></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">form</span> <span class="attribute">chip-controller</span>=<span class="value">"userForm"</span> <span class="attribute">chip-submit</span>=<span class="value">"saveUser()"</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></code></pre>
<p><em>Result if <code>formValid</code> is <code>true</code> and the browser is at &quot;<a href="http://www.example.com/account">http://www.example.com/account</a>&quot;:</em></p>
<pre><code class="lang-xml"><span class="tag">&lt;<span class="title">form</span>&gt;</span>
<span class="tag">&lt;/<span class="title">form</span>&gt;</span></code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>chip.binding <span class="string">'controller'</span>, <span class="number">30</span>, (element, controllerName, controller) -&gt;
	controller.child element: element, name: controllerName</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
