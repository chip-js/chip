!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.chip=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){module.exports=function(options){return options||(options={}),options.duration||(options.duration=250),options.easing||(options.easing="ease-in-out"),{options:options,animateIn:function(element,done){element.animate([{opacity:"0"},{opacity:"1"}],this.options).onfinish=done},animateOut:function(element,done){element.animate([{opacity:"1"},{opacity:"0"}],this.options).onfinish=done}}}},{}],2:[function(require,module,exports){module.exports=function(options){return options||(options={}),options.property||(options.property="width"),require("./slide-fade")(options)}},{"./slide-fade":3}],3:[function(require,module,exports){module.exports=function(options){return options||(options={}),options.duration||(options.duration=250),options.easing||(options.easing="ease-in-out"),options.property||(options.property="height"),{options:options,animateIn:function(element,done){var value=element.getComputedCSS(this.options.property);if(!value||"0px"===value)return done();var before={opacity:"0"},after={opacity:"1"};before[this.options.property]="0px",after[this.options.property]=value,element.style.overflow="hidden",element.animate([before,after],this.options).onfinish=function(){element.style.overflow="",done()}},animateOut:function(element,done){var value=element.getComputedCSS(this.options.property);if(!value||"0px"===value)return done();var before={opacity:"1"},after={opacity:"0"};before[this.options.property]=value,after[this.options.property]="0px",element.style.overflow="hidden",element.animate([before,after],this.options).onfinish=function(){element.style.overflow="",done()}}}}},{}],4:[function(require,module,exports){module.exports=function(options){return options||(options={}),options.property||(options.property="width"),require("./slide")(options)}},{"./slide":7}],5:[function(require,module,exports){module.exports=function(options){return options||(options={}),options.property||(options.property="width"),require("./slide-move")(options)}},{"./slide-move":6}],6:[function(require,module,exports){var animating=(require("./slide"),new Map);module.exports=function(options){return options||(options={}),options.duration||(options.duration=250),options.easing||(options.easing="ease-in-out"),options.property||(options.property="height"),{options:options,animateIn:function(element,done){var value=element.getComputedCSS(options.property);if(!value||"0px"===value)return done();var item=element.view&&element.view._repeatItem_;item&&(animating.set(item,element),setTimeout(function(){animating["delete"](item)}));var before={},after={};before[this.options.property]="0px",after[this.options.property]=value,element.style.overflow="hidden",element.animate([before,after],this.options).onfinish=function(){element.style.overflow="",done()}},animateOut:function(element,done){var value=element.getComputedCSS(options.property);if(!value||"0px"===value)return done();var item=element.view&&element.view._repeatItem_;if(item){var newElement=animating.get(item);newElement&&newElement.parentNode===element.parentNode&&(element=this.animateMove(element,newElement))}var before={},after={};before[this.options.property]=value,after[this.options.property]="0px",element.style.overflow="hidden",element.animate([before,after],this.options).onfinish=function(){element.style.overflow="",done()}},animateMove:function(oldElement,newElement){var placeholderElement,parent=newElement.parentNode;parent.__slideMoveHandled||(parent.__slideMoveHandled=!0,"static"===window.getComputedStyle(parent).position&&(parent.style.position="relative"));var origStyle=oldElement.getAttribute("style"),style=window.getComputedStyle(oldElement),marginOffsetLeft=-parseInt(style.marginLeft),marginOffsetTop=-parseInt(style.marginTop),oldLeft=oldElement.offsetLeft,oldTop=oldElement.offsetTop;return placeholderElement=this.fragments.makeElementAnimatable(oldElement.cloneNode(!0)),placeholderElement.style.width=oldElement.style.width=style.width,placeholderElement.style.height=oldElement.style.height=style.height,placeholderElement.style.opacity="0",oldElement.style.position="absolute",oldElement.style.zIndex=1e3,parent.insertBefore(placeholderElement,oldElement),newElement.style.opacity="0",oldElement.animate([{top:oldTop+marginOffsetTop+"px",left:oldLeft+marginOffsetLeft+"px"},{top:newElement.offsetTop+marginOffsetTop+"px",left:newElement.offsetLeft+marginOffsetLeft+"px"}],this.options).onfinish=function(){placeholderElement.remove(),origStyle?oldElement.setAttribute("style",origStyle):oldElement.removeAttribute("style"),newElement.style.opacity=""},placeholderElement}}}},{"./slide":7}],7:[function(require,module,exports){module.exports=function(options){return options||(options={}),options.duration||(options.duration=250),options.easing||(options.easing="ease-in-out"),options.property||(options.property="height"),{options:options,animateIn:function(element,done){var value=element.getComputedCSS(this.options.property);if(!value||"0px"===value)return done();var before={},after={};before[this.options.property]="0px",after[this.options.property]=value,element.style.overflow="hidden",element.animate([before,after],this.options).onfinish=function(){element.style.overflow="",done()}},animateOut:function(element,done){var value=element.getComputedCSS(this.options.property);if(!value||"0px"===value)return done();var before={},after={};before[this.options.property]=value,after[this.options.property]="0px",element.style.overflow="hidden",element.animate([before,after],this.options).onfinish=function(){element.style.overflow="",done()}}}}},{}],8:[function(require,module,exports){module.exports=function(specificAttrName){return function(value){var attrName=specificAttrName||this.match;value?this.element.setAttribute(attrName,""):this.element.removeAttribute(attrName)}}},{}],9:[function(require,module,exports){module.exports=function(){return{bound:function(){(!this.expression||this.observer.get())&&this.focus()},focus:function(){this.fragments.afterSync(function(){this.element.focus()}.bind(this))}}}},{}],10:[function(require,module,exports){module.exports=function(){return{created:function(){var focused,mouseEvent;this.element.addEventListener("mousedown",function(){focused=this.matches(":focus"),mouseEvent=!0}),this.element.addEventListener("focus",function(){mouseEvent||this.select()}),this.element.addEventListener("mouseup",function(){focused||this.select(),mouseEvent=!1})}}}},{}],11:[function(require,module,exports){module.exports=function(){return{onlyWhenBound:!0,updated:function(value){var classList=this.element.classList,classes={};value&&("string"==typeof value?value.split(/\s+/).forEach(function(className){className&&(classes[className]=!0)}):"object"==typeof value&&Object.keys(value).forEach(function(className){value[className]&&(classes[className]=!0)})),this.classes&&Object.keys(this.classes).forEach(function(className){classes[className]||classList.remove(className)}),Object.keys(classes).forEach(function(className){classList.add(className)}),this.classes=classes}}}},{}],12:[function(require,module,exports){module.exports=function(){return function(value){value?this.element.classList.add(this.match):this.element.classList.remove(this.match)}}},{}],13:[function(require,module,exports){module.exports=function(){return{compiled:function(){this.element.childNodes.length&&(this.defaultContent=this.fragments.createTemplate(this.element.childNodes))},attached:function(){this.content&&this.content.attached()},detached:function(){this.content&&this.content.detached()},bound:function(){var template=this.context._componentContent||this.defaultContent;template&&(this.content=template.createView(),this.content.bind(this.context),this.element.appendChild(this.content),this.content.attached())},unbound:function(){this.content&&(this.content.dispose(),this.content=null)}}}},{}],14:[function(require,module,exports){function Component(element,contentTemplate){this.element=element,this.created(),this.template?(this._view=this.template.createView(),contentTemplate&&(this.element._componentContent=contentTemplate)):contentTemplate&&(this._view=contentTemplate.createView()),this._view&&(this._view.bind(this),this.element.appendChild(this._view),this._view.attached()),this.ready()}function callOnMixins(context,mixins,name,args){mixins.forEach(function(mixin){"function"==typeof mixin[name]&&mixin[name].apply(context,args)})}module.exports=Component;var Class=require("chip-utils/class"),lifecycle=["created","ready","attached","detached"];Component.onExtend=function(Class,mixins){Class.prototype.mixins=Class.prototype.mixins.concat(mixins),lifecycle.forEach(function(method){delete Class.prototype[method]})},Class.extend(Component,{mixins:[],get componentView(){return this._view},created:function(){callOnMixins(this,this.mixins,"created",arguments)},ready:function(){callOnMixins(this,this.mixins,"ready",arguments)},attached:function(){callOnMixins(this,this.mixins,"attached",arguments),this._view.attached(),this._view.sync()},detached:function(){callOnMixins(this,this.mixins,"detached",arguments),this._view.sync(),this._view.detached()}})},{"chip-utils/class":55}],15:[function(require,module,exports){var Component=require("./component-definition");Array.prototype.slice;module.exports=function(ComponentClass){var componentLoader;if("function"!=typeof ComponentClass)throw new TypeError("Invalid component, requires a subclass of Component or a function which will return such.");return ComponentClass.prototype instanceof Component||(componentLoader=ComponentClass,ComponentClass=void 0),{priority:20,compiled:function(){if(null!==this.element.getAttribute("[unwrap]")){var parent=this.element.parentNode,placeholder=document.createTextNode("");parent.insertBefore(placeholder,this.element),parent.removeChild(this.element),this.element=placeholder,this.unwrapped=!0}else this.unwrapped=!1;this.ComponentClass=ComponentClass,this.compileTemplate();var empty=!this.element.childNodes.length||1===this.element.childNodes.length&&this.element.firstChild.nodeType===Node.TEXT_NODE&&!this.element.firstChild.textContent.trim();empty||(this.contentTemplate=this.fragments.createTemplate(this.element.childNodes))},created:function(){this.make()},updated:function(ComponentClass){this.detached(),this.unmake(),"string"==typeof ComponentClass&&componentLoader&&(ComponentClass=componentLoader.call(this,ComponentClass)),this.ComponentClass=ComponentClass,this.make(),this.attached()},bound:function(){this.element._parentContext=this.context},compileTemplate:function(){if(this.ComponentClass){var proto=this.ComponentClass.prototype;!proto.template||proto.template.compiled||proto._compiling||(proto._compiling=!0,proto.template=this.fragments.createTemplate(proto.template),delete proto._compiling)}},make:function(){this.ComponentClass&&(this.compileTemplate(),this.component=new this.ComponentClass(this.element,this.contentTemplate),this.element.component=this.component)},unmake:function(){this.ComponentClass&&this.component&&(this.component.componentView.dispose(),this.component.element=null,this.element.component=null,this.component=null)},attached:function(){this.component&&this.component.attached()},detached:function(){this.component&&this.component.detached()}}}},{"./component-definition":14}],16:[function(require,module,exports){module.exports=function(specificEventName){return{created:function(){var eventName=specificEventName||this.match,_this=this;this.element.addEventListener(eventName,function(event){if(!_this.shouldSkip(event)){var priorEvent=Object.getOwnPropertyDescriptor(_this.context,"event"),priorElement=Object.getOwnPropertyDescriptor(_this.context,"element");_this.setEvent(event,priorEvent,priorElement),_this.observer.get(),_this.clearEvent()}})},shouldSkip:function(event){return!this.context||event.currentTarget.hasAttribute("disabled")},unbound:function(){this.clearEvent()},setEvent:function(event,priorEventDescriptor,priorElementDescriptor){this.context&&(this.event=event,this.priorEventDescriptor=priorEventDescriptor,this.priorElementDescriptor=priorElementDescriptor,this.lastContext=this.context,this.context.event=event,this.context.element=this.element)},clearEvent:function(){if(this.event){var context=this.lastContext;this.priorEventDescriptor?(Object.defineProperty(context,"event",this.priorEventDescriptor),this.priorEventDescriptor=null):delete context.event,this.priorElementDescriptor?(Object.defineProperty(context,"element",this.priorElementDescriptor),this.priorElementDescriptor=null):delete context.element,this.event=null,this.lastContext=null}}}}},{}],17:[function(require,module,exports){module.exports=function(){return function(value){this.element.innerHTML=null==value?"":value}}},{}],18:[function(require,module,exports){function wrapIfExp(expr,isUnless){return isUnless?"!("+expr+")":expr}module.exports=function(elseIfAttrName,elseAttrName,unlessAttrName,elseUnlessAttrName){return{animated:!0,priority:150,compiled:function(){var element=this.element,expressions=[wrapIfExp(this.expression,this.name===unlessAttrName)],placeholder=document.createTextNode(""),node=element.nextElementSibling;for(this.element=placeholder,element.parentNode.replaceChild(placeholder,element),this.templates=[this.fragments.createTemplate(element)];node;){var expression,next=node.nextElementSibling;if(node.hasAttribute(elseIfAttrName))expression=this.fragments.codifyExpression("attribute",node.getAttribute(elseIfAttrName)),expressions.push(wrapIfExp(expression,!1)),node.removeAttribute(elseIfAttrName);else if(node.hasAttribute(elseUnlessAttrName))expression=this.fragments.codifyExpression("attribute",node.getAttribute(elseUnlessAttrName)),expressions.push(wrapIfExp(expression,!0)),node.removeAttribute(elseUnlessAttrName);else{if(!node.hasAttribute(elseAttrName))break;node.removeAttribute(elseAttrName),next=null}node.remove(),this.templates.push(this.fragments.createTemplate(node)),node=next}this.expression=expressions.map(function(expr,index){return expr+" ? "+index+" : "}).join("")+expressions.length},updated:function(index){this.animate&&this.context&&!this.firstUpdate?this.updatedAnimated(index):this.updatedRegular(index),this.firstUpdate=!1},attached:function(){this.showing&&this.showing.attached()},detached:function(){this.showing&&this.showing.detached()},add:function(view){view.bind(this.context),this.element.parentNode.insertBefore(view,this.element.nextSibling),view.attached()},remove:function(view){view.dispose()},updatedRegular:function(index){this.showing&&(this.remove(this.showing),this.showing=null);var template=this.templates[index];template&&(this.showing=template.createView(),this.add(this.showing))},updatedAnimated:function(index){if(this.lastValue=index,this.animating)return void this.showing.unbind();if(this.showing)return this.animating=!0,this.showing.unbind(),void this.animateOut(this.showing,function(){this.animating&&(this.animating=!1,this.showing&&(this.remove(this.showing),this.showing=null),this.context&&this.updatedAnimated(this.lastValue))});var template=this.templates[index];template&&(this.showing=template.createView(),this.add(this.showing),this.animating=!0,this.animateIn(this.showing,function(){this.animating&&(this.animating=!1,this.lastValue!==index&&this.updatedAnimated(this.lastValue))}))},bound:function(){this.firstUpdate=!0},unbound:function(){this.showing&&this.showing.unbind(),this.lastValue=null,this.animating=!1}}}},{}],19:[function(require,module,exports){var keys={backspace:8,tab:9,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46};module.exports=function(specificKeyName,specificEventName){var eventBinder=require("./events")(specificEventName);return{compiled:function(){var parts=(specificKeyName||this.match).split(/[^a-z]+/);this.element.hasOwnProperty("on"+parts[0])?this.match=parts.shift():this.match="keydown",this.ctrlKey="ctrl"===parts[0],this.ctrlKey?this.keyCode=keys[parts[1]]:this.keyCode=keys[parts[0]]},shouldSkip:function(event){return this.keyCode?eventBinder.shouldSkip.call(this,event)||this.ctrlKey!==(event.ctrlKey||event.metaKey)||this.keyCode!==event.keyCode:eventBinder.shouldSkip.call(this,event)},created:eventBinder.created,unbound:eventBinder.unbound,setEvent:eventBinder.setEvent,clearEvent:eventBinder.clearEvent}}},{"./events":16}],20:[function(require,module,exports){module.exports=function(){return{priority:60,created:function(){this.observer&&(this.observer.getChangeRecords=!0)},updated:function(value){console.log("%cDebug: %c"+this.expression,"color:blue;font-weight:bold","color:#DF8138","=",value)}}}},{}],21:[function(require,module,exports){module.exports=function(specificPropertyName){return{priority:10,created:function(){this.twoWayObserver=this.observe(specificPropertyName||this.camelCase,this.sendUpdate,this)},bound:function(){this.twoWayObserver.bind(this.element.component||this.element)},unbound:function(){this.twoWayObserver.unbind()},sendUpdate:function(value){this.skipSend||(this.observer.set(value),this.skipSend=!0,this.fragments.afterSync(function(){this.skipSend=!1}.bind(this)))},updated:function(value){if(!this.skipSend&&void 0!==value){var context=this.element.component||this.element;context[specificPropertyName||this.camelCase]=value,this.skipSend=!0,this.fragments.afterSync(function(){this.skipSend=!1}.bind(this))}}}}},{}],22:[function(require,module,exports){module.exports=function(specificPropertyName){return{priority:10,updated:function(value){var context=this.element.component||this.element;context[specificPropertyName||this.camelCase]=value}}}},{}],23:[function(require,module,exports){module.exports=function(valueName){return{onlyWhenBound:!0,priority:10,compiled:function(){var valueExpr,element=this.element;if(valueName&&"value"!==valueName&&element.hasAttribute(valueName))valueExpr=this.fragments.codifyExpression("attribute",element.getAttribute(valueName),!0),element.removeAttribute(valueName);else{if(!element.hasAttribute("value"))return!1;valueExpr=this.fragments.codifyExpression("attribute",element.getAttribute("value"),!1)}element.setAttribute("name",this.expression),this.valueObserver=this.observe(valueExpr)},created:function(){this.element.addEventListener("change",function(event){this.element.checked&&this.observer.set(this.valueObserver.get())}.bind(this))},bound:function(){this.valueObserver.bind(this.context)},unbound:function(){this.valueObserver.unbind()},updated:function(value){this.element.checked=value==this.valueObserver.get()}}}},{}],24:[function(require,module,exports){module.exports=function(){return{bound:function(){this.context[this.camelCase||this.expression]=this.element},unbound:function(){this.context[this.camelCase||this.expression]=null}}}},{}],25:[function(require,module,exports){var diff=require("differences-js");module.exports=function(){return{animated:!0,priority:100,compiled:function(){var parent=this.element.parentNode,placeholder=document.createTextNode("");parent.insertBefore(placeholder,this.element),this.template=this.fragments.createTemplate(this.element),this.element=placeholder;var parts=this.expression.split(/\s+in\s+|\s+of\s+/);this.expression=parts.pop();var key=parts.pop();key&&(parts=key.split(/\s*,\s*/),this.valueName=parts.pop(),this.keyName=parts.pop())},created:function(){this.views=[],this.observer.getChangeRecords=!0},attached:function(){this.views.forEach(function(view){view.attached()})},detached:function(){this.views.forEach(function(view){view.detached()})},removeView:function(view){view.dispose(),view._repeatItem_=null},updated:function(value,oldValue,changes){changes&&this.context?(this.animate?this.updateChangesAnimated(value,changes):this.updateChanges(value,changes),Array.isArray(value)&&this.keyName&&this.views.forEach(function(view,i){view.context[this.keyName]=i},this)):this.populate(value)},createView:function(key,value){var view=this.template.createView(),context=value;return this.valueName&&(context=Object.create(this.context),this.keyName&&(context[this.keyName]=key),context[this.valueName]=value,context._origContext_=this.context.hasOwnProperty("_origContext_")?this.context._origContext_:this.context),view.bind(context),view._repeatItem_=value,view},populate:function(value){if(this.animating)return void(this.valueWhileAnimating=value);if(this.views.length&&(this.views.forEach(this.removeView),this.views.length=0),Array.isArray(value)&&value.length){var frag=document.createDocumentFragment();value.forEach(function(item,index){var view=this.createView(index,item);this.views.push(view),frag.appendChild(view)},this),this.element.parentNode.insertBefore(frag,this.element.nextSibling),this.view.inDOM&&this.attached()}},updateChanges:function(value,changes){var addedCount=0;changes.forEach(function(splice){if(splice.removed.length){var removed=this.views.splice(splice.index-addedCount,splice.removed.length);removed.forEach(this.removeView)}addedCount+=splice.addedCount},this),changes.forEach(function(splice){if(splice.addedCount){for(var addedViews=[],fragment=document.createDocumentFragment(),index=splice.index,endIndex=index+splice.addedCount,i=index;endIndex>i;i++){var item=value[i],view=this.createView(i,item);addedViews.push(view),fragment.appendChild(view)}this.views.splice.apply(this.views,[index,0].concat(addedViews));var previousView=this.views[index-1],nextSibling=previousView?previousView.lastViewNode.nextSibling:this.element.nextSibling;this.element.parentNode.insertBefore(fragment,nextSibling),this.view.inDOM&&this.attached()}},this)},updateChangesAnimated:function(value,changes){function whenDone(){if(0===--whenDone.count&&(allRemoved.forEach(this.removeView),this.animating&&(this.animating=!1,this.valueWhileAnimating))){var changes=diff.arrays(this.valueWhileAnimating,animatingValue);this.updateChangesAnimated(this.valueWhileAnimating,changes),this.valueWhileAnimating=null}}if(this.animating)return void(this.valueWhileAnimating=value);var animatingValue=value.slice(),allAdded=[],allRemoved=[];this.animating=!0,whenDone.count=0,changes.forEach(function(splice){for(var addedViews=[],fragment=document.createDocumentFragment(),index=splice.index,endIndex=index+splice.addedCount,removedCount=splice.removed.length,i=index;endIndex>i;i++){var item=value[i],view=this.createView(i,item);addedViews.push(view),fragment.appendChild(view)}var removedViews=this.views.splice.apply(this.views,[index,removedCount].concat(addedViews)),previousView=this.views[index-1],nextSibling=previousView?previousView.lastViewNode.nextSibling:this.element.nextSibling;this.element.parentNode.insertBefore(fragment,nextSibling),this.view.inDOM&&this.attached(),allAdded=allAdded.concat(addedViews),allRemoved=allRemoved.concat(removedViews)},this),allAdded.forEach(function(view){whenDone.count++,this.animateIn(view,whenDone)},this),allRemoved.forEach(function(view){whenDone.count++,view.unbind(),this.animateOut(view,whenDone)},this)},unbound:function(){this.views.forEach(function(view){view.unbind(),view._repeatItem_=null}),this.valueWhileAnimating=null,this.animating=!1}}}},{"differences-js":63}],26:[function(require,module,exports){module.exports=function(isHide){var isShow=!isHide;return{animated:!0,updated:function(value){this.animate&&this.context&&!this.firstUpdate?this.updatedAnimated(value):this.updatedRegular(value),this.firstUpdate=!1},updatedRegular:function(value){value?this.element.style.display="":this.element.style.display="none"},updatedAnimated:function(value){function onFinish(){this.animating&&(this.animating=!1,this.lastValue!==value&&this.updatedAnimated(this.lastValue))}this.lastValue=value,this.animating||(this.animating=!0,!!value==!!isShow?(this.element.style.display="",this.animateIn(this.element,onFinish)):this.animateOut(this.element,function(){this.element.style.display="none",onFinish.call(this)}))},bound:function(){this.firstUpdate=!0},unbound:function(){this.element.style.display="",this.lastValue=null,this.animating=!1}}}},{}],27:[function(require,module,exports){var units={"%":!0,em:!0,px:!0,pt:!0};module.exports=function(specificStyleName,specificUnit){return{compiled:function(){var unit,styleName=specificStyleName||this.match;if(specificUnit)unit=specificUnit;else{var parts=styleName.split(/[^a-z]/i);units.hasOwnProperty(parts[parts.length-1])&&(unit=parts.pop(),styleName=parts.join("-"))}this.unit=unit||"",this.styleName=styleName.replace(/-+(\w)/g,function(_,char){return char.toUpperCase()})},updated:function(value){this.element.style[this.styleName]=null==value?"":value+this.unit}}}},{}],28:[function(require,module,exports){module.exports=function(){return function(value){this.element.textContent=null==value?"":value}}},{}],29:[function(require,module,exports){var inputMethods,defaultInputMethod;module.exports=function(eventsAttrName,fieldAttrName){return{onlyWhenBound:!0,defaultEvents:["change"],compiled:function(){var name=this.element.tagName.toLowerCase(),type=this.element.type;return this.methods=inputMethods[type]||inputMethods[name],this.methods?(eventsAttrName&&this.element.hasAttribute(eventsAttrName)?(this.events=this.element.getAttribute(eventsAttrName).split(" "),this.element.removeAttribute(eventsAttrName)):"option"!==name&&(this.events=this.defaultEvents),fieldAttrName&&this.element.hasAttribute(fieldAttrName)&&(this.valueField=this.element.getAttribute(fieldAttrName),this.element.removeAttribute(fieldAttrName)),void("option"===type&&(this.valueField=this.element.parentNode.valueField))):!1},created:function(){function onChange(){input.get.call(element,valueField)===observer.oldValue||element.readOnly||observer.set(input.get.call(element,valueField))}if(this.events){var element=this.element,observer=this.observer,input=this.methods,valueField=this.valueField;"text"===element.type&&element.addEventListener("keydown",function(event){13===event.keyCode&&onChange()}),this.events.forEach(function(event){element.addEventListener(event,onChange)})}},updated:function(value){this.methods.get.call(this.element,this.valueField)!=value&&this.methods.set.call(this.element,value,this.valueField)}}},defaultInputMethod={get:function(){return this.value},set:function(value){this.value=null==value?"":value}},inputMethods={checkbox:{get:function(){return this.checked},set:function(value){this.checked=!!value}},file:{get:function(){return this.files&&this.files[0]},set:function(){}},select:{get:function(valueField){return valueField?this.options[this.selectedIndex].valueObject:this.value},set:function(value,valueField){value&&valueField?(this.valueObject=value,this.value=value[valueField]):this.value=null==value?"":value}},option:{get:function(valueField){return valueField?this.valueObject[valueField]:this.value},set:function(value,valueField){value&&valueField?(this.valueObject=value,this.value=value[valueField]):this.value=null==value?"":value}},input:defaultInputMethod,textarea:defaultInputMethod}},{}],30:[function(require,module,exports){module.exports=function(value,queryField,queryValue){var url=value||location.href,parts=url.split("?");url=parts[0];var query=parts[1],addedQuery="";if(null!=queryValue&&(addedQuery=queryField+"="+encodeURIComponent(queryValue)),query){var expr=new RegExp("\\b"+queryField+"=[^&]*");expr.test(query)?query=query.replace(expr,addedQuery):addedQuery&&(query+="&"+addedQuery)}else query=addedQuery;return query&&(url+="?"+query),url}},{}],31:[function(require,module,exports){var urlExp=/(^|\s|\()((?:https?|ftp):\/\/[\-A-Z0-9+\u0026@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~(_|])/gi,wwwExp=/(^|[^\/])(www\.[\S]+\.\w{2,}(\b|$))/gim;module.exports=function(value,target){var targetString="";return"string"==typeof target?targetString=' target="'+target+'"':target&&(targetString=' target="_blank"'),(""+value).replace(/<[^>]+>|[^<]+/g,function(match){if("<"===match.charAt(0))return match;var replacedText=match.replace(urlExp,'$1<a href="$2"'+targetString+">$2</a>");return replacedText.replace(wwwExp,'$1<a href="http://$2"'+targetString+">$2</a>")})}},{}],32:[function(require,module,exports){module.exports=function(value){return value&&"0"!==value&&"false"!==value}},{}],33:[function(require,module,exports){var escapeHTML=require("./escape");module.exports=function(value,setter){if(setter)return escapeHTML(value,setter);var lines=(value||"").split(/\r?\n/);return lines.map(escapeHTML).join("<br>\n")}},{"./escape":36}],34:[function(require,module,exports){module.exports=function(value){return value?(value instanceof Date||(value=new Date(value)),isNaN(value.getTime())?"":value.toLocaleString()):""}},{}],35:[function(require,module,exports){module.exports=function(value){return value?(value instanceof Date||(value=new Date(value)),isNaN(value.getTime())?"":value.toLocaleDateString()):""}},{}],36:[function(require,module,exports){var div=document.createElement("div");module.exports=function(value,setter){return setter?(div.innerHTML=value,div.textContent):(div.textContent=value||"",div.innerHTML)}},{}],37:[function(require,module,exports){module.exports=function(value,filterFunc){return Array.isArray(value)?filterFunc?("function"==typeof filterFunc?value=value.filter(filterFunc,this):Array.isArray(filterFunc)?filterFunc.forEach(function(func){value=value.filter(func,this)}):"object"==typeof filterFunc&&Object.keys(filterFunc).forEach(function(key){var func=filterFunc[key];"function"==typeof func&&(value=value.filter(func,this))}),value):value:[]}},{}],38:[function(require,module,exports){module.exports=function(value){return value=parseFloat(value),isNaN(value)?null:value}},{}],39:[function(require,module,exports){module.exports=function(value,formatter,isSetter){return formatter.call(this,value,isSetter)}},{}],40:[function(require,module,exports){module.exports=function(value){return value=parseInt(value),isNaN(value)?null:value}},{}],41:[function(require,module,exports){module.exports=function(value,isSetter){if(isSetter)try{return JSON.parse(value)}catch(err){return null}else try{return JSON.stringify(value)}catch(err){return err.toString()}}},{}],42:[function(require,module,exports){module.exports=function(value){return null==value?[]:Object.keys(value)}},{}],43:[function(require,module,exports){module.exports=function(value,limit){return value&&"function"==typeof value.slice?0>limit?value.slice(limit):void value.slice(0,limit):value}},{}],44:[function(require,module,exports){module.exports=function(value,prefix){return null==prefix&&(prefix="Log:"),console.log("%c"+prefix,"color:blue;font-weight:bold",value),value}},{}],45:[function(require,module,exports){module.exports=function(value){return"string"==typeof value?value.toLowerCase():value}},{}],46:[function(require,module,exports){module.exports=function(value,mapFunc){return null==value||"function"!=typeof mapFunc?value:Array.isArray(value)?value.map(mapFunc,this):mapFunc.call(this,value)}},{}],47:[function(require,module,exports){var escapeHTML=require("./escape");module.exports=function(value,setter){if(setter)return escapeHTML(value,setter);var paragraphs=(value||"").split(/\r?\n\s*\r?\n/),escaped=paragraphs.map(function(paragraph){var lines=paragraph.split(/\r?\n/);return lines.map(escapeHTML).join("<br>\n")});return"<p>"+escaped.join("</p>\n\n<p>")+"</p>"}},{"./escape":36
}],48:[function(require,module,exports){var escapeHTML=require("./escape");module.exports=function(value,setter){if(setter)return escapeHTML(value,setter);var lines=(value||"").split(/\r?\n/),escaped=lines.map(function(line){return escapeHTML(line)||"<br>"});return"<p>"+escaped.join("</p>\n<p>")+"</p>"}},{"./escape":36}],49:[function(require,module,exports){module.exports=function(value,reduceFunc,initialValue){return null==value||"function"!=typeof mapFunc?value:Array.isArray(value)?3===arguments.length?value.reduce(reduceFunc,initialValue):value.reduce(reduceFunc):3===arguments.length?reduceFunc(initialValue,value):void 0}},{}],50:[function(require,module,exports){module.exports=function(value){return Array.isArray(value)?value.slice().reverse():value}},{}],51:[function(require,module,exports){module.exports=function(value,index,endIndex){return Array.isArray(value)?value.slice(index,endIndex):value}},{}],52:[function(require,module,exports){module.exports=function(value,sortFunc,dir){if(!sortFunc||!Array.isArray(value))return value;if(dir="desc"===dir?-1:1,"string"==typeof sortFunc){var parts=sortFunc.split(":"),prop=parts[0],dir2=parts[1];dir2="desc"===dir2?-1:1,dir=dir||dir2,sortFunc=function(a,b){return a[prop]>b[prop]?dir:a[prop]<b[prop]?-dir:0}}else if(-1===dir){var origFunc=sortFunc;sortFunc=function(a,b){return-origFunc(a,b)}}return value.slice().sort(sortFunc.bind(this))}},{}],53:[function(require,module,exports){module.exports=function(value){return value?(value instanceof Date||(value=new Date(value)),isNaN(value.getTime())?"":value.toLocaleTimeString()):""}},{}],54:[function(require,module,exports){module.exports=function(value){return"string"==typeof value?value.toUpperCase():value}},{}],55:[function(require,module,exports){function Class(){}function extend(Subclass){var prototypes,SuperClass=this;"function"!=typeof Subclass?(prototypes=slice.call(arguments),Subclass=function(){SuperClass.apply(this,arguments)}):prototypes=slice.call(arguments,1),Object.setPrototypeOf?Object.setPrototypeOf(Subclass,this):Subclass.__proto__=this,prototypes.forEach(function(proto){"function"==typeof proto?addStatics(proto,Subclass):proto.hasOwnProperty("static")&&addStatics(proto["static"],Subclass)});var descriptors=getDescriptors(prototypes);return descriptors.constructor={writable:!0,configurable:!0,value:Subclass},descriptors["super"]={configurable:!0,value:SuperClass.prototype},Subclass.prototype=Object.create(this.prototype,descriptors),"function"==typeof SuperClass.onExtend&&SuperClass.onExtend(Subclass,prototypes),Subclass}function getDescriptors(objects){var descriptors={};return objects.forEach(function(object){"function"==typeof object&&(object=object.prototype),Object.getOwnPropertyNames(object).forEach(function(name){if("static"!==name){var descriptor=Object.getOwnPropertyDescriptor(object,name);"function"==typeof descriptor.value&&(descriptor.enumerable=!1),descriptors[name]=descriptor}})}),descriptors}function addStatics(statics,Subclass){Object.keys(statics).forEach(function(key){var descriptor=Object.getOwnPropertyDescriptor(statics,key);descriptor.configurable&&Object.defineProperty(Subclass,key,descriptor)})}function makeInstanceOf(object){var args=slice.call(arguments,1);return Object.defineProperties(object,getDescriptors([this.prototype])),this.apply(object,args),object}var slice=Array.prototype.slice;Class.extend=extend,Class.makeInstanceOf=makeInstanceOf,module.exports=Class},{}],56:[function(require,module,exports){function EventTarget(){Object.defineProperty(this,"__event_node",{value:document.createDocumentFragment()})}module.exports=EventTarget;var Class=require("./class");Class.extend(EventTarget,{addEventListener:function(type,listener){this.__event_node.addEventListener(type,listener)},on:function(type,listener){this.addEventListener(type,listener)},removeEventListener:function(type,listener){this.__event_node.removeEventListener(type,listener),listener&&listener.__event_one&&this.__event_node.removeEventListener(type,listener.__event_one)},off:function(type,listener){this.removeEventListener(type,listener)},one:function(type,listener){if("function"==typeof listener){if(!listener.__event_one){var self=this;Object.defineProperty(listener,"__event_one",{value:function(event){self.removeEventListener(type,listener.__event_one),listener.call(self,event)}})}this.addEventListener(type,listener.__event_one)}},dispatchEvent:function(event){return Object.defineProperty(event,"target",{value:this}),this.__event_node.dispatchEvent(event)}})},{"./class":55}],57:[function(require,module,exports){module.exports=require("./src/chip")},{"./src/chip":60}],58:[function(require,module,exports){function App(options){options=Object.assign({},defaultOptions,options),options.binders=Object.assign({},defaultOptions.binders,options.binders),options.formatters=Object.assign({},defaultOptions.formatters,options.formatters),options.animations=Object.assign({},defaultOptions.animations,options.animations),options.animations=Object.assign({},defaultOptions.animations,options.animations),options.components=Object.assign({},defaultOptions.components,options.components),EventTarget.call(this),this.fragments=fragments.create(options),this.components={},this.fragments.app=this,this.location=Location.create(options),this.defaultMixin=defaultMixin(this),this._listening=!1,this.useCustomElements=options.useCustomElements,this.rootElement=options.rootElement||document.documentElement,this.sync=this.fragments.sync,this.syncNow=this.fragments.syncNow,this.afterSync=this.fragments.afterSync,this.onSync=this.fragments.onSync,this.offSync=this.fragments.offSync,this.observe=this.fragments.observe.bind(this.fragments),this.location.on("change",this.sync),this.fragments.setExpressionDelimiters("attribute","{{","}}",!options.curliesInAttributes),this.fragments.animateAttribute=options.animateAttribute,Object.keys(options.components).forEach(function(name){this.component(name,options.components[name])},this)}function createElementPrototype(fragments,ComponentClass){return Object.create(HTMLElement.prototype,{createdCallback:{value:function(){ComponentClass.prototype.template&&!ComponentClass.prototype.template.compiled&&(ComponentClass.prototype.template=fragments.createTemplate(ComponentClass.prototype.template)),fragments.compiling||(this.component=new ComponentClass(this))}},attachedCallback:{value:function(){this.component.attached()}},detachedCallback:{value:function(){this.component.detached()}}})}module.exports=App;var componentBinding=require("fragments-built-ins/binders/component"),Component=require("fragments-built-ins/binders/component-definition"),Location=require("routes-js").Location,EventTarget=require("chip-utils/event-target"),fragments=require("fragments-js"),defaultOptions=require("./default-options"),defaultMixin=require("./mixins/default"),slice=Array.prototype.slice;EventTarget.extend(App,{init:function(root){return this.inited?void 0:"loading"===document.readyState?void document.addEventListener("DOMContentLoaded",this.init.bind(this,root)):(this.inited=!0,root&&(this.rootElement=root),this.fragments.bindElement(this.rootElement,this),this.rootElement.attached(),this)},component:function(name,definition){if(1===arguments.length)return this.components[name];var ComponentClass;if(definition.prototype instanceof Component)ComponentClass=definition;else{var definitions=slice.call(arguments,1);definitions.unshift(this.defaultMixin),ComponentClass=Component.extend.apply(Component,definitions)}if(ComponentClass.prototype.tagName=name,this.components[name]=ComponentClass,this.useCustomElements&&document.registerElement){var proto=createElementPrototype(this,ComponentClass);return document.registerElement(name,{prototype:proto})}return this.fragments.registerElement(name,componentBinding(ComponentClass)),this},redirect:function(url){return this.location.url=url},get listening(){return this._listening},listen:function(){var app=this;return this._listening=!0,"loading"===document.readyState?(document.addEventListener("DOMContentLoaded",this.listen.bind(this)),this):(this._locationChangeHandler=function(event){app.url=event.detail.url,app.path=event.detail.path,app.query=event.detail.query,app.dispatchEvent(new CustomEvent("urlChange",{detail:event.detail}))},this._clickHandler=function(event){var anchor;if((anchor=event.target.closest("a[href]"))&&!event.defaultPrevented&&location.protocol===anchor.protocol&&location.host===anchor.host.replace(/:80$|:443$/,"")){var url=anchor.getAttribute("href").replace(/^#/,"");event.metaKey||event.ctrlKey||anchor.hasAttribute("target")||(event.preventDefault(),anchor.href!==location.href+"#"&&(anchor.disabled||app.redirect(url)))}},this.location.on("change",this._locationChangeHandler),this.rootElement.addEventListener("click",this._clickHandler),this.url=this.location.url,this.path=this.location.path,this.query=this.location.query,void this.dispatchEvent(new CustomEvent("urlChange",{detail:{url:this.url,path:this.path,query:this.query}})))},stop:function(){this.location.off("change",this._locationChangeHandler),this.rootElement.removeEventListener("click",this._clickHandler)}}),"function"!=typeof Object.assign&&!function(){Object.assign=function(target){"use strict";if(void 0===target||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(void 0!==source&&null!==source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}}()},{"./default-options":61,"./mixins/default":62,"chip-utils/event-target":56,"fragments-built-ins/binders/component":15,"fragments-built-ins/binders/component-definition":14,"fragments-js":70,"routes-js":84}],59:[function(require,module,exports){var Route=require("routes-js").Route,IfBinder=require("fragments-built-ins/binders/if");module.exports=function(){var ifBinder=IfBinder(),attached=ifBinder.attached,unbound=ifBinder.unbound,detached=ifBinder.detached;return ifBinder.compiled=function(){var noRoute;for(this.app=this.fragments.app,this.routes=[],this.templates=[],this.expression="";this.element.firstChild;){var child=this.element.firstChild;if(this.element.removeChild(child),child.nodeType===Node.ELEMENT_NODE)if(child.hasAttribute("[path]")){var path=child.getAttribute("[path]");child.removeAttribute("[path]"),this.routes.push(new Route(path)),this.templates.push(this.fragments.createTemplate(child))}else child.hasAttribute("[noroute]")&&(child.removeAttribute("[noroute]"),noRoute=this.fragments.createTemplate(child))}noRoute&&this.templates.push(noRoute)},ifBinder.add=function(view){view.bind(this.context),this.element.appendChild(view),this.attached()},ifBinder.created=function(){this.onUrlChange=this.onUrlChange.bind(this)},ifBinder.attached=function(){attached.call(this);for(var node=this.element.parentNode;node&&!node.matchedRoutePath;)node=node.parentNode;this.baseURI=node&&node.matchedRoutePath||"",this.app.on("urlChange",this.onUrlChange),this.app.listening&&this.onUrlChange()},ifBinder.detached=function(){detached.call(this),this.currentIndex=void 0,this.app.off("urlChange",this.onUrlChange)},ifBinder.unbound=function(){unbound.call(this),delete this.context.params},ifBinder.onUrlChange=function(){this.context&&(null===this.element.baseURI?setTimeout(function(){this.context&&this.checkForChange()}.bind(this)):this.checkForChange())},ifBinder.checkForChange=function(){var matched,fullUrl=this.app.path,localUrl=null,newIndex=this.routes.length;delete this.context.params,0===fullUrl.indexOf(this.baseURI)&&(localUrl=fullUrl.replace(this.baseURI,"")),null!==localUrl&&(matched=this.routes.some(function(route,index){if(route.match(localUrl)){if(route.params.hasOwnProperty("*")&&route.params["*"]){var afterLength=route.params["*"].length;this.element.matchedRoutePath=this.baseURI+localUrl.slice(0,-afterLength)}else this.element.matchedRoutePath=fullUrl;var params=this.context.params=Object.create(route.params),query=this.app.query;return Object.keys(query).forEach(function(key){params.hasOwnProperty(key)||(params[key]=query[key])}),newIndex=index,!0}},this)),(matched||newIndex!==this.currentIndex)&&this.element.dispatchEvent(new Event("routed")),newIndex!==this.currentIndex&&(this.currentIndex=newIndex,this.updated(this.currentIndex))},ifBinder}},{"fragments-built-ins/binders/if":18,"routes-js":84}],60:[function(require,module,exports){function chip(options){var app=new App(options);return app.init(),app}var App=require("./app");module.exports=chip,chip.App=App,chip.Class=require("chip-utils/class"),chip.EventTarget=require("chip-utils/event-target"),chip.routes=require("routes-js")},{"./app":58,"chip-utils/class":55,"chip-utils/event-target":56,"routes-js":84}],61:[function(require,module,exports){module.exports={useCustomElements:!1,curliesInAttributes:!1,animateAttribute:"[animate]",binders:{"(keydown.*)":require("fragments-built-ins/binders/key-events")(null,"keydown"),"(keyup.*)":require("fragments-built-ins/binders/key-events")(null,"keyup"),"(enter)":require("fragments-built-ins/binders/key-events")("enter"),"(esc)":require("fragments-built-ins/binders/key-events")("esc"),"(*)":require("fragments-built-ins/binders/events")(),"{*}":require("fragments-built-ins/binders/properties")(),"{{*}}":require("fragments-built-ins/binders/properties-2-way")(),"*?":require("fragments-built-ins/binders/attribute-names")(),"[content]":require("fragments-built-ins/binders/component-content")(),"[show]":require("fragments-built-ins/binders/show")(!1),"[hide]":require("fragments-built-ins/binders/show")(!0),"[for]":require("fragments-built-ins/binders/repeat")(),"#*":require("fragments-built-ins/binders/ref")(),"[text]":require("fragments-built-ins/binders/text")(),"[html]":require("fragments-built-ins/binders/html")(),"[src]":require("fragments-built-ins/binders/properties")("src"),"[log]":require("fragments-built-ins/binders/log")(),"[class]":require("fragments-built-ins/binders/class")(),"[.*]":require("fragments-built-ins/binders/classes")(),"[style.*]":require("fragments-built-ins/binders/styles")(),"[autofocus]":require("fragments-built-ins/binders/autofocus")(),"[autoselect]":require("fragments-built-ins/binders/autoselect")(),"[name]":require("fragments-built-ins/binders/radio")("[value]"),"[value]":require("fragments-built-ins/binders/value")("[value-events]","[value-field]"),"[component]":require("fragments-built-ins/binders/component")(function(componentName){return this.fragments.app.component(componentName)}),"[if]":require("fragments-built-ins/binders/if")("[else-if]","[else]","[unless]","[unless-if]"),"[unless]":require("fragments-built-ins/binders/if")("[else-if]","[else]","[unless]","[unless-if]"),"[route]":require("./binders/route")()},formatters:{addQuery:require("fragments-built-ins/formatters/add-query"),autolink:require("fragments-built-ins/formatters/autolink"),bool:require("fragments-built-ins/formatters/bool"),br:require("fragments-built-ins/formatters/br"),dateTime:require("fragments-built-ins/formatters/date-time"),date:require("fragments-built-ins/formatters/date"),escape:require("fragments-built-ins/formatters/escape"),filter:require("fragments-built-ins/formatters/filter"),"float":require("fragments-built-ins/formatters/float"),format:require("fragments-built-ins/formatters/format"),"int":require("fragments-built-ins/formatters/int"),json:require("fragments-built-ins/formatters/json"),keys:require("fragments-built-ins/formatters/keys"),limit:require("fragments-built-ins/formatters/limit"),log:require("fragments-built-ins/formatters/log"),lower:require("fragments-built-ins/formatters/lower"),map:require("fragments-built-ins/formatters/map"),newline:require("fragments-built-ins/formatters/newline"),p:require("fragments-built-ins/formatters/p"),reduce:require("fragments-built-ins/formatters/reduce"),reverse:require("fragments-built-ins/formatters/reverse"),slice:require("fragments-built-ins/formatters/slice"),sort:require("fragments-built-ins/formatters/sort"),time:require("fragments-built-ins/formatters/time"),upper:require("fragments-built-ins/formatters/upper")},animations:{fade:require("fragments-built-ins/animations/fade")(),slide:require("fragments-built-ins/animations/slide")(),"slide-h":require("fragments-built-ins/animations/slide-horizontal")(),"slide-move":require("fragments-built-ins/animations/slide-move")(),"slide-move-h":require("fragments-built-ins/animations/slide-move-horizontal")(),"slide-fade":require("fragments-built-ins/animations/slide-fade")(),"slide-fade-h":require("fragments-built-ins/animations/slide-fade-horizontal")()}}},{"./binders/route":59,"fragments-built-ins/animations/fade":1,"fragments-built-ins/animations/slide":7,"fragments-built-ins/animations/slide-fade":3,"fragments-built-ins/animations/slide-fade-horizontal":2,"fragments-built-ins/animations/slide-horizontal":4,"fragments-built-ins/animations/slide-move":6,"fragments-built-ins/animations/slide-move-horizontal":5,"fragments-built-ins/binders/attribute-names":8,"fragments-built-ins/binders/autofocus":9,"fragments-built-ins/binders/autoselect":10,"fragments-built-ins/binders/class":11,"fragments-built-ins/binders/classes":12,"fragments-built-ins/binders/component":15,"fragments-built-ins/binders/component-content":13,"fragments-built-ins/binders/events":16,"fragments-built-ins/binders/html":17,"fragments-built-ins/binders/if":18,"fragments-built-ins/binders/key-events":19,"fragments-built-ins/binders/log":20,"fragments-built-ins/binders/properties":22,"fragments-built-ins/binders/properties-2-way":21,"fragments-built-ins/binders/radio":23,"fragments-built-ins/binders/ref":24,"fragments-built-ins/binders/repeat":25,"fragments-built-ins/binders/show":26,"fragments-built-ins/binders/styles":27,"fragments-built-ins/binders/text":28,"fragments-built-ins/binders/value":29,"fragments-built-ins/formatters/add-query":30,"fragments-built-ins/formatters/autolink":31,"fragments-built-ins/formatters/bool":32,"fragments-built-ins/formatters/br":33,"fragments-built-ins/formatters/date":35,"fragments-built-ins/formatters/date-time":34,"fragments-built-ins/formatters/escape":36,"fragments-built-ins/formatters/filter":37,"fragments-built-ins/formatters/float":38,"fragments-built-ins/formatters/format":39,"fragments-built-ins/formatters/int":40,"fragments-built-ins/formatters/json":41,"fragments-built-ins/formatters/keys":42,"fragments-built-ins/formatters/limit":43,"fragments-built-ins/formatters/log":44,"fragments-built-ins/formatters/lower":45,"fragments-built-ins/formatters/map":46,"fragments-built-ins/formatters/newline":47,"fragments-built-ins/formatters/p":48,"fragments-built-ins/formatters/reduce":49,"fragments-built-ins/formatters/reverse":50,"fragments-built-ins/formatters/slice":51,"fragments-built-ins/formatters/sort":52,"fragments-built-ins/formatters/time":53,"fragments-built-ins/formatters/upper":54}],62:[function(require,module,exports){module.exports=function(app){return{app:app,sync:app.sync,syncNow:app.syncNow,afterSync:app.afterSync,onSync:app.onSync,offSync:app.offSync,created:function(){Object.defineProperties(this,{_observers:{configurable:!0,value:[]},_listeners:{configurable:!0,value:[]},_attached:{configurable:!0,value:!1}})},attached:function(){this._attached=!0,this._observers.forEach(function(observer){observer.bind(this)},this),this._listeners.forEach(function(item){item.target.addEventListener(item.eventName,item.listener)})},detached:function(){this._attached=!1,this._observers.forEach(function(observer){observer.unbind()}),this._listeners.forEach(function(item){item.target.removeEventListener(item.eventName,item.listener)})},observe:function(expr,callback){if("function"!=typeof callback)throw new TypeError("callback must be a function");var observer=app.observe(expr,callback,this);return this._observers.push(observer),this._attached&&observer.bind(this),observer},listen:function(target,eventName,listener,context){if("string"==typeof target&&(context=listener,listener=eventName,eventName=target,target=this),"function"!=typeof listener)throw new TypeError("listener must be a function");listener=listener.bind(context||this);var listenerData={target:target,eventName:eventName,listener:listener};this._listeners.push(listenerData),this._attached&&target.addEventListener(eventName,listener)}}}},{}],63:[function(require,module,exports){module.exports=require("./src/diff")},{"./src/diff":64}],64:[function(require,module,exports){var diff=exports;!function(){function ChangeRecord(object,type,name,oldValue){this.object=object,this.type=type,this.name=name,this.oldValue=oldValue}function Splice(object,index,removed,addedCount){ChangeRecord.call(this,object,"splice",String(index)),this.index=index,this.removed=removed,this.addedCount=addedCount}function clone(value,deep){if(Array.isArray(value))return deep?value.map(function(value){return clone(value,deep)}):value.slice();if(value&&"object"==typeof value){if(value.valueOf()!==value)return new value.constructor(value.valueOf());var copy={};for(var key in value){var objValue=value[key];deep&&(objValue=clone(objValue,deep)),copy[key]=objValue}return copy}return value}function diffValues(value,oldValue){if(value===oldValue)return!1;if(Array.isArray(value)&&Array.isArray(oldValue)){var splices=diffArrays(value,oldValue);return splices.length?splices:!1}if(value&&oldValue&&"object"==typeof value&&"object"==typeof oldValue){var valueValue=value.valueOf(),oldValueValue=oldValue.valueOf();if("object"!=typeof valueValue&&"object"!=typeof oldValueValue)return valueValue!==oldValueValue;var changeRecords=diffObjects(value,oldValue);return changeRecords.length?changeRecords:!1}return diffBasic(value,oldValue)}function diffBasic(value,oldValue){if(value&&oldValue&&"object"==typeof value&&"object"==typeof oldValue){var valueValue=value.valueOf(),oldValueValue=oldValue.valueOf();if("object"!=typeof valueValue&&"object"!=typeof oldValueValue)return diffBasic(valueValue,oldValueValue)}return"number"==typeof value&&"number"==typeof oldValue&&isNaN(value)&&isNaN(oldValue)?!1:value!==oldValue}function diffObjects(value,oldValue){if(!value||!oldValue||"object"!=typeof value||"object"!=typeof oldValue)throw new TypeError("Both values for diff.object must be objects");var prop,propOldValue,propValue,changeRecords=[];for(prop in oldValue)propOldValue=oldValue[prop],propValue=value[prop],(void 0===propValue||diffBasic(propValue,propOldValue))&&(prop in value?diffBasic(propValue,propOldValue)&&changeRecords.push(new ChangeRecord(value,"update",prop,propOldValue)):changeRecords.push(new ChangeRecord(value,"delete",prop,propOldValue)));for(prop in value)propValue=value[prop],prop in oldValue||changeRecords.push(new ChangeRecord(value,"add",prop));return Array.isArray(value)&&value.length!==oldValue.length&&changeRecords.push(new ChangeRecord(value,"update","length",oldValue.length)),changeRecords}function diffArrays(value,oldValue){if(!Array.isArray(value)||!Array.isArray(oldValue))throw new TypeError("Both values for diff.array must be arrays");var currentStart=0,currentEnd=value.length,oldStart=0,oldEnd=oldValue.length,minLength=Math.min(currentEnd,oldEnd),prefixCount=sharedPrefix(value,oldValue,minLength),suffixCount=sharedSuffix(value,oldValue,minLength-prefixCount);if(currentStart+=prefixCount,oldStart+=prefixCount,currentEnd-=suffixCount,oldEnd-=suffixCount,currentEnd-currentStart===0&&oldEnd-oldStart===0)return[];if(currentStart===currentEnd)return[new Splice(value,currentStart,oldValue.slice(oldStart,oldEnd),0)];if(oldStart===oldEnd)return[new Splice(value,currentStart,[],currentEnd-currentStart)];for(var distances=calcEditDistances(value,currentStart,currentEnd,oldValue,oldStart,oldEnd),ops=spliceOperationsFromEditDistances(distances),splice=null,splices=[],index=currentStart,oldIndex=oldStart,i=0,l=ops.length;l>i;i++){var op=ops[i];op===EDIT_LEAVE?(splice&&(splices.push(splice),splice=null),index++,oldIndex++):op===EDIT_UPDATE?(splice||(splice=new Splice(value,index,[],0)),splice.addedCount++,index++,splice.removed.push(oldValue[oldIndex]),oldIndex++):op===EDIT_ADD?(splice||(splice=new Splice(value,index,[],0)),splice.addedCount++,index++):op===EDIT_DELETE&&(splice||(splice=new Splice(value,index,[],0)),splice.removed.push(oldValue[oldIndex]),oldIndex++)}return splice&&splices.push(splice),splices}function sharedPrefix(current,old,searchLength){for(var i=0;searchLength>i;i++)if(diffBasic(current[i],old[i]))return i;return searchLength}function sharedSuffix(current,old,searchLength){for(var index1=current.length,index2=old.length,count=0;searchLength>count&&!diffBasic(current[--index1],old[--index2]);)count++;return count}function spliceOperationsFromEditDistances(distances){for(var i=distances.length-1,j=distances[0].length-1,current=distances[i][j],edits=[];i>0||j>0;)if(0!==i)if(0!==j){var min,northWest=distances[i-1][j-1],west=distances[i-1][j],north=distances[i][j-1];min=north>west?northWest>west?west:northWest:northWest>north?north:northWest,min===northWest?(northWest===current?edits.push(EDIT_LEAVE):(edits.push(EDIT_UPDATE),current=northWest),i--,j--):min===west?(edits.push(EDIT_DELETE),i--,current=west):(edits.push(EDIT_ADD),j--,current=north)}else edits.push(EDIT_DELETE),i--;else edits.push(EDIT_ADD),j--;return edits.reverse(),edits}function calcEditDistances(current,currentStart,currentEnd,old,oldStart,oldEnd){var i,j,rowCount=oldEnd-oldStart+1,columnCount=currentEnd-currentStart+1,distances=new Array(rowCount);for(i=0;rowCount>i;i++)distances[i]=new Array(columnCount),distances[i][0]=i;for(j=0;columnCount>j;j++)distances[0][j]=j;for(i=1;rowCount>i;i++)for(j=1;columnCount>j;j++)if(diffBasic(current[currentStart+j-1],old[oldStart+i-1])){var north=distances[i-1][j]+1,west=distances[i][j-1]+1;distances[i][j]=west>north?north:west}else distances[i][j]=distances[i-1][j-1];return distances}diff.clone=clone,diff.values=diffValues,diff.basic=diffBasic,diff.objects=diffObjects,diff.arrays=diffArrays,Splice.prototype=Object.create(ChangeRecord.prototype);var EDIT_LEAVE=0,EDIT_UPDATE=1,EDIT_ADD=2,EDIT_DELETE=3}()},{}],65:[function(require,module,exports){module.exports=require("./src/expressions")},{"./src/expressions":66}],66:[function(require,module,exports){function getVariables(globals,extraArgs){var variables={};return Object.keys(exports.globals).forEach(function(key){variables[key]=exports.globals[key]}),globals&&Object.keys(globals).forEach(function(key){variables[key]=globals[key]}),extraArgs.forEach(function(key){variables[key]=null}),variables}function compileExpression(original,expr,globals,formatters,extraArgs){var func,args=["_globals_","_formatters_"].concat(extraArgs).concat(expr);try{func=Function.apply(null,args)}catch(e){throw new Error("Bad expression: "+original+"\nCompiled expression:\n"+expr+"\n"+e.message)}return bindArguments(func,globals,formatters)}function bindArguments(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)))}}var slice=Array.prototype.slice,strings=require("./strings"),formatterParser=require("./formatters"),propertyChains=require("./property-chains"),valueProperty="_value_",cache={};exports.globals={},exports.parse=function(expr,globals,formatters,extraArgs){Array.isArray(extraArgs)||(extraArgs=[]);var cacheKey=expr+"|"+extraArgs.join(","),func=cache[cacheKey];if(func)return func;var original=expr,isSetter=extraArgs[0]===valueProperty;if(expr=strings.pullOutStrings(expr),expr=formatterParser.parseFormatters(expr),expr=propertyChains.parseExpression(expr,getVariables(globals,extraArgs)),!isSetter){var lines=expr.split("\n");lines[lines.length-1]="return "+lines[lines.length-1],expr=lines.join("\n")}return expr=strings.putInStrings(expr),func=compileExpression(original,expr,globals,formatters,extraArgs),func.expr=expr,cache[cacheKey]=func,func},exports.parseSetter=function(expr,globals,formatters,extraArgs){return Array.isArray(extraArgs)||(extraArgs=[]),extraArgs.unshift(valueProperty),expr="!"===expr.charAt(0)?expr.slice(1).replace(/(\s*\||$)/," = !_value_$1"):expr.replace(/(\s*\||$)/," = _value_$1"),exports.parse(expr,globals,formatters,extraArgs)}},{"./formatters":67,"./property-chains":68,"./strings":69}],67:[function(require,module,exports){var pipeRegex=/\|(\|)?/g,placeholder="@@@",placeholderRegex=new RegExp("\\s*"+placeholder+"\\s*"),setterRegex=/\s=\s/,formatterRegex=/^([^\(]+)(?:\((.*)\))?$/,argSeparator=/\s*,\s*/g;exports.parseFormatters=function(expr){if(expr=expr.replace(pipeRegex,function(match,orIndicator){return orIndicator?match:placeholder}),formatters=expr.split(placeholderRegex),expr=formatters.shift(),!formatters.length)return expr;var setter="",value=expr;if(setterRegex.test(expr)){var parts=expr.split(setterRegex);setter=parts[0]+" = ",value=parts[1]}return formatters.forEach(function(formatter){var match=formatter.trim().match(formatterRegex);if(!match)throw new Error("Formatter is invalid: "+formatter);var formatterName=match[1],args=match[2]?match[2].split(argSeparator):[];args.unshift(value),setter&&args.push(!0),value="_formatters_."+formatterName+".call(this, "+args.join(", ")+")"}),setter+value}},{}],68:[function(require,module,exports){function parsePropertyChains(expr){var chain,parsedExpr="",prevCurrentIndex=currentIndex,prevLastIndex=propertyRegex.lastIndex;for(currentIndex=0,propertyRegex.lastIndex=0;(chain=nextChain(expr))!==!1;)parsedExpr+=chain;return currentIndex=prevCurrentIndex,propertyRegex.lastIndex=prevLastIndex,parsedExpr}function nextChain(expr){if(finishedChain)return finishedChain=!1;var match=propertyRegex.exec(expr);if(!match)return finishedChain=!0,expr.slice(currentIndex);var prefix=match[1],objIndicator=match[2],propChain=match[3],postfix=match[4],colonOrParen=match[5];match=match[0];var skipped=expr.slice(currentIndex,propertyRegex.lastIndex-match.length);return currentIndex=propertyRegex.lastIndex,objIndicator&&":"===colonOrParen?skipped+match:skipped+parseChain(prefix,propChain,postfix,colonOrParen,expr)}function parseChain(prefix,propChain,postfix,paren,expr){continuation="."===prefix,continuation&&(propChain="."+propChain,prefix="");var links=splitLinks(propChain),newChain="";return 1!==links.length||continuation||paren?(continuation||(newChain="("),links.forEach(function(link,index){index!==links.length-1?newChain+=parsePart(link,index):parens[paren]?(continuation&&0===index&&index++,postfix=postfix.replace(paren,""),newChain+="("===paren?parseFunction(link,index,expr):parseBrackets(link,index,expr)):newChain+="_ref"+currentReference+link}),"."!==expr.charAt(propertyRegex.lastIndex)&&(newChain+=")")):(link=links[0],newChain=addThisOrGlobal(link)),prefix+newChain+postfix}function splitLinks(chain){for(var match,index=0,parts=[];match=chainLinksRegex.exec(chain);)1!==chainLinksRegex.lastIndex&&(parts.push(chain.slice(index,chainLinksRegex.lastIndex-1)),index=chainLinksRegex.lastIndex-1);return parts.push(chain.slice(index)),parts}function addThisOrGlobal(chain){var prop=chain.split(chainLinkRegex).shift();return globals.hasOwnProperty(prop)?null===globals[prop]?chain:"_globals_."+chain:defaultGlobals.hasOwnProperty(prop)?chain:"this."+chain}function parseFunction(link,index,expr){var call=getFunctionCall(expr);link=0===index?addThisOrGlobal(link):"_ref"+currentReference+link;var calledLink=link+"(~~insideParens~~)";"."===expr.charAt(propertyRegex.lastIndex)&&(calledLink=parsePart(calledLink,index)),link="typeof "+link+" !== 'function' ? void 0 : "+calledLink;var insideParens=call.slice(1,-1),ref=currentReference;return link=link.replace("~~insideParens~~",parsePropertyChains(insideParens)),currentReference=ref,link}function parseBrackets(link,index,expr){var call=getFunctionCall(expr),insideBrackets=call.slice(1,-1),evaledLink=parsePart(link,index);index+=1,link="[~~insideBrackets~~]",link="."===expr.charAt(propertyRegex.lastIndex)?parsePart(link,index):"_ref"+currentReference+link,
link=evaledLink+link;var ref=currentReference;return link=link.replace("~~insideBrackets~~",parsePropertyChains(insideBrackets)),currentReference=ref,link}function getFunctionCall(expr){for(var startIndex=propertyRegex.lastIndex,open=expr.charAt(startIndex-1),close=parens[open],endIndex=startIndex-1,parenCount=1;endIndex++<expr.length;){var ch=expr.charAt(endIndex);if(ch===open?parenCount++:ch===close&&parenCount--,0===parenCount)break}return currentIndex=propertyRegex.lastIndex=endIndex+1,open+expr.slice(startIndex,endIndex)+close}function parsePart(part,index){part=0!==index||continuation?"_ref"+currentReference+part:addThisOrGlobal(part),currentReference=++referenceCount;var ref="_ref"+currentReference;return"("+ref+" = "+part+") == null ? void 0 : "}function replaceAndsAndOrs(expr){return expr.replace(andRegex," && ").replace(orRegex," || ")}function addReferences(expr){if(referenceCount){for(var refs=[],i=1;referenceCount>=i;i++)refs.push("_ref"+i);expr="var "+refs.join(", ")+";\n"+expr}return expr}var referenceCount=0,currentReference=0,currentIndex=0,finishedChain=!1,continuation=!1,globals=null,defaultGlobals={"return":null,"true":null,"false":null,undefined:null,"null":null,"this":null,window:null,Math:null,parseInt:null,parseFloat:null,isNaN:null,Array:null,"typeof":null,_globals_:null,_formatters_:null,_value_:null},propertyRegex=/((\{|,|\.)?\s*)([a-z$_\$](?:[a-z_\$0-9\.-]|\[['"\d]+\])*)(\s*(:|\(|\[)?)/gi,chainLinksRegex=/\.|\[/g,chainLinkRegex=/\.|\[|\(/,andRegex=/ and /g,orRegex=/ or /g;exports.parseExpression=function(expr,_globals){if(referenceCount=0,currentReference=0,currentIndex=0,finishedChain=!1,continuation=!1,globals=_globals,expr=replaceAndsAndOrs(expr),-1!==expr.indexOf(" = ")){var parts=expr.split(" = "),setter=parts[0],value=parts[1];setter=parsePropertyChains(setter).replace(/^\(|\)$/g,""),value=parsePropertyChains(value),expr=setter+" = "+value}else expr=parsePropertyChains(expr);return expr=addReferences(expr),globals=null,expr};var parens={"(":")","[":"]"}},{}],69:[function(require,module,exports){var quoteRegex=/(['"\/])(\\\1|[^\1])*?\1/g,emptyQuoteExpr=/(['"\/])\1/g,strings=null;exports.pullOutStrings=function(expr){if(strings)throw new Error("putInStrings must be called after pullOutStrings.");return strings=[],expr.replace(quoteRegex,function(str,quote){return strings.push(str),quote+quote})},exports.putInStrings=function(expr){if(!strings)throw new Error("pullOutStrings must be called before putInStrings.");return expr=expr.replace(emptyQuoteExpr,function(){return strings.shift()}),strings=null,expr}},{}],70:[function(require,module,exports){function create(options){options=options||{};var observations=Observations.create();options.observations=observations;var fragments=new Fragments(options);return fragments.sync=observations.sync.bind(observations),fragments.syncNow=observations.syncNow.bind(observations),fragments.afterSync=observations.afterSync.bind(observations),fragments.onSync=observations.onSync.bind(observations),fragments.offSync=observations.offSync.bind(observations),fragments}var Fragments=require("./src/fragments"),Observations=require("observations-js");exports.create=create},{"./src/fragments":74,"observations-js":80}],71:[function(require,module,exports){function AnimatedBinding(properties){var element=properties.node,animate=element.getAttribute(properties.fragments.animateAttribute),fragments=properties.fragments;if(null!==animate){if("TEMPLATE"===element.nodeName||"SCRIPT"===element.nodeName)throw new Error("Cannot animate multiple nodes in a template or script. Remove the [animate] attribute.");if(setTimeout(function(){element.removeAttribute(properties.fragments.animateAttribute)}),this.animate=!0,fragments.isBound("attribute",animate))this.animateExpression=fragments.codifyExpression("attribute",animate);else if("."===animate[0])this.animateClassName=animate.slice(1);else if(animate){var animateObject=fragments.getAnimation(animate);"function"==typeof animateObject&&(animateObject=new animateObject(this)),this.animateObject=animateObject}}Binding.call(this,properties)}function getDuration(node,direction){var milliseconds=this.clonedFrom["__animationDuration"+direction];if(!milliseconds){var styles=window.getComputedStyle(node),seconds=Math.max(parseFloat(styles[transitionDurationName]||0)+parseFloat(styles[transitionDelayName]||0),parseFloat(styles[animationDurationName]||0)+parseFloat(styles[animationDelayName]||0));milliseconds=1e3*seconds||0,this.clonedFrom.__animationDuration__=milliseconds}return milliseconds}function onAnimationEnd(node,duration,callback){var onEnd=function(){node.removeEventListener(transitionEventName,onEnd),node.removeEventListener(animationEventName,onEnd),clearTimeout(timeout),callback()},timeout=setTimeout(onEnd,duration+10);node.addEventListener(transitionEventName,onEnd),node.addEventListener(animationEventName,onEnd)}module.exports=AnimatedBinding;var animation=require("./util/animation"),Binding=require("./binding"),_super=Binding.prototype;Binding.extend(AnimatedBinding,{init:function(){_super.init.call(this),this.animateExpression&&(this.animateObserver=new this.Observer(this.animateExpression,function(value){this.animateObject=value},this))},bind:function(context){this.context!=context&&(_super.bind.call(this,context),this.animateObserver&&this.animateObserver.bind(context))},unbind:function(){null!==this.context&&(_super.unbind.call(this),this.animateObserver&&this.animateObserver.unbind())},animateOut:function(node,callback){node.firstViewNode&&(node=node.firstViewNode),this.animateNode("out",node,function(){callback&&callback.call(this)})},animateIn:function(node,callback){node.firstViewNode&&(node=node.firstViewNode),this.animateNode("in",node,callback,this)},animateNode:function(direction,node,callback){var animateObject,className,classAnimateName,classWillName,methodAnimateName,methodWillName,methodDidName,dir,_this=this;this.animateObject&&"object"==typeof this.animateObject?(animateObject=this.animateObject,animateObject.fragments=this.fragments):this.animateClassName?className=this.animateClassName:"string"==typeof this.animateObject&&(className=this.animateObject),classAnimateName="animate-"+direction,classWillName="will-animate-"+direction,dir="in"===direction?"In":"Out",methodAnimateName="animate"+dir,methodWillName="willAnimate"+dir,methodDidName="didAnimate"+dir,className&&node.classList.add(className),node.classList.add(classWillName),animateObject&&(animation.makeElementAnimatable(node),animateObject[methodWillName]&&animateObject[methodWillName](node)),node.offsetWidth=node.offsetWidth,node.classList.add(classAnimateName),node.classList.remove(classWillName),node.dispatchEvent(new Event("animatestart"));var whenDone=function(){animateObject&&animateObject[methodDidName]&&animateObject[methodDidName](node),callback&&callback.call(_this),node.classList.remove(classAnimateName),className&&node.classList.remove(className),node.dispatchEvent(new Event("animateend"))};if(animateObject&&animateObject[methodAnimateName])animateObject[methodAnimateName](node,whenDone);else{var duration=getDuration.call(this,node,direction);duration?onAnimationEnd(node,duration,whenDone):whenDone()}}});var transitionDurationName="transitionDuration",transitionDelayName="transitionDelay",animationDurationName="animationDuration",animationDelayName="animationDelay",transitionEventName="transitionend",animationEventName="animationend",style=document.documentElement.style;["webkit","moz","ms","o"].forEach(function(prefix){void 0===style.transitionDuration&&style[prefix+"TransitionDuration"]&&(transitionDurationName=prefix+"TransitionDuration",transitionDelayName=prefix+"TransitionDelay",transitionEventName=prefix+"transitionend"),void 0===style.animationDuration&&style[prefix+"AnimationDuration"]&&(animationDurationName=prefix+"AnimationDuration",animationDelayName=prefix+"AnimationDelay",animationEventName=prefix+"animationend")})},{"./binding":72,"./util/animation":76}],72:[function(require,module,exports){function Binding(properties){if(!properties.node||!properties.view)throw new TypeError("A binding must receive a node and a view");this._elementPath=initNodePath(properties.node,properties.view),this.node=properties.node,this.element=properties.node,this.name=properties.name,this.match=properties.match,this.expression=properties.expression,this.fragments=properties.fragments,this.context=null}function initNodePath(node,view){for(var path=[];node!==view;){var parent=node.parentNode;path.unshift(indexOf.call(parent.childNodes,node)),node=parent}return path}module.exports=Binding;var Class=require("chip-utils/class");Class.extend(Binding,{priority:0,init:function(){this.expression&&(this.observer=this.observe(this.expression,this.updated)),this.created()},cloneForView:function(view){if(!view)throw new TypeError("A binding must clone against a view");var node=view;this._elementPath.forEach(function(index){node=node.childNodes[index]});var binding=Object.create(this);return binding.clonedFrom=this,binding.view=view,binding.element=node,binding.node=node,binding.init(),binding},bind:function(context){this.context!=context&&(this.context=context,this.observer&&(this.observer.context=context),this.bound(),this.observer&&this.updated!==Binding.prototype.updated&&this.observer.bind(context))},unbind:function(){null!==this.context&&(this.observer&&this.observer.unbind(),this.unbound(),this.context=null)},dispose:function(){this.unbind(),this.observer&&this.observer.sync()},sync:function(){this.context&&this.observer&&this.updated!==Binding.prototype.updated&&this.observer.sync()},compiled:function(){},created:function(){},updated:function(){},bound:function(){},unbound:function(){},attached:function(){},detached:function(){},get camelCase(){return(this.match||this.name||"").replace(/-+(\w)/g,function(_,char){return char.toUpperCase()})},observe:function(expression,callback,callbackContext){return this.observations.createObserver(expression,callback,callbackContext||this)}});var indexOf=Array.prototype.indexOf},{"chip-utils/class":55}],73:[function(require,module,exports){function compile(fragments,template){var currentNode,parentNode,previousNode,walker=document.createTreeWalker(template,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT),bindings=[];walker.nextNode(),walker.previousNode();do currentNode=walker.currentNode,parentNode=currentNode.parentNode,bindings.push.apply(bindings,getBindingsForNode(fragments,currentNode,template)),currentNode.parentNode!==parentNode?walker.currentNode=previousNode||walker.root:previousNode=currentNode;while(walker.nextNode());return bindings}function getBindingsForNode(fragments,node,view){var Binder,binding,expr,bound,match,attr,i,l,bindings=[];if(node.nodeType===Node.TEXT_NODE)splitTextNode(fragments,node),fragments.isBound("text",node.nodeValue)&&(expr=fragments.codifyExpression("text",node.nodeValue),node.nodeValue="",Binder=fragments.findBinder("text",expr),binding=new Binder({node:node,view:view,expression:expr,fragments:fragments}),binding.compiled()!==!1&&bindings.push(binding));else{var parent=node.parentNode,DefaultBinder=fragments.getAttributeBinder("__default__");bound=[],Binder=fragments.findBinder("element",node.tagName.toLowerCase()),Binder&&bound.push([Binder]);var attributes=slice.call(node.attributes);for(i=0,l=attributes.length;l>i;i++)attr=attributes[i],Binder=fragments.findBinder("attribute",attr.name,attr.value),Binder&&bound.push([Binder,attr]);for(bound.sort(sortBindings),i=0;i<bound.length;i++){if(Binder=bound[i][0],attr=bound[i][1]){if(!node.hasAttribute(attr.name))continue;var name=attr.name,value=attr.value;Binder.expr?(match=name.match(Binder.expr),match&&(match=match[1])):match=null,attr&&node.hasAttribute(attr.name)&&node.removeAttribute(attr.name),binding=new Binder({node:node,view:view,name:name,match:match,expression:value?fragments.codifyExpression("attribute",value,Binder!==DefaultBinder):null,fragments:fragments})}else binding=new Binder({node:node,view:view,fragments:fragments});if(binding.compiled()!==!1?bindings.push(binding):attr&&Binder!==DefaultBinder&&fragments.isBound("attribute",value)?bound.push([DefaultBinder,attr]):attr&&node.setAttributeNode(attr),node.parentNode!==parent)break}}return bindings}function splitTextNode(fragments,node){if(!node.processed){node.processed=!0;var regex=fragments.binders.text._expr,content=node.nodeValue;if(content.match(regex)){for(var match,lastIndex=0,parts=[],fragment=document.createDocumentFragment();match=regex.exec(content);)parts.push(content.slice(lastIndex,regex.lastIndex-match[0].length)),parts.push(match[0]),lastIndex=regex.lastIndex;parts.push(content.slice(lastIndex)),parts=parts.filter(notEmpty),node.nodeValue=parts[0];for(var i=1;i<parts.length;i++){var newTextNode=document.createTextNode(parts[i]);newTextNode.processed=!0,fragment.appendChild(newTextNode)}node.parentNode.insertBefore(fragment,node.nextSibling)}}}function sortBindings(a,b){return b[0].prototype.priority-a[0].prototype.priority}function notEmpty(value){return Boolean(value)}var slice=Array.prototype.slice;module.exports=compile},{}],74:[function(require,module,exports){function Fragments(options){if(!options||!options.observations)throw new TypeError("Must provide an observations instance to Fragments in options.");this.compiling=!1,this.observations=options.observations,this.globals=options.observations.globals,this.formatters=options.observations.formatters,this.animations={},this.animateAttribute="animate",this.binders={element:{_wildcards:[]},attribute:{_wildcards:[],_expr:/{{\s*(.*?)\s*}}/g,_delimitersOnlyInDefault:!1},text:{_wildcards:[],_expr:/{{\s*(.*?)\s*}}/g}},this.registerText("__default__",function(value){this.element.textContent=null!=value?value:""}),this.registerAttribute("__default__",function(value){null!=value?this.element.setAttribute(this.name,value):this.element.removeAttribute(this.name)}),this.addOptions(options)}function escapeRegExp(text){return text.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function processOption(obj,fragments,methodName){obj&&Object.keys(obj).forEach(function(name){fragments[methodName](name,obj[name])})}module.exports=Fragments,require("./util/polyfills");var Class=require("chip-utils/class"),toFragment=require("./util/toFragment"),animation=require("./util/animation"),Template=require("./template"),View=require("./view"),Binding=require("./binding"),AnimatedBinding=require("./animatedBinding"),compile=require("./compile"),hasWildcardExpr=/(^|[^\\])\*/,escapedWildcardExpr=/(^|[^\\])\\\*/;Class.extend(Fragments,{addOptions:function(options){options&&(processOption(options.binders,this,"registerAttribute"),processOption(options.formatters,this,"registerFormatter"),processOption(options.animations,this,"registerAnimation"))},createTemplate:function(html){if(!html)throw new TypeError("Invalid html, cannot create a template from: "+html);var fragment=toFragment(html);if(0===fragment.childNodes.length)throw new Error("Cannot create a template from "+html+" because it is empty.");var template=Template.makeInstanceOf(fragment);return this.compileTemplate(template),template},compileTemplate:function(template){if(template&&!template.compiled){var lastCompilingValue=this.compiling;this.compiling=!0,template.compiled=!0,template.bindings=compile(this,template),this.compiling=lastCompilingValue}return template},compileElement:function(element){return element.bindings||(element.bindings=compile(this,element),View.makeInstanceOf(element)),element},bindElement:function(element,context){return this.compileElement(element),context&&element.bind(context),element},observe:function(context,expr,callback,callbackContext){"string"==typeof context&&(callbackContext=callback,callback=expr,expr=context,context=null);var observer=this.observations.createObserver(expr,callback,callbackContext);return context&&observer.bind(context,!0),observer},registerElement:function(name,definition){return this.registerBinder("element",name,definition)},registerAttribute:function(name,definition){return this.registerBinder("attribute",name,definition)},registerText:function(name,definition){return this.registerBinder("text",name,definition)},registerBinder:function(type,name,definition){function Binder(){superClass.apply(this,arguments)}if(!definition)throw new TypeError("Must provide a definition when registering a binder");var binders=this.binders[type],superClass=definition.animated?AnimatedBinding:Binding;if(!binders)throw new TypeError("`type` must be one of "+Object.keys(this.binders).join(", "));"function"==typeof definition&&(definition.prototype instanceof Binding?(superClass=definition,definition={}):definition={updated:definition}),"__default__"!==name||definition.hasOwnProperty("priority")||(definition.priority=-100),definition.observations=this.observations,superClass.extend(Binder,definition);var expr;return name instanceof RegExp?expr=name:hasWildcardExpr.test(name)&&(expr=new RegExp("^"+escapeRegExp(name).replace(escapedWildcardExpr,"$1(.*)")+"$")),expr&&(Binder.expr=expr,binders._wildcards.push(Binder),binders._wildcards.sort(this.bindingSort)),Binder.name=""+name,binders[name]=Binder,Binder},unregisterElement:function(name){return this.unregisterBinder("element",name)},unregisterAttribute:function(name){return this.unregisterBinder("attribute",name)},unregisterText:function(name){return this.unregisterBinder("text",name)},unregisterBinder:function(type,name){var binder=this.getBinder(type,name),binders=this.binders[type];if(binder){if(binder.expr){var index=binders._wildcards.indexOf(binder);index>=0&&binders._wildcards.splice(index,1)}return delete binders[name],binder}},getElementBinder:function(name){return this.getBinder("element",name)},getAttributeBinder:function(name){return this.getBinder("attribute",name)},getTextBinder:function(name){return this.getBinder("text",name)},getBinder:function(type,name){var binders=this.binders[type];if(!binders)throw new TypeError("`type` must be one of "+Object.keys(this.binders).join(", "));return name&&binders.hasOwnProperty(name)?binders[name]:void 0},findBinder:function(type,name,value){if("text"===type&&null==value&&(value=name,name=void 0),name!==this.animateAttribute){var binder=this.getBinder(type,name),binders=this.binders[type];if(!binder){var toMatch="text"===type?value:name;binders._wildcards.some(function(wildcardBinder){return toMatch.match(wildcardBinder.expr)?(binder=wildcardBinder,!0):void 0})}if(!binder||"attribute"!==type||!binder.prototype.onlyWhenBound||this.binders[type]._delimitersOnlyInDefault||this.isBound(type,value))return binder||!value||"text"!==type&&!this.isBound(type,value)||(binder=this.getBinder(type,"__default__")),binder}},registerFormatter:function(name,formatter){this.formatters[name]=formatter},unregisterFormatter:function(name){delete this.formatters[name]},getFormatter:function(name){return this.formatters[name]},registerAnimation:function(name,animationObject){this.animations[name]=animationObject},unregisterAnimation:function(name){delete this.animations[name]},getAnimation:function(name){return this.animations[name]},makeElementAnimatable:animation.makeElementAnimatable,setExpressionDelimiters:function(type,pre,post,onlyInDefault){if("attribute"!==type&&"text"!==type)throw new TypeError('Expression delimiters must be of type "attribute" or "text"');this.binders[type]._expr=new RegExp(escapeRegExp(pre)+"(.*?)"+escapeRegExp(post),"g"),"attribute"===type&&(this.binders[type]._delimitersOnlyInDefault=!!onlyInDefault)},isBound:function(type,value){if("attribute"!==type&&"text"!==type)throw new TypeError('isBound must provide type "attribute" or "text"');var expr=this.binders[type]._expr;return Boolean(expr&&value&&value.match(expr))},bindingSort:function(a,b){return b.prototype.priority-a.prototype.priority},codifyExpression:function(type,text,notDefault){if("attribute"!==type&&"text"!==type)throw new TypeError('codifyExpression must use type "attribute" or "text"');if(notDefault&&this.binders[type]._delimitersOnlyInDefault)return text;var expr=this.binders[type]._expr,match=text.match(expr);if(match){if(1===match.length&&match[0]===text)return text.replace(expr,"$1");for(var newText='"',lastIndex=0;match=expr.exec(text);){var str=text.slice(lastIndex,expr.lastIndex-match[0].length);newText+=str.replace(/"/g,'\\"'),newText+='" + ('+match[1]+' || "") + "',lastIndex=expr.lastIndex}return newText+=text.slice(lastIndex).replace(/"/g,'\\"')+'"',newText.replace(/^"" \+ | "" \+ | \+ ""$/g,"")}return'"'+text.replace(/"/g,'\\"')+'"'}})},{"./animatedBinding":71,"./binding":72,"./compile":73,"./template":75,"./util/animation":76,"./util/polyfills":77,"./util/toFragment":78,"./view":79,"chip-utils/class":55}],75:[function(require,module,exports){function Template(){this.compiled=!1,this.pool=[]}module.exports=Template;var View=require("./view"),Class=require("chip-utils/class");Class.extend(Template,{createView:function(){return this.pool.length?this.pool.pop():View.makeInstanceOf(document.importNode(this,!0),this)},returnView:function(view){-1===this.pool.indexOf(view)&&this.pool.push(view)}})},{"./view":79,"chip-utils/class":55}],76:[function(require,module,exports){function makeElementAnimatable(element){return element.animate||(element.animate=animateElement),element.getComputedCSS||(element.getComputedCSS=getComputedCSS),element}function getComputedCSS(styleName){return this.ownerDocument.defaultView.opener?this.ownerDocument.defaultView.getComputedStyle(this)[styleName]:window.getComputedStyle(this)[styleName]}function animateElement(css,options){if(!Array.isArray(css)||2!==css.length)throw new TypeError("animate polyfill requires an array for css with an initial and final state");if(!options||!options.hasOwnProperty("duration"))throw new TypeError("animate polyfill requires options with a duration");var element=this,duration=options.duration||0,delay=options.delay||0,easing=options.easing,initialCss=css[0],finalCss=css[1],allCss={},playback={onfinish:null};Object.keys(initialCss).forEach(function(key){allCss[key]=!0,element.style[key]=initialCss[key]}),element.offsetWidth;var transitionOptions=" "+duration+"ms";return easing&&(transitionOptions+=" "+easing),delay&&(transitionOptions+=" "+delay+"ms"),element.style.transition=Object.keys(finalCss).map(function(key){return key+transitionOptions}).join(", "),Object.keys(finalCss).forEach(function(key){allCss[key]=!0,element.style[key]=finalCss[key]}),setTimeout(function(){Object.keys(allCss).forEach(function(key){element.style[key]=""}),playback.onfinish&&playback.onfinish()},duration+delay),playback}exports.makeElementAnimatable=makeElementAnimatable,exports.getComputedCSS=getComputedCSS,exports.animateElement=animateElement},{}],77:[function(require,module,exports){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(selector){var element=this;do if(element.matches(selector))return element;while((element=element.parentNode)&&element.nodeType===Node.ELEMENT_NODE);return null})},{}],78:[function(require,module,exports){function toFragment(html){if("function"==typeof html&&(html=html()),html instanceof DocumentFragment)return html;if("string"==typeof html)return stringToFragment(html);if(html instanceof Node)return nodeToFragment(html);if("length"in html)return listToFragment(html);throw new TypeError("Unsupported Template Type: Cannot convert `"+html+"` into a document fragment.")}function nodeToFragment(node){if(node.content instanceof DocumentFragment)return node.content;if("SCRIPT"===node.tagName)return stringToFragment(node.innerHTML);var fragment=document.createDocumentFragment();if("TEMPLATE"===node.tagName)for(var i=0,l=node.childNodes.length;l>i;i++)fragment.appendChild(node.childNodes[i]);else fragment.appendChild(node);return fragment}function listToFragment(list){for(var fragment=document.createDocumentFragment(),i=0,l=list.length;l>i;i++)fragment.appendChild(toFragment(list[i])),l===list.length+1&&(i--,l--);return fragment}module.exports=toFragment;var stringToFragment=function(string){if(!string){var fragment=document.createDocumentFragment();return fragment.appendChild(document.createTextNode("")),fragment}var templateElement;return templateElement=document.createElement("template"),templateElement.innerHTML=string,templateElement.content};!document.createElement("template").content instanceof DocumentFragment&&(stringToFragment=function(){var tagExp=/<([\w:-]+)/,wrapMap={option:[1,'<select multiple="multiple">',"</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};return wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,function(string){var fragment;if(!string)return fragment=document.createDocumentFragment(),fragment.appendChild(document.createTextNode("")),fragment;var tag=string.match(tagExp),parts=wrapMap[tag]||wrapMap._default,depth=parts[0],prefix=parts[1],postfix=parts[2],div=document.createElement("div");for(div.innerHTML=prefix+string+postfix;depth--;)div=div.lastChild;for(fragment=document.createDocumentFragment();div.firstChild;)fragment.appendChild(div.firstChild);return fragment}}())},{}],79:[function(require,module,exports){function View(template){this.context=null,template?(this.template=template,this.bindings=this.template.bindings.map(function(binding){return binding.cloneForView(this)},this)):this.bindings&&this.bindings.forEach(function(binding){binding.init()}),this.firstViewNode=this.firstChild,this.lastViewNode=this.lastChild,this.firstViewNode&&(this.firstViewNode.view=this,this.lastViewNode.view=this)}module.exports=View;var Class=require("chip-utils/class");Class.extend(View,{get inDOM(){return document.documentElement.contains(this.firstViewNode)},remove:function(){var next,node=this.firstViewNode;if(node.parentNode!==this)for(;node;)next=node===this.lastViewNode?null:node.nextSibling,this.appendChild(node),node=next;this.detached()},dispose:function(){this.bindings.forEach(function(binding){binding.dispose()}),this.context=null,this.remove(),this.template&&this.template.returnView(this)},bind:function(context){this.context=context,this.bindings.forEach(function(binding){binding.bind(context)})},unbind:function(){this.bindings.forEach(function(binding){binding.unbind()}),this.context=null},attached:function(){!this._attached&&this.inDOM&&(this._attached=!0,this.bindings.forEach(function(binding){binding.attached()}))},detached:function(){this._attached&&!this.inDOM&&(this._attached=!1,this.bindings.forEach(function(binding){binding.detached()}))},sync:function(){null!==this.context&&this.bindings.forEach(function(binding){binding.sync()})}})},{"chip-utils/class":55}],80:[function(require,module,exports){exports.Observations=require("./src/observations"),exports.Observer=require("./src/observer"),exports.create=function(){return new exports.Observations}},{"./src/observations":82,"./src/observer":83}],81:[function(require,module,exports){arguments[4][55][0].apply(exports,arguments)},{dup:55}],82:[function(require,module,exports){(function(global){function Observations(){this.globals={},this.formatters={},this.observers=[],this.callbacks=[],this.listeners=[],this.syncing=!1,this.callbacksRunning=!1,this.rerun=!1,this.cycles=0,this.maxCycles=10,this.timeout=null,this.pendingSync=null,this.syncNow=this.syncNow.bind(this)}module.exports=Observations;var Class=require("chip-utils/class"),Observer=require("./observer"),requestAnimationFrame=global.requestAnimationFrame||setTimeout,cancelAnimationFrame=global.cancelAnimationFrame||clearTimeout;Class.extend(Observations,{createObserver:function(expr,callback,callbackContext){return new Observer(this,expr,callback,callbackContext)},sync:function(callback){return"function"==typeof callback&&this.afterSync(callback),this.pendingSync?!1:(this.pendingSync=requestAnimationFrame(this.syncNow),!0)},syncNow:function(callback){return"function"==typeof callback&&this.afterSync(callback),cancelAnimationFrame(this.pendingSync),this.pendingSync=null,this.syncing?(this.rerun=!0,!1):(this.runSync(),!0)},runSync:function(){this.syncing=!0,this.rerun=!0,this.cycles=0;for(var i,l;this.rerun;){if(++this.cycles===this.maxCycles)throw new Error("Infinite observer syncing, an observer is calling Observer.sync() too many times");for(this.rerun=!1,i=0;i<this.observers.length;i++)this.observers[i].sync()}this.callbacksRunning=!0;var callbacks=this.callbacks;for(this.callbacks=[];callbacks.length;)callbacks.shift()();for(i=0,l=this.listeners.length;l>i;i++){var listener=this.listeners[i];listener()}this.callbacksRunning=!1,this.syncing=!1,this.cycles=0},afterSync:function(callback){if("function"!=typeof callback)throw new TypeError("callback must be a function");this.callbacksRunning&&this.sync(),this.callbacks.push(callback)},onSync:function(listener){if("function"!=typeof listener)throw new TypeError("listener must be a function");this.listeners.push(listener)},offSync:function(listener){if("function"!=typeof listener)throw new TypeError("listener must be a function");var index=this.listeners.indexOf(listener);-1!==index&&this.listeners.splice(index,1).pop()},add:function(observer,skipUpdate){this.observers.push(observer),skipUpdate||(observer.forceUpdateNextSync=!0,observer.sync())},remove:function(observer){var index=this.observers.indexOf(observer);return-1!==index?(this.observers.splice(index,1),!0):!1}})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./observer":83,"chip-utils/class":81}],83:[function(require,module,exports){function Observer(observations,expr,callback,callbackContext){"function"==typeof expr?(this.getter=expr,this.setter=expr):this.getter=expressions.parse(expr,observations.globals,observations.formatters),this.observations=observations,this.expr=expr,this.callback=callback,this.callbackContext=callbackContext,this.skip=!1,this.forceUpdateNextSync=!1,this.context=null,this.oldValue=void 0}module.exports=Observer;var Class=require("chip-utils/class"),expressions=require("expressions-js"),diff=require("differences-js");Class.extend(Observer,{bind:function(context,skipUpdate){this.context=context,this.callback&&this.observations.add(this,skipUpdate)},unbind:function(){this.observations.remove(this),this.context=null},close:function(){this.unbind(),this.callback=null,this.callbackContext=null},get:function(){return this.context?this.getter.call(this.context):void 0},set:function(value){if(this.context&&this.setter!==!1){if(!this.setter){try{this.setter="string"==typeof this.expr?expressions.parseSetter(this.expr,this.observations.globals,this.observations.formatters):!1}catch(e){this.setter=!1}if(!this.setter)return}try{var result=this.setter.call(this.context,value)}catch(e){return}return this.sync(),this.observations.sync(),result}},skipNextSync:function(){this.skip=!0},sync:function(){var value=this.get();if(this.skip||!this.callback)this.skip=!1;else{var changed=diff.values(value,this.oldValue);if(!changed&&!this.forceUpdateNextSync)return;this.forceUpdateNextSync=!1,Array.isArray(changed)?this.callback.call(this.callbackContext,value,this.oldValue,changed):this.callback.call(this.callbackContext,value,this.oldValue)}this.getChangeRecords?this.oldValue=diff.clone(value):this.oldValue=value}})},{"chip-utils/class":81,"differences-js":63,"expressions-js":65}],84:[function(require,module,exports){exports.Router=require("./src/router"),exports.Route=require("./src/route"),exports.Location=require("./src/location"),
exports.HashLocation=require("./src/hash-location"),exports.PushLocation=require("./src/push-location"),exports.create=function(options){return new exports.Router(options)}},{"./src/hash-location":87,"./src/location":88,"./src/push-location":89,"./src/route":90,"./src/router":91}],85:[function(require,module,exports){function Class(){}function extend(Subclass){var prototypes;if("function"!=typeof Subclass){prototypes=slice.call(arguments);var SuperClass=this;Subclass=function(){SuperClass.apply(this,arguments)}}else prototypes=slice.call(arguments,1);extendStatics(this,Subclass),prototypes.forEach(function(proto){"function"==typeof proto?extendStatics(proto,Subclass):proto.hasOwnProperty("static")&&extendStatics(proto["static"],Subclass)});var descriptors=getDescriptors(prototypes);return descriptors.constructor={writable:!0,configurable:!0,value:Subclass},Subclass.prototype=Object.create(this.prototype,descriptors),Subclass}function getDescriptors(objects){var descriptors={};return objects.forEach(function(object){"function"==typeof object&&(object=object.prototype),Object.getOwnPropertyNames(object).forEach(function(name){if("static"!==name){var descriptor=Object.getOwnPropertyDescriptor(object,name);"function"==typeof descriptor.value&&(descriptor.enumerable=!1),descriptors[name]=descriptor}})}),descriptors}function extendStatics(Class,Subclass){Object.keys(Class).forEach(function(key){var descriptor=Object.getOwnPropertyDescriptor(Class,key);descriptor.configurable&&Object.defineProperty(Subclass,key,descriptor)})}function makeInstanceOf(object){var args=slice.call(arguments,1);return Object.defineProperties(object,getDescriptors([this.prototype])),this.apply(object,args),object}var slice=Array.prototype.slice;Class.extend=extend,Class.makeInstanceOf=makeInstanceOf,module.exports=Class},{}],86:[function(require,module,exports){arguments[4][56][0].apply(exports,arguments)},{"./class":85,dup:56}],87:[function(require,module,exports){function HashLocation(){Location.call(this)}module.exports=HashLocation;var Location=require("./location");Location.extend(HashLocation,{historyEventName:"hashchange",get url(){return location.hash.replace(/^#\/?/,"/")||"/"},set url(value){("."===value.charAt(0)||value.split("//").length>1)&&(value=this.getRelativeUrl(value)),location.hash="/"===value?"":"#"+value}})},{"./location":88}],88:[function(require,module,exports){function Location(){EventTarget.call(this),this._handleChange=this._handleChange.bind(this),this.baseURI=baseURI.replace(/\/$/,""),this.currentUrl=this.url,window.addEventListener(this.historyEventName,this._handleChange)}function parseQuery(search){var query={};return search.replace(/^\?/,"").split("&").filter(Boolean).forEach(function(keyValue){var parts=keyValue.split("="),key=parts[0],value=parts[1];query[decodeURIComponent(key)]=decodeURIComponent(value)}),query}module.exports=Location;var PushLocation,pushLocation,HashLocation,hashLocation,EventTarget=require("chip-utils/event-target"),doc=document.implementation.createHTMLDocument(""),base=doc.createElement("base"),anchor=doc.createElement("a"),bases=document.getElementsByTagName("base"),baseURI=bases[0]?bases[0].href:location.protocol+"//"+location.host+"/";doc.body.appendChild(base),doc.body.appendChild(anchor),EventTarget.extend(Location,{"static":{create:function(options){return"hash"!==options.use&&PushLocation.supported?pushLocation||(pushLocation=new PushLocation):hashLocation||(hashLocation=new HashLocation)},get supported(){return!0}},historyEventName:"",base:base,anchor:anchor,getRelativeUrl:function(url){return base.href=this.baseURI+this.currentUrl,anchor.href=url,url=anchor.pathname+anchor.search,"/"===url[0]?url:"/"+url},getPath:function(url){base.href=this.baseURI+this.currentUrl,anchor.href=url;var path=anchor.pathname;return"/"===path[0]?path:"/"+path},get url(){throw new Error("Abstract method. Override")},set url(value){throw new Error("Abstract method. Override")},get path(){return this.currentUrl.split("?").shift()},get query(){return parseQuery(this.currentUrl.split("?").slice(1).join("?"))},_changeTo:function(url){this.currentUrl=url,this.dispatchEvent(new CustomEvent("change",{detail:{url:url,path:this.path,query:this.query}}))},_handleChange:function(){var url=this.url;this.currentUrl!==url&&this._changeTo(url)}}),PushLocation=require("./push-location"),HashLocation=require("./hash-location")},{"./hash-location":87,"./push-location":89,"chip-utils/event-target":86}],89:[function(require,module,exports){function PushLocation(){Location.call(this)}module.exports=PushLocation;var Location=require("./location");document.createElement("a");Location.extend(PushLocation,{"static":{get supported(){return window.history&&window.history.pushState&&!0}},historyEventName:"popstate",get url(){return location.href.replace(this.baseURI,"").split("#").shift()},set url(value){("."===value.charAt(0)||value.split("//").length>1)&&(value=this.getRelativeUrl(value)),this.currentUrl!==value&&(history.pushState({},"",value),this._changeTo(value))}})},{"./location":88}],90:[function(require,module,exports){function Route(path,callback){this.path=path,this.callback=callback,this.keys=[],this.expr=parsePath(path,this.keys),this.handle=this.handle.bind(this)}function parsePath(path,keys){return path instanceof RegExp?path:(Array.isArray(path)&&(path="("+path.join("|")+")"),path=path.concat("/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?(\*)?/g,function(_,slash,format,key,capture,optional,star){keys.push(key),slash=slash||"";var expr="";return optional||(expr+=slash),expr+="(?:",optional&&(expr+=slash),expr+=format||"",expr+=capture||(format&&"([^/.]+?)"||"([^/]+?)")+")",expr+=optional||"",star&&(expr+="(/*)?"),expr}).replace(/([\/.])/g,"\\$1").replace(/\(\\\/\*\)/g,"(/.*)").replace(/\*(?!\))/g,"(.*)"),new RegExp("^"+path+"$","i"))}module.exports=Route;var Class=require("chip-utils/class");Class.extend(Route,{match:function(path){return this.expr.test(path)?(this.params=this.getParams(path),!0):!1},getParams:function(path){var params={},match=this.expr.exec(path);if(!match)return params;for(var i=1;i<match.length;i++){var key=this.keys[i-1]||"*",value=match[i];params[key]=decodeURIComponent(value||"")}return params},handle:function(req,done){req.params=this.params||this.getParams(req.path),this.callback(req,done)}})},{"chip-utils/class":85}],91:[function(require,module,exports){function Router(options){EventTarget.call(this),this.options=options||{},this.routes=[],this.params={},this.paramsExp={},this.routes.byPath={},this.location=Location.create(this.options),this.onUrlChange=this.onUrlChange.bind(this)}module.exports=Router;var Route=require("./route"),EventTarget=require("chip-utils/event-target"),Location=require("./location");EventTarget.extend(Router,{param:function(name,callback){if("function"==typeof callback)(this.params[name]||(this.params[name]=[])).push(callback);else{if(!(callback instanceof RegExp))throw new TypeError('param must have a callback of type "function" or RegExp. Got '+callback+".");this.paramsExp[name]=callback}},route:function(path,callback){if("function"!=typeof callback)throw new TypeError('route must have a callback of type "function". Got '+callback+".");"string"==typeof path&&"/"!==path[0]&&(path="/"+path),this.routes.push(new Route(path,callback))},removeRoute:function(path,callback){return this.routes.some(function(route,index){return route.path===path&&route.callback===callback?(this.routes.splice(index,1),!0):void 0})},redirect:function(url){function errHandler(event){notFound="notFound"===event.detail}var notFound=!1;return this.on("error",errHandler),this.location.url=url,this.off("error",errHandler),!notFound},listen:function(){this.location.on("change",this.onUrlChange)},stop:function(){this.location.off("change",this.onUrlChange)},getRoutesMatchingPath:function(url){if(null==url)return[];var path=this.location.getPath(url),paramsExp=this.paramsExp;return this.routes.filter(function(route){if(!route.match(path))return!1;var params=route.getParams(path);return route.keys.every(function(key){var value=params[key];return!paramsExp.hasOwnProperty(key)||value&&paramsExp[key].test(value)})})},onUrlChange:function(event){var req=event.detail,path=req.path,event=new CustomEvent("changing",{detail:req,cancelable:!0});if(this.dispatchEvent(event),!event.defaultPrevented){this.dispatchEvent(new CustomEvent("change",{detail:req}));var routes=this.getRoutesMatchingPath(path),callbacks=[],handledParams={},router=this;routes.forEach(function(route){route.keys.forEach(function(key){if(router.params.hasOwnProperty(key)&&!handledParams.hasOwnProperty(key)){handledParams[key]=!0;var value=route.params[key];router.params[key].forEach(function(paramCallback){callbacks.push(function(req,next){paramCallback(req,next,value)})})}}),callbacks.push(route.handle)},this);var next=function(err){return err?void router.dispatchEvent(new CustomEvent("error",{detail:err})):callbacks.length?(callback=callbacks.shift(),void callback(req,next)):next("notFound")};next()}}})},{"./location":88,"./route":90,"chip-utils/event-target":86}]},{},[57])(57)});