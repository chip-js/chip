/*! chip 2013-10-10 */
!function(a){"use strict";function b(){function a(a){"splice"===a[0].type&&"splice"===a[1].type&&(b=!0)}if("function"!=typeof Object.observe||"function"!=typeof Array.observe)return!1;var b=!1,c=[0];return Array.observe(c,a),c[1]=1,c.length=0,Object.deliverChangeRecords(a),b}function c(){if(a.document&&"securityPolicy"in a.document&&!a.document.securityPolicy.allowsEval)return!1;try{var b=new Function("","return true;");return b()}catch(c){return!1}}function d(a){return+a===a>>>0}function e(a){return+a}function f(a){return a===Object(a)}function g(a,b){return a===b?0!==a||1/a===1/b:H(a)&&H(b)?!0:a!==a&&b!==b}function h(a){return"string"!=typeof a?!1:(a=a.trim(),""==a?!0:"."==a[0]?!1:P.test(a))}function i(a,b){if(b!==Q)throw Error("Use Path.get to retrieve path objects");return""==a.trim()?this:d(a)?(this.push(a),this):(a.split(/\s*\.\s*/).filter(function(a){return a}).forEach(function(a){this.push(a)},this),G&&!F&&this.length&&(this.getValueFrom=this.compiledGetValueFromFn()),void 0)}function j(a){if(a instanceof i)return a;null==a&&(a=""),"string"!=typeof a&&(a=String(a));var b=R[a];if(b)return b;if(!h(a))return S;var b=new i(a,Q);return R[a]=b,b}function k(b){for(var c=0;T>c&&b.check();)b.report(),c++;a.testingExposeCycleCount&&(a.dirtyCheckCycleCount=c)}function l(a){for(var b in a)return!1;return!0}function m(a){return l(a.added)&&l(a.removed)&&l(a.changed)}function n(a,b){var c={},d={},e={};for(var f in b){var g=a[f];(void 0===g||g!==b[f])&&(f in a?g!==b[f]&&(e[f]=g):d[f]=void 0)}for(var f in a)f in b||(c[f]=a[f]);return Array.isArray(a)&&a.length!==b.length&&(e.length=a.length),{added:c,removed:d,changed:e}}function o(a,b){var c=b||(Array.isArray(a)?[]:{});for(var d in a)c[d]=a[d];return Array.isArray(a)&&(c.length=a.length),c}function p(a,b,c,d){if(this.closed=!1,this.object=a,this.callback=b,this.target=c,this.token=d,this.reporting=!0,F){var e=this;this.boundInternalCallback=function(a){e.internalCallback(a)}}q(this)}function q(a){V&&(U.push(a),p._allObserversCount++)}function r(a,b,c,d){p.call(this,a,b,c,d),this.connect(),this.sync(!0)}function s(a,b,c,d){if(!Array.isArray(a))throw Error("Provided object is not an Array");r.call(this,a,b,c,d)}function t(a){this.arr=[],this.callback=a,this.isObserved=!0}function u(a,b,c,d,e,g,h){var b=b instanceof i?b:j(b);return b&&b.length&&f(a)?(p.call(this,a,c,d,e),this.valueFn=g,this.setValueFn=h,this.path=b,this.connect(),this.sync(!0),void 0):(this.value_=b?b.getValueFrom(a):void 0,this.value=g?g(this.value_):this.value_,this.closed=!0,void 0)}function v(a,b,c,d){p.call(this,void 0,a,b,c),this.valueFn=d,this.observed=[],this.values=[],this.value=void 0,this.oldValue=void 0,this.oldValues=void 0,this.changeFlags=void 0,this.started=!1}function w(a,b){if("function"==typeof Object.observe){var c=Object.getNotifier(a);return function(d,e){var f={object:a,type:d,name:b};2===arguments.length&&(f.oldValue=e),c.notify(f)}}}function x(a,b,c){for(var d={},e={},f=0;f<b.length;f++){var g=b[f];$[g.type]?(g.name in c||(c[g.name]=g.oldValue),"updated"!=g.type&&("new"!=g.type?g.name in d?(delete d[g.name],delete c[g.name]):e[g.name]=!0:g.name in e?delete e[g.name]:d[g.name]=!0)):(console.error("Unknown changeRecord type: "+g.type),console.error(g))}for(var h in d)d[h]=a[h];for(var h in e)e[h]=void 0;var i={};for(var h in c)if(!(h in d||h in e)){var j=a[h];c[h]!==j&&(i[h]=j)}return{added:d,removed:e,changed:i}}function y(a,b,c){return{index:a,removed:b,addedCount:c}}function z(){}function A(a,b,c,d,e,f){return db.calcSplices(a,b,c,d,e,f)}function B(a,b,c,d){return c>b||a>d?-1:b==c||d==a?0:c>a?d>b?b-c:d-c:b>d?d-a:b-a}function C(a,b,c,d){for(var e=y(b,c,d),f=!1,g=0,h=0;h<a.length;h++){var i=a[h];if(i.index+=g,!f){var j=B(e.index,e.index+e.removed.length,i.index,i.index+i.addedCount);if(j>=0){a.splice(h,1),h--,g-=i.addedCount-i.removed.length,e.addedCount+=i.addedCount-j;var k=e.removed.length+i.removed.length-j;if(e.addedCount||k){var c=i.removed;if(e.index<i.index){var l=e.removed.slice(0,i.index-e.index);Array.prototype.push.apply(l,c),c=l}if(e.index+e.removed.length>i.index+i.addedCount){var m=e.removed.slice(i.index+i.addedCount-e.index);Array.prototype.push.apply(c,m)}e.removed=c,i.index<e.index&&(e.index=i.index)}else f=!0}else if(e.index<i.index){f=!0,a.splice(h,0,e),h++;var n=e.addedCount-e.removed.length;i.index+=n,g+=n}}}f||a.push(e)}function D(a,b){for(var c=[],f=0;f<b.length;f++){var g=b[f];switch(g.type){case"splice":C(c,g.index,g.removed.slice(),g.addedCount);break;case"new":case"updated":case"deleted":if(!d(g.name))continue;var h=e(g.name);if(0>h)continue;C(c,h,[g.oldValue],1);break;default:console.error("Unexpected record type: "+JSON.stringify(g))}}return c}function E(a,b){var c=[];return D(a,b).forEach(function(b){return 1==b.addedCount&&1==b.removed.length?(b.removed[0]!==a[b.index]&&c.push(b),void 0):(c=c.concat(A(a,b.index,b.index+b.addedCount,b.removed,0,b.removed.length)),void 0)}),c}var F=b(),G=c(),H=a.Number.isNaN||function(b){return"number"==typeof b&&a.isNaN(b)},I="__proto__"in{}?function(a){return a}:function(a){var b=a.__proto__;if(!b)return a;var c=Object.create(b);return Object.getOwnPropertyNames(a).forEach(function(b){Object.defineProperty(c,b,Object.getOwnPropertyDescriptor(a,b))}),c},J="[$_a-zA-Z]",K="[$_a-zA-Z0-9]",L=J+"+"+K+"*",M="(?:[0-9]|[1-9]+[0-9]+)",N="(?:"+L+"|"+M+")",O="(?:"+N+")(?:\\s*\\.\\s*"+N+")*",P=new RegExp("^"+O+"$"),Q={},R={};i.get=j,i.prototype=I({__proto__:[],valid:!0,toString:function(){return this.join(".")},getValueFrom:function(a,b){for(var c=0;c<this.length;c++){if(null==a)return;b&&b.observe(a),a=a[this[c]]}return a},compiledGetValueFromFn:function(){var a=this.map(function(a){return d(a)?'["'+a+'"]':"."+a}),b="",c="obj";b+="if (obj != null";for(var e=0;e<this.length-1;e++)this[e],c+=a[e],b+=" &&\n     "+c+" != null";return b+=")\n",c+=a[e],b+="  return "+c+";\nelse\n  return undefined;",new Function("obj",b)},setValueFrom:function(a,b){if(!this.length)return!1;for(var c=0;c<this.length-1;c++){if(!f(a))return!1;a=a[this[c]]}return f(a)?(a[this[c]]=b,!0):!1}});var S=new i("",Q);S.valid=!1,S.getValueFrom=S.setValueFrom=function(){};var T=1e3;p.prototype={internalCallback:function(a){this.closed||this.reporting&&this.check(a)&&(this.report(),this.testingResults&&(this.testingResults.anyChanged=!0))},close:function(){this.closed||(this.object&&"function"==typeof this.object.close&&this.object.close(),this.disconnect(),this.object=void 0,this.closed=!0)},deliver:function(a){this.closed||(F?(this.testingResults=a,Object.deliverChangeRecords(this.boundInternalCallback),this.testingResults=void 0):k(this))},report:function(){this.reporting&&(this.sync(!1),this.callback&&(this.reportArgs.push(this.token),this.invokeCallback(this.reportArgs)),this.reportArgs=void 0)},invokeCallback:function(a){try{this.callback.apply(this.target,a)}catch(b){p._errorThrownDuringCallback=!0,console.error("Exception caught during observer callback: "+(b.stack||b))}},reset:function(){this.closed||(F&&(this.reporting=!1,Object.deliverChangeRecords(this.boundInternalCallback),this.reporting=!0),this.sync(!0))}};var U,V=!F||a.forceCollectObservers;p._allObserversCount=0,V&&(U=[]);var W=!1,X="function"==typeof Object.deliverAllChangeRecords;a.Platform=a.Platform||{},a.Platform.performMicrotaskCheckpoint=function(){if(!W){if(X)return Object.deliverAllChangeRecords(),void 0;if(V){W=!0;var b=0,c={};do{b++;var d=U;U=[],c.anyChanged=!1;for(var e=0;e<d.length;e++){var f=d[e];f.closed||(F?f.deliver(c):f.check()&&(c.anyChanged=!0,f.report()),U.push(f))}}while(T>b&&c.anyChanged);a.testingExposeCycleCount&&(a.dirtyCheckCycleCount=b),p._allObserversCount=U.length,W=!1}}},V&&(a.Platform.clearObservers=function(){U=[]}),r.prototype=I({__proto__:p.prototype,connect:function(){F&&Object.observe(this.object,this.boundInternalCallback)},sync:function(){F||(this.oldObject=o(this.object))},check:function(a){var b,c;if(F){if(!a)return!1;c={},b=x(this.object,a,c)}else c=this.oldObject,b=n(this.object,this.oldObject);return m(b)?!1:(this.reportArgs=[b.added||{},b.removed||{},b.changed||{}],this.reportArgs.push(function(a){return c[a]}),!0)},disconnect:function(){F?this.object&&Object.unobserve(this.object,this.boundInternalCallback):this.oldObject=void 0}}),s.prototype=I({__proto__:r.prototype,connect:function(){F&&Array.observe(this.object,this.boundInternalCallback)},sync:function(){F||(this.oldObject=this.object.slice())},check:function(a){var b;if(F){if(!a)return!1;b=E(this.object,a)}else b=A(this.object,0,this.object.length,this.oldObject,0,this.oldObject.length);return b&&b.length?(this.reportArgs=[b],!0):!1}}),s.applySplices=function(a,b,c){c.forEach(function(c){for(var d=[c.index,c.removed.length],e=c.index;e<c.index+c.addedCount;)d.push(b[e]),e++;Array.prototype.splice.apply(a,d)})};var Y=Object.getPrototypeOf({}),Z=Object.getPrototypeOf([]);t.prototype={reset:function(){this.isObserved=!this.isObserved},observe:function(a){if(f(a)&&a!==Y&&a!==Z){var b=this.arr.indexOf(a);b>=0&&this.arr[b+1]===this.isObserved||(0>b&&(b=this.arr.length,this.arr[b]=a,Object.observe(a,this.callback)),this.arr[b+1]=this.isObserved,this.observe(Object.getPrototypeOf(a)))}},cleanup:function(){for(var a=0,b=0,c=this.isObserved;b<this.arr.length;){var d=this.arr[b];this.arr[b+1]==c?(b>a&&(this.arr[a]=d,this.arr[a+1]=c),a+=2):Object.unobserve(d,this.callback),b+=2}this.arr.length=a}},u.prototype=I({__proto__:p.prototype,connect:function(){F&&(this.observedSet=new t(this.boundInternalCallback))},disconnect:function(){this.value=void 0,this.value_=void 0,this.observedSet&&(this.observedSet.reset(),this.observedSet.cleanup(),this.observedSet=void 0)},check:function(){return this.observedSet&&this.observedSet.reset(),this.value_=this.path.getValueFrom(this.object,this.observedSet),this.observedSet&&this.observedSet.cleanup(),g(this.value_,this.oldValue_)?!1:(this.value=this.valueFn?this.valueFn(this.value_):this.value_,this.reportArgs=[this.value,this.oldValue],!0)},sync:function(a){a&&(this.observedSet&&this.observedSet.reset(),this.value_=this.path.getValueFrom(this.object,this.observedSet),this.value=this.valueFn?this.valueFn(this.value_):this.value_,this.observedSet&&this.observedSet.cleanup()),this.oldValue_=this.value_,this.oldValue=this.value},setValue:function(a){this.path&&("function"==typeof this.setValueFn&&(a=this.setValueFn(a)),this.path.setValueFrom(this.object,a))}}),v.prototype=I({__proto__:u.prototype,addPath:function(a,b){if(this.started)throw Error("Cannot add more paths once started.");var b=b instanceof i?b:j(b),c=b?b.getValueFrom(a):void 0;this.observed.push(a,b),this.values.push(c)},start:function(){this.connect(),this.sync(!0)},getValues:function(){this.observedSet&&this.observedSet.reset();for(var a=!1,b=0;b<this.observed.length;b+=2){var c=this.observed[b+1];if(c){var d=this.observed[b],e=c.getValueFrom(d,this.observedSet),f=this.values[b/2];if(!g(e,f)){if(!a&&!this.valueFn){this.oldValues=this.oldValues||[],this.changeFlags=this.changeFlags||[];for(var h=0;h<this.values.length;h++)this.oldValues[h]=this.values[h],this.changeFlags[h]=!1}this.valueFn||(this.changeFlags[b/2]=!0),this.values[b/2]=e,a=!0}}}return this.observedSet&&this.observedSet.cleanup(),a},check:function(){if(this.getValues()){if(this.valueFn){if(this.value=this.valueFn(this.values),g(this.value,this.oldValue))return!1;this.reportArgs=[this.value,this.oldValue]}else this.reportArgs=[this.values,this.oldValues,this.changeFlags];return!0}},sync:function(a){a&&(this.getValues(),this.valueFn&&(this.value=this.valueFn(this.values))),this.valueFn&&(this.oldValue=this.value)},close:function(){if(this.observed){for(var a=0;a<this.observed.length;a+=2){var b=this.observed[a];b&&"function"==typeof b.close&&b.close()}this.observed=void 0,this.values=void 0}p.prototype.close.call(this)}});var $={"new":!0,updated:!0,deleted:!0};u.defineProperty=function(a,b,c){var d=c.object,e=j(c.path),f=w(a,b),g=new u(d,c.path,function(a,b){f&&f("updated",b)});return Object.defineProperty(a,b,{get:function(){return e.getValueFrom(d)},set:function(a){e.setValueFrom(d,a)},configurable:!0}),{close:function(){var c=e.getValueFrom(d);f&&g.deliver(),g.close(),Object.defineProperty(a,b,{value:c,writable:!0,configurable:!0})}}};var _=0,ab=1,bb=2,cb=3;z.prototype={calcEditDistances:function(a,b,c,d,e,f){for(var g=f-e+1,h=c-b+1,i=new Array(g),j=0;g>j;j++)i[j]=new Array(h),i[j][0]=j;for(var k=0;h>k;k++)i[0][k]=k;for(var j=1;g>j;j++)for(var k=1;h>k;k++)if(this.equals(a[b+k-1],d[e+j-1]))i[j][k]=i[j-1][k-1];else{var l=i[j-1][k]+1,m=i[j][k-1]+1;i[j][k]=m>l?l:m}return i},spliceOperationsFromEditDistances:function(a){for(var b=a.length-1,c=a[0].length-1,d=a[b][c],e=[];b>0||c>0;)if(0!=b)if(0!=c){var f,g=a[b-1][c-1],h=a[b-1][c],i=a[b][c-1];f=i>h?g>h?h:g:g>i?i:g,f==g?(g==d?e.push(_):(e.push(ab),d=g),b--,c--):f==h?(e.push(cb),b--,d=h):(e.push(bb),c--,d=i)}else e.push(cb),b--;else e.push(bb),c--;return e.reverse(),e},calcSplices:function(a,b,c,d,e,f){var g=0,h=0,i=Math.min(c-b,f-e);if(0==b&&0==e&&(g=this.sharedPrefix(a,d,i)),c==a.length&&f==d.length&&(h=this.sharedSuffix(a,d,i-g)),b+=g,e+=g,c-=h,f-=h,0==c-b&&0==f-e)return[];if(b==c){for(var j=y(b,[],0);f>e;)j.removed.push(d[e++]);return[j]}if(e==f)return[y(b,[],c-b)];for(var k=this.spliceOperationsFromEditDistances(this.calcEditDistances(a,b,c,d,e,f)),j=void 0,l=[],m=b,n=e,o=0;o<k.length;o++)switch(k[o]){case _:j&&(l.push(j),j=void 0),m++,n++;break;case ab:j||(j=y(m,[],0)),j.addedCount++,m++,j.removed.push(d[n]),n++;break;case bb:j||(j=y(m,[],0)),j.addedCount++,m++;break;case cb:j||(j=y(m,[],0)),j.removed.push(d[n]),n++}return j&&l.push(j),l},sharedPrefix:function(a,b,c){for(var d=0;c>d;d++)if(!this.equals(a[d],b[d]))return d;return c},sharedSuffix:function(a,b,c){for(var d=a.length,e=b.length,f=0;c>f&&this.equals(a[--d],b[--e]);)f++;return f},calculateSplices:function(a,b){return this.calcSplices(a,0,a.length,b,0,b.length)},equals:function(a,b){return a===b}};var db=new z;a.Observer=p,a.Observer.hasObjectObserve=F,a.ArrayObserver=s,a.ArrayObserver.calculateSplices=function(a,b){return db.calculateSplices(a,b)},a.ArraySplice=z,a.ObjectObserver=r,a.PathObserver=u,a.CompoundPathObserver=v,a.Path=i}("undefined"!=typeof global&&global?global:this);var Path={version:"0.8.4",map:function(a){return Path.routes.defined.hasOwnProperty(a)?Path.routes.defined[a]:new Path.core.route(a)},root:function(a){Path.routes.root=a},rescue:function(a){Path.routes.rescue=a},history:{initial:{},pushState:function(a,b,c){Path.history.supported?(history.pushState(a,b,c),Path.dispatch(c)):Path.history.fallback&&(window.location.hash="#"+c)},popState:function(){var a=!Path.history.initial.popped&&location.href==Path.history.initial.URL;Path.history.initial.popped=!0,a||Path.dispatch(document.location.pathname)},listen:function(a){if(Path.history.supported=!(!window.history||!window.history.pushState),Path.history.fallback=a,Path.history.supported)Path.history.initial.popped="state"in window.history,Path.history.initial.URL=location.href,window.onpopstate=Path.history.popState;else if(Path.history.fallback){for(route in Path.routes.defined)"#"!=route.charAt(0)&&(Path.routes.defined["#"+route]=Path.routes.defined[route],Path.routes.defined["#"+route].path="#"+route);Path.listen()}}},match:function(a,b){var c,d,e,f,g,h={},i=null;for(i in Path.routes.defined)if(null!==i&&void 0!==i)for(i=Path.routes.defined[i],c=i.partition(),f=0;f<c.length;f++){if(d=c[f],g=a,d.search(/:/)>0)for(e=0;e<d.split("/").length;e++)e<g.split("/").length&&":"===d.split("/")[e].charAt(0)&&(h[d.split("/")[e].replace(/:/,"")]=g.split("/")[e],g=g.replace(g.split("/")[e],d.split("/")[e]));if(d===g)return b&&(i.params=h),i}return null},dispatch:function(a){var b,c;if(Path.routes.current!==a){if(Path.routes.previous=Path.routes.current,Path.routes.current=a,c=Path.match(a,!0),Path.routes.previous&&(b=Path.match(Path.routes.previous),null!==b&&null!==b.do_exit&&b.do_exit()),null!==c)return c.run(),Path.onchange&&Path.onchange(b,c),!0;null!==Path.routes.rescue&&Path.routes.rescue(),Path.onchange&&Path.onchange(b,c)}},listen:function(){var a=function(){Path.dispatch(location.hash)};""===location.hash&&null!==Path.routes.root&&(location.hash=Path.routes.root),"onhashchange"in window&&(!document.documentMode||document.documentMode>=8)?window.onhashchange=a:setInterval(a,50),""!==location.hash&&Path.dispatch(location.hash)},core:{route:function(a){this.path=a,this.action=null,this.do_enter=[],this.do_exit=null,this.params={},Path.routes.defined[a]=this}},routes:{current:null,root:null,rescue:null,previous:null,defined:{}}};Path.core.route.prototype={to:function(a){return this.action=a,this},enter:function(a){return a instanceof Array?this.do_enter=this.do_enter.concat(a):this.do_enter.push(a),this},exit:function(a){return this.do_exit=a,this},partition:function(){for(var a,b,c=[],d=[],e=/\(([^}]+?)\)/g;a=e.exec(this.path);)c.push(a[1]);for(d.push(this.path.split("(")[0]),b=0;b<c.length;b++)d.push(d[d.length-1]+c[b]);return d},run:function(){var a,b,c=!1;if(Path.routes.defined[this.path].hasOwnProperty("do_enter")&&Path.routes.defined[this.path].do_enter.length>0)for(a=0;a<Path.routes.defined[this.path].do_enter.length;a++)if(b=Path.routes.defined[this.path].do_enter[a].apply(this,null),b===!1){c=!0;break}c||Path.routes.defined[this.path].action()}},function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;return m=[],a.observers=m,setTimeout(function(){return m.calcSplices=g,m.diffObjects=j}),m.add=function(a,b,c){var d,e;return"function"==typeof b&&(c=b,b=!1),e=a(),d={expr:a,callback:c,oldValue:i(e),close:function(){return m.remove(d)}},m.push(d),b&&c(e),d},m.remove=function(a){var b;return b=m.indexOf(a),b?m.splice(b,1):void 0},m.sync=function(){return m.forEach(function(a){var b,c,d;if(d=a.expr(),Array.isArray(d)&&Array.isArray(a.oldValue))c=g(d,a.oldValue),c.length&&a.callback(d,c);else if(d&&a.oldValue&&"object"==typeof d&&"object"==typeof a.oldValue)b=j(d,a.oldValue),b.length&&a.callback(d,b);else{if(d===a.oldValue)return;a.callback(d)}a.oldValue=i(d)})},i=function(a){return Array.isArray(a)?a.slice():a&&"object"==typeof a?h(a):a},j=function(a,b){var c,d,e,f;c=[];for(f in b)e=b[f],d=a[f],(void 0===d||d!==e)&&(f in a?d!==e&&c.push(k(a,"updated",f,e)):c.push(k(a,"deleted",f,e)));for(f in a)d=a[f],f in b||c.push(k(a,"new",f));return Array.isArray(a)&&a.length!==b.length&&c.push(k(a,"updated","length",b.length)),c},k=function(a,b,c,d){return{object:a,type:b,name:c,oldValue:d}},h=function(a){var b,c,d;b=Array.isArray(a)?[]:{};for(c in b)d=b[c],b[c]=d;return Array.isArray(a)&&(b.length=a.length),b},d=0,e=1,b=2,c=3,g=function(a,g){var h,i,j,k,m,q,r,s,t,u,v,w,x,y,z,A;if(i=0,h=a.length,s=0,q=g.length,m=Math.min(h,q),v=n(a,g,m),y=o(a,g,m-v),i+=v,s+=v,h-=y,q-=y,0===h-i&&0===q-s)return[];if(i===h)return[l(i,g.slice(s,q),0)];if(s===q)return[l(i,[],h-i)];for(j=f(a,i,h,g,s,q),u=p(j),w=void 0,x=[],k=i,r=s,z=0,A=u.length;A>z;z++)t=u[z],t===d?(w&&(x.push(w),w=void 0),k++,r++):t===e?(w||(w=l(k,[],0)),w.addedCount++,k++,w.removed.push(g[r]),r++):t===b?(w||(w=l(k,[],0)),w.addedCount++,k++):t===c&&(w||(w=l(k,[],0)),w.removed.push(g[r]),r++);return w&&x.push(w),x},n=function(a,b,c){var d,e;for(d=e=0;c>=0?c>e:e>c;d=c>=0?++e:--e)if(a[d]!==b[d])return d;return length},o=function(a,b,c){var d,e,f;for(e=a.length,f=b.length,d=0;c>d&&a[--e]===b[--f];)d++;return d},l=function(a,b,c){return{index:a,removed:b,addedCount:c}},p=function(a){var f,g,h,i,j,k,l,m;for(h=a.length-1,i=a[0].length-1,f=a[h][i],g=[];h>0||i>0;)0!==h?0!==i?(l=a[h-1][i-1],m=a[h-1][i],k=a[h][i-1],j=k>m?l>m?m:l:l>k?k:l,j===l?(l===f?g.push(d):(g.push(e),f=l),h--,i--):j===m?(g.push(c),h--,f=m):(g.push(b),i--,f=k)):(g.push(c),h--):(g.push(b),i--);return g.reverse(),g},f=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q;for(l=f-e+1,g=c-b+1,h=new Array(l),i=n=0;l>=0?l>n:n>l;i=l>=0?++n:--n)h[i]=new Array(g),h[i][0]=i;for(j=o=0;g>=0?g>o:o>g;j=g>=0?++o:--o)h[0][j]=j;for(i=p=1;l>=1?l>p:p>l;i=l>=1?++p:--p)for(j=q=1;g>=1?g>q:q>g;j=g>=1?++q:--q)a[b+j-1]===d[e+i-1]?h[i][j]=h[i-1][j-1]:(k=h[i-1][j]+1,m=h[i][j-1]+1,h[i][j]=m>k?k:m);return h}}(this);var modifyCopyArray,modifySourceArray,restoreSourceArray,__slice=[].slice;Array.prototype.refresh=function(){},Array.prototype.removeBy=function(a){var b,c,d;for(c=[],b=this.length;b--;)d=this[b],a(d,b,this)===!1&&c.unshift(this.splice(b,1));return c},Array.prototype.liveCopy=function(){var a,b;return b=this,a=b.slice(),modifySourceArray(b),modifyCopyArray(a),b._liveCopies.push(a),a.refresh=function(){return b.refresh(),this},a._source=b,a},Array.prototype.closeCopies=function(){return restoreSourceArray(this)},modifySourceArray=function(a){return a._liveCopies?void 0:(a._liveCopies=[],a.refresh=function(){var a=this;return this._liveCopies.forEach(function(b){var c;return c=a,b._filter&&(c=a.filter(b._filter)),b._sort&&!b._filter&&(c=a.slice()),b._sort&&c.sort(b._sort),c.forEach(function(a,c){return b[c]=a}),b.length=c.length}),this},a.push=function(){var a;return a=1<=arguments.length?__slice.call(arguments,0):[],Array.prototype.push.apply(this,a),this.refresh()},a.unshift=function(){var a;return a=1<=arguments.length?__slice.call(arguments,0):[],Array.prototype.push.apply(this,a),this.refresh()},a.pop=function(){var a;return a=Array.prototype.pop.call(this),this.refresh(),a},a.shift=function(){var a;return a=Array.prototype.shift.call(this),this.refresh(),a},a.splice=function(){var a,b,c,d,e;return b=arguments[0],a=arguments[1],c=3<=arguments.length?__slice.call(arguments,2):[],d=(e=Array.prototype.splice).call.apply(e,[this,b,a].concat(__slice.call(c))),this.refresh(),d})},restoreSourceArray=function(a){return a._liveCopies?(a._liveCopies.forEach(function(a){return delete a._source,delete a.refresh}),delete a._liveCopies,delete a.push,delete a.unshift,delete a.pop,delete a.shift,delete a.splice):void 0},modifyCopyArray=function(a){return a.applyFilter=function(a){return this._filter=a,this.refresh()},a.removeFilter=function(){return this._filter?(delete this._filter,this.refresh()):void 0},a.applySort=function(a){return this._sort=a,this.refresh()},a.removeSort=function(){return this._sort?(delete this._sort,this.refresh()):void 0},a.close=function(){var b,c,d;return d=a._source,d&&(delete a._source,delete a.refresh,b=d._liveCopies,c=b.indexOf(a),-1!==c)?(b.splice(c,1),0===b.length&&restoreArray(d),this):void 0}};var __slice=[].slice;!function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return window.syncView=observers.sync,d=a.fn.bindTo=function(b){var c,e,f,g,h,i;for(g=this,b||(b={"this":{}}),b.hasOwnProperty("this")||(b={"this":b}),h=function(a,c){var d,e,f,g,h,i;for(e=Array.prototype.slice.call(a.get(0).attributes),h=0,i=e.length;i>h;h++)d=e[h],"data"===d.name.split("-").shift()&&(f=c[d.name.replace("data-","")],f&&(g=d.value,a.removeAttr(d.name),f(a,g,b)))},f="[data-"+Object.keys(d.blockHandlers).join("],[data-")+"]";(e=g.find(f)).length;)h(e.first(),d.blockHandlers);return i="[data-"+Object.keys(d.handlers).join("],[data-")+"]",c=g.filter(i).add(g.find(i)),c.each(function(){return h(a(this),d.handlers)}),g},d.blockHandlers={repeat:function(b,d,e){var f,g,h,i,j,k,l;return l=d.split(/\s+in\s+/),i=l[0],d=l[1],f=b.attr("data-controller"),b.removeAttr("data-controller"),j=e["this"]||e,k=b,b=a('<script type="text/repeat-placeholder"><!--data-repeat="'+d+'"--></script>').replaceAll(k),h=a(),g=function(a){var b,c,d;return d=k.clone(),b=f?chip.getController(f,{parent:j,element:d,model:a}):options.controller,c={"this":b},c[i]=a,d.bindTo(c),f&&"function"==typeof b.setup&&b.setup(),d.get(0)},c(b,d,e,function(c,d){return d?d.forEach(function(d){var e,f,i,j,k;for(f=[d.index,d.removed.length],j=[],e=d.index;e<d.index+d.addedCount;)i=c[e],j.push(g(i)),e++;return k=h.splice.apply(h,f.concat(j)),a(k).remove(),0===d.index?b.after(j):h.eq(d.index-1).after(j)}):(h.remove(),h=a(),Array.isArray(c)?(c.forEach(function(a){return h.push(g(a))}),b.after(h)):void 0)})},partial:function(a,b,d){return c(a,b,d,function(b){return a.html(b)})}},d.handlers={"if":function(a,b,d){return c(a,b,d,function(b){return b?a.show():a.hide()})},bind:function(a,b,d){return c(a,b,d,function(b){return a.text(null!=b?b:"")})},"bind-html":function(a,b,d){return c(a,b,d,function(b){return a.html(null!=b?b:"")})},active:function(b,d,e){var f,g;return d?c(b,d,e,function(a){return a?b.addClass("active"):b.removeClass("active")}):(g=function(){return f.length&&f.get(0).href===location.href?b.addClass("active"):b.removeClass("active")},f=b.filter('[href],[data-attr^="href:"]').add(b.children('[href],[data-attr^="href:"]')).first(),f.on("boundUpdate",g),a(document).on("urlchange",g),o(b,function(){return a(document).off("urlchange",g)}),g())},"class":function(a,b,d){return c(a,b,d,function(b){var c,d,e;if(Array.isArray(b)&&(b=b.join(" ")),"string"==typeof b)return a.attr("class",b);if(b&&"object"==typeof b){e=[];for(c in b)d=b[c],d?e.push(a.addClass(c)):e.push(a.removeClass(c));return e}})},value:function(a,b,d){var f;return c(a,b,d,function(b){return a.val(b)}),f=e(b+" = value",d,["value"]),f(a.val()),a.on("keyup",function(){return f(a.val()),syncView()})}},h=["click","dblclick","submit","change","focus","blur"],l={enter:13,esc:27},p=["checked","disabled"],b=["href","src"],h.forEach(function(a){return d.handlers["on"+a]=function(b,c,d){return b.on(a,function(a){return a.preventDefault(),g(c,d)})}}),Object.keys(l).forEach(function(a){var b;return b=l[a],d.handlers["on"+a]=function(a,c,d){return a.on("keydown",function(a){return a.keyCode===b?(a.preventDefault(),g(c,d)):void 0})}}),p.forEach(function(a){return d.handlers[a]=function(b,d,e){return c(b,d,e,function(c){return b.prop(a,c)})}}),b.forEach(function(a){return d.handlers[a]=function(b,d,e){return c(b,d,e,function(c){return null!=c?b.attr(a,c):b.removeAttr(a)})}}),Path.onchange=function(){return a(document).trigger("urlchange")},o=function(a,b){return a.on("removeObserver",b)},a.event.special.removeObserver={remove:function(a){return a.handler()}},q=/[a-z$_\$][a-z_\$0-9\.-]*\s*:?|'|"/gi,m=function(a,b){var c,d,e;for(b=b.concat(["this","window","true","false"]),e="",c=0;d=q.exec(a);)d&&(d=d[0],e+=a.slice(c,q.lastIndex-d.length),"'"===d||'"'===d?(c=a.indexOf(d,q.lastIndex)+1,e+=a.slice(q.lastIndex-1,c),q.lastIndex=c):"."===a[q.lastIndex-d.length-1]?(e+=d,c=q.lastIndex):(":"!==d.slice(-1)&&-1===b.indexOf(d.split(".").shift())&&(e+="this."),e+=d,c=q.lastIndex));return e+=a.slice(c)},c=function(a,b,c,d){var f,g;return g=function(b,c){return a.trigger("boundUpdate"),d(b,c)},f=observers.add(e(b,c),!0,g),o(a,function(){return f.close()}),f},n=function(a){return"this"!==a},j=function(a){return Object.keys(a).filter(n).sort()},k=function(a){return Object.keys(a).filter(n).sort().map(function(b){return a[b]})},i={},f=function(a,b,c){var d,e,f,g;if(d=j(b),c&&(d=d.concat(c)),a=m(a,d),f=i[a])return f;try{g=-1===a.indexOf("(")?"try{return "+a+"}catch(e){}":"return "+a,f=i[a]=Function.apply(null,__slice.call(d).concat([g]))}catch(h){throw e=h,'Error evaluating code for binding: "'+a+'" with error: '+e.message}return f},e=function(a,b,c){var d,e;return e=f(a,b,c),d=k(b),e.bind.apply(e,[b["this"]].concat(__slice.call(d)))},g=function(a,b){var c,d;return d=f(a,b),c=k(b),d.apply(b["this"],c)}}(jQuery);var __hasProp={}.hasOwnProperty;!function(a){var b;return b={templates:{},controllers:{},getTemplate:function(a){return $(b.templates[a])},getController:function(a,c){if(!b.controllers.hasOwnProperty(a))throw'Controller "'+a+'" does not exist';return new b.controllers[a](c)},controller:function(a,c){var d,e,f;null==c&&(c={}),d=function(){function b(b){null==b&&(b={}),this.name=a,this.parent=b.parent,this.model=b.model,this.element=b.element}return b}();for(e in c)__hasProp.call(c,e)&&(f=c[e],d.prototype[e]=f);return b.controllers[a]=d},runRoute:function(a,c){var d,e,f,g,h,i,j;for(g=["[data-route]"],i=0,j=c.length;j>i;i++)f=c[i],g.push("[data-route]");return g=g.join(" "),d=$(g),e=d.data("controller"),null!=e&&"function"==typeof e.teardown&&e.teardown(),e=b.getController(a),h=b.getTemplate(a),d.data("controller",e).html(h).bindTo(e),null!=e&&"function"==typeof e.setup&&e.setup(),syncView()},route:function(a,c,d){var e;return"function"==typeof c&&(d=c),"string"!=typeof c&&(c=a.replace(/^\//,"").replace(/\/\w/,function(a){return a.slice(1).toUpperCase()})),b.route.parents||(b.route.parents=[]),e=b.route.parents.slice(),e.length&&(a=e.join("")+a),Path.map(a).to(function(){return b.runRoute(c,e)}),d?(b.route.parents.push(a),d(b.route),b.route.parents.pop()):void 0},listen:function(){return Path.history.listen(),Path.history.supported?$("body").on("click","a[href]",function(a){return a.preventDefault(),Path.history.pushState({},"",$(this).attr("href"))}):void 0}},"function"==typeof define&&define.amd?define("chip",b):"object"==typeof exports&&"object"==typeof module?(a.chip=b,module.exports=b):a.chip=b}(this);