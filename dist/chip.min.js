Object.getPrototypeOf||(Object.getPrototypeOf=function(a){if(a!==Object(a))throw new TypeError("Object.getPrototypeOf called on non-object");return a.__proto__||a.constructor.prototype||Object.prototype}),"function"!=typeof Object.getOwnPropertyNames&&(Object.getOwnPropertyNames=function(a){if(a!==Object(a))throw new TypeError("Object.getOwnPropertyNames called on non-object");var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}),"function"!=typeof Object.create&&(Object.create=function(a,b){"use strict";function c(){}if("object"!=typeof a)throw new TypeError;c.prototype=a;var d=new c;if(a&&(d.constructor=c),arguments.length>1){if(b!==Object(b))throw new TypeError;Object.defineProperties(d,b)}return d}),function(){if(!Object.defineProperty||!function(){try{return Object.defineProperty({},"x",{}),!0}catch(a){return!1}}()){var a=Object.defineProperty;Object.defineProperty=function(b,c,d){"use strict";if(a)try{return a(b,c,d)}catch(e){}if(b!==Object(b))throw new TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in d&&Object.prototype.__defineGetter__.call(b,c,d.get),Object.prototype.__defineSetter__&&"set"in d&&Object.prototype.__defineSetter__.call(b,c,d.set),"value"in d&&(b[c]=d.value),b}}}(),"function"!=typeof Object.defineProperties&&(Object.defineProperties=function(a,b){"use strict";if(a!==Object(a))throw new TypeError("Object.defineProperties called on non-object");var c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&Object.defineProperty(a,c,b[c]);return a}),Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}),Function.prototype.bind||(Function.prototype.bind=function(a){function b(){}if("function"!=typeof this)throw new TypeError("Bind must be called on a function");var c=[].slice,d=c.call(arguments,1),e=this,f=function(){return e.apply(this instanceof b?this:a||{},d.concat(c.call(arguments)))};return b.prototype=e.prototype,f.prototype=new b,f}),Array.isArray=Array.isArray||function(a){return Boolean(a&&"[object Array]"===Object.prototype.toString.call(Object(a)))},Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),isNaN(d)?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d))));for(var e=d>=0?Math.min(d,c-1):c-Math.abs(d);e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.every||(Array.prototype.every=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;var d,e=arguments[1];for(d=0;c>d;d++)if(d in b&&!a.call(e,b[d],d,b))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;var d,e=arguments[1];for(d=0;c>d;d++)if(d in b&&a.call(e,b[d],d,b))return!0;return!1}),Array.prototype.forEach||(Array.prototype.forEach=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;var d,e=arguments[1];for(d=0;c>d;d++)d in b&&a.call(e,b[d],d,b)}),Array.prototype.map||(Array.prototype.map=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;var d=[];d.length=c;var e,f=arguments[1];for(e=0;c>e;e++)e in b&&(d[e]=a.call(f,b[e],e,b));return d}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;var d,e=[],f=arguments[1];for(d=0;c>d;d++)if(d in b){var g=b[d];a.call(f,g,d,b)&&e.push(g)}return e}),Array.prototype.reduce||(Array.prototype.reduce=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;if(0===c&&1===arguments.length)throw new TypeError;var d,e=0;if(arguments.length>=2)d=arguments[1];else for(;;){if(e in b){d=b[e++];break}if(++e>=c)throw new TypeError}for(;c>e;)e in b&&(d=a.call(void 0,d,b[e],e,b)),e++;return d}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;if(0===c&&1===arguments.length)throw new TypeError;var d,e=c-1;if(arguments.length>=2)d=arguments[1];else for(;;){if(e in this){d=this[e--];break}if(--e<0)throw new TypeError}for(;e>=0;)e in b&&(d=a.call(void 0,d,b[e],e,b)),e--;return d}),String.prototype.trim||(String.prototype.trim=function(){return String(this).replace(/^\s+/,"").replace(/\s+$/,"")}),Date.now||(Date.now=function(){return Number(new Date)}),Date.prototype.toISOString||(Date.prototype.toISOString=function(){function a(a){return("00"+a).slice(-2)}function b(a){return("000"+a).slice(-3)}return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+b(this.getUTCMilliseconds())+"Z"}),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=[].slice,E={}.hasOwnProperty;j={init:function(){return this.rootApp||(this.rootApp=j.app()),this.rootApp.init()},app:function(b){var c;return c=new a(b),b||(this.rootApp=c),c},binding:function(a,c,d){var e;return c||d?b.addBinding(a,c,d):null!=(e=b.bindings[a])?e.handler:void 0},eventBinding:function(a){return b.addEventBinding(a)},keyEventBinding:function(a,c,d){return b.addKeyEventBinding(a,c,d)},attributeBinding:function(a){return b.addAttributeBinding(a)},attributeToggleBinding:function(a){return b.addAttributeToggleBinding(a)},filter:function(a,b,c){return"function"==typeof b||"function"==typeof c?(d.addFilter(a,b,c),this):b?[d.getFilter(a),d.getValueFilter(a)]:d.getFilter(a)}},$(function(){return j.init()}),window.chip=j,p=function(a){var b;if(a.trigger)throw new Error("Object has already become an event emitter");return b=$({}),a.on=b.on.bind(b),a.one=b.one.bind(b),a.off=b.off.bind(b),a.trigger=b.trigger.bind(b),a},j.makeEventEmitter=p,g=function(){function a(){this.routes=[],this.params={},this.prefix="",p(this)}return a.prototype.param=function(a,b){if("function"!=typeof b)throw new Error('param must have a callback of type "function". Got '+b+".");return(this.params[a]||(this.params[a]=[])).push(b),this},a.prototype.route=function(a,b){if("function"!=typeof b)throw new Error('route must have a callback of type "function". Got '+b+".");return"/"!==a[0]&&(a="/"+a),this.routes.push(new f(a,b)),this},a.prototype.redirect=function(a){var b;return"."===a[0]?(b=document.createElement("a"),b.href=a,a=b.pathname):a=this.prefix+a,this.currentUrl!==a?!this.hashOnly&&this.root&&0!==a.indexOf(this.root)?(location.href=a,void 0):(this.usePushState?(history.pushState({},"",a),this.currentUrl=a,this.dispatch(a)):(this.hashOnly||(a=a.replace(this.root,""),"/"!==a[0]&&(a="/"+a)),location.hash="/"===a?"":"#"+a),this):void 0},a.prototype.listen=function(a){var b,c,d,e=this;if(null==a&&(a={}),a.stop)return this._handleChange&&$(window).off("popstate hashchange",this._handleChange),this;if(null!=a.root&&(this.root=a.root),null!=a.prefix&&(this.prefix=a.prefix),null!=a.hashOnly&&(this.hashOnly=a.hashOnly),this.usePushState=!this.hashOnly&&null!=(null!=(d=window.history)?d.pushState:void 0),null!=this.root||this.usePushState||(this.hashOnly=!0),this.hashOnly&&(this.prefix=""),b=null,this._handleChange=function(){var a;return a=b(),e.currentUrl!==a?(e.currentUrl=a,e.dispatch(a)):void 0},this.usePushState)location.hash&&(c=location.pathname.replace(/\/$/,"")+location.hash.replace(/^#?\/?/,"/"),history.replaceState({},"",c)),b=function(){return location.pathname+location.search},$(window).on("popstate",this._handleChange);else{if(!this.hashOnly&&location.pathname!==this.root)return location.href=this.root+"#"+location.pathname,void 0;b=function(){return(e.hashOnly?"":location.pathname.replace(/\/$/,""))+location.hash.replace(/^#?\/?/,"/")},$(window).on("hashchange",this._handleChange)}return this._handleChange(),this},a.prototype.dispatch=function(a){var b,c,d,e,f,g,h=this;return e=document.createElement("a"),e.href=a,f={query:t(e.search)},d=e.pathname,"/"!==d[0]&&(d="/"+d),0===d.indexOf(this.prefix)?(d=d.replace(this.prefix,""),this.trigger("change",d),g=this.routes.filter(function(a){return a.match(d)}),b=[],g.forEach(function(a){var c,d,e;b.push(function(b,c){return b.params=a.params,c()}),e=a.params;for(c in e)d=e[c],h.params[c]&&b.push.apply(b,h.params[c]);return b.push(a.callback)}),c=function(a){var d;if(a)return h.trigger("error",a);if(0!==b.length)return d=b.shift(),d(f,c)},0===b.length?c("notFound"):c(),this):void 0},a}(),j.Router=g,f=function(){function a(a,b){this.path=a,this.callback=b,this.keys=[],this.expr=s(a,this.keys)}return a.prototype.match=function(a){var b,c,d,e,f,g;if(!(d=this.expr.exec(a)))return!1;for(this.params={},b=f=0,g=d.length;g>f;b=++f)e=d[b],0!==b&&(c=this.keys[b-1],"string"==typeof e&&(e=decodeURIComponent(e)),c||(c="*"),this.params[c]=e);return!0},a}(),j.Route=f,s=function(a,b){return a instanceof RegExp?a:(Array.isArray(a)&&(a="("+a.join("|")+")"),a=a.concat("/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?(\*)?/g,function(a,c,d,e,f,g,h){var i;return b.push(e),c=c||"",i="",g||(i+=c),i+="(?:",g&&(i+=c),i+=d||"",i+=f||(d&&"([^/.]+?)"||"([^/]+?)")+")",i+=g||"",h&&(i+="(/*)?"),i}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)"),new RegExp("^"+a+"$","i"))},t=function(a){var b;return b={},""===a?b:(a.replace(/^\?/,"").split("&").forEach(function(a){var c,d,e;return e=a.split("="),c=e[0],d=e[1],b[decodeURIComponent(c)]=decodeURIComponent(d)}),b)},e=function(){function a(a,b,c){this.getter=a,this.callback=b,this.oldValue=c}return a.prototype.skipNextSync=function(){return this.skip=!0},a.prototype.sync=function(){var b,c,d;if(d=this.getter(),this.skip)delete this.skip;else if(Array.isArray(d)&&Array.isArray(this.oldValue))c=m.array(d,this.oldValue),c.length&&this.callback(d,this.oldValue,c);else if(d&&this.oldValue&&"object"==typeof d&&"object"==typeof this.oldValue)b=m.object(d,this.oldValue),b.length&&this.callback(d,this.oldValue,b);else{if(d===this.oldValue)return;this.callback(d,this.oldValue)}return this.oldValue=a.immutable(d)},a.prototype.close=function(){return a.remove(this)},a.observers=[],a.add=function(b,c,d){var e,f;return"function"==typeof c&&(d=c,c=!1),f=b(),e=new a(b,d,this.immutable(f)),this.observers.push(e),c||d(f),e},a.remove=function(a){var b;return b=this.observers.indexOf(a),-1!==b?(this.observers.splice(b,1),!0):!1},a.syncing=!1,a.rerun=!1,a.cycles=0,a.max=10,a.timeout=null,a.sync=function(a){var b=this;if(this.syncing)return this.rerun=!0,!1;if(a)return this.timeout?!1:(this.timeout=setTimeout(function(){return b.timeout=null,b.sync()},0),!0);for(this.syncing=!0,this.rerun=!0,this.cycles=0;this.rerun;){if(++this.cycles===this.max)throw"Infinite observer syncing, an observer is calling Observer.sync() too many times";this.rerun=!1;for(var c=0;c<this.observers.length;c++)this.observers[c].sync()}return this.syncing=!1,this.cycles=0,!0},a.immutable=function(a){return Array.isArray(a)?a.slice():a&&"object"==typeof a?this.copyObject(a):a},a.copyObject=function(a){var b,c,d;b={};for(c in a)d=a[c],b[c]=d;return b},a}(),j.Observer=e,c=function(){function a(){this._observers=[]}return a.prototype.watch=function(b,c,d){var f,g;return f="function"==typeof b?b:a.createBoundFunction(this,b),g=e.add(f,c,d),g.expr=b,this._observers.push(g),g},a.prototype.eval=function(b){return a.createFunction(b).call(this)},a.prototype.evalSetter=function(b,c){return this.passthrough()?this.passthrough().evalSetter(b,c):(b=b.replace(/(\s*\||$)/," = value$1"),a.createFunction(b,["value"]).call(this,c))},a.prototype.getBoundEval=function(){var b,c;return b=arguments[0],c=2<=arguments.length?D.call(arguments,1):[],a.createBoundFunction(this,b,c)},a.prototype.redirect=function(a){return this.app.redirect(a),this},a.prototype.cloneValue=function(a){return e.immutable(this[a])},a.prototype.closeController=function(){var a,b,c,d;if(this._observers){for(d=this._observers,b=0,c=d.length;c>b;b++)a=d[b],a.close();this._observers.length=0}},a.prototype.syncView=function(a){return e.sync(a),"function"==typeof a&&setTimeout(a),this},a.prototype.syncNow=function(){var a,b,c,d;for(d=this._observers,b=0,c=d.length;c>b;b++)a=d[b],a.sync();return this},a.prototype.runFilter=function(){var a,b,c;return c=arguments[0],b=arguments[1],a=3<=arguments.length?D.call(arguments,2):[],d.runFilter.apply(d,[this,b,c].concat(D.call(a)))},a.prototype.runValueFilter=function(){var a,b,c,e;return e=arguments[0],b=arguments[1],c=arguments[2],a=4<=arguments.length?D.call(arguments,3):[],d.runValueFilter.apply(d,[this,c,e,b].concat(D.call(a)))},a.prototype.passthrough=function(a){return arguments.length?this._passthrough=a:this.hasOwnProperty("_passthrough")?this._passthrough:null},a.keywords=["this","window","$","true","false"],a.filters={},a.exprCache={},a.createFunction=function(a,b){var c,d,e;if(null==b&&(b=[]),d=this.exprCache[a])return d;e=r(a,b);try{d=this.exprCache[a]=Function.apply(null,D.call(b).concat([e]))}catch(f){throw c=f,new Error(c.message+" in observer binding:\n`"+a+"`\n"+"Compiled binding:\n"+e)}return d},a.createBoundFunction=function(b,c,d){var e;return e=a.createFunction(c,d),e.bind(b)},a}(),$.fn.controller=function(a){var b,c;for(c=this;c.length;){if(b=c.data("controller"))return a&&b.passthrough()?b.passthrough():b;c=c.parent()}return null},$.widget||($.cleanData=function(a){return function(b){var c,d,e,f;for(e=0,f=b.length;f>e;e++){d=b[e];try{$(d).triggerHandler("remove")}catch(g){c=g}}return a(b)}}($.cleanData)),A=/[a-z$_\$][a-z_\$0-9\.-]*\s*:?|'|"/gi,x=/(['"\/])(\\\1|[^\1])*?\1/g,l=/(['"\/])\1/g,u=/\|(\|)?/g,h=/\s*:\s*/g,y=/\s=\s/,r=function(a,b){var d,e,f,g,i,j,k,m,n,o,p,q,r,s;if(g=a,f={references:0,ignore:c.keywords.concat(b)},m=[],a=a.replace(x,function(a,b){return m.push(a),b+b}),a=a.replace(u,function(a,b){return b?a:"@@@"}),d=a.split(/\s*@@@\s*/),a=d.shift(),d.length?(y.test(a)?(p=a.split(" = "),j=p[0],n=p[1],j=w(j,f).replace(/^\(|\)$/g,"")+" = ",n=w(n,f)):(j="",n=w(a,f)),k=(null!=(q=a.match(x))?q.length:void 0)||0,d.forEach(function(a){var b,c,d;return b=a.split(h),m.splice(k++,0,"'"+b[0]+"'"),k+=(null!=(d=a.match(x))?d.length:void 0)||0,b[0]="''",b=b.map(function(a){return w(a,f)}),j?(c=j.split(" : ").pop().split(" = ").shift(),n="this.runValueFilter("+n+", "+c+", "+b.join(", ")+")"):n="this.runFilter("+n+", "+b.join(", ")+")"}),a=j+n):y.test(a)?(r=a.split(" = "),j=r[0],n=r[1],j=w(j,f).replace(/^\(|\)$/g,"")+" = ",n=w(n,f),a=j+n):a=w(a,f),a="return "+a,a=a.replace(l,function(){return m.shift()}),f.references){for(i=[],e=o=1,s=f.references;s>=1?s>=o:o>=s;e=s>=1?++o:--o)i.push("_ref"+e);a="var "+i.join(", ")+";\n"+a}return a},w=function(a,b){var c,d,e,f,g,h;for(null==b&&(b={}),b.references||(b.references=0),b.currentRef=b.references,b.ignore||(b.ignore=[]),h=/((\{|,|\.)?\s*)([a-z$_\$](?:[a-z_\$0-9\.-]|\[['"\d]+\])*)(\s*(:|\()?)/gi,c=0,f="",g=function(c,d,e,f,g,i){var j,k,l,m,n,o;if(l=h.lastIndex-c.length,e&&":"===i)return c;for(k="."===d,k&&(f="."+f,d=""),j=/\.|\[/g,l=0,o=[];c=j.exec(f);)1!==j.lastIndex&&(o.push(f.slice(l,j.lastIndex-1)),l=j.lastIndex-1);return o.push(f.slice(l)),m="",1!==o.length||k||i?(k||(m+="("),o.forEach(function(c,d){var e,f,j,l,n;if(d!==o.length-1)return m+=v(b,c,d,k);if("("!==i)return m+="_ref"+b.currentRef+c+")";for(l=1,n=h.lastIndex,f=n-1;f++<a.length;){switch(a[f]){case"(":l++;break;case")":l--}if(0===l)break}return h.lastIndex=f+1,g="",c+="(innards)","."===a[f+1]?m+=v(b,c,d,k):0===d?(m+=v(b,c,d,k),m+="_ref"+b.currentRef+")"):m+="_ref"+b.currentRef+c+")",e=b.currentRef,j=w(a.slice(n,f),b),m=m.replace(/\(innards\)/,"("+j+")"),b.currentRef=e})):(n=o[0],m=-1===b.ignore.indexOf(n)?"this."+n:n),d+m+g};e=h.exec(a);)d=h.lastIndex-e[0].length,f+=a.slice(c,d)+g.apply(null,e),c=h.lastIndex;return f+=a.slice(c)},v=function(a,b,c,d){var e;return b=0!==c||d?"_ref"+a.currentRef+b:-1===a.ignore.indexOf(b.split(/\.|\(/).shift())?"this."+b:""+b,a.currentRef=++a.references,e="_ref"+a.currentRef,"("+e+" = "+b+") == null ? undefined : "},j.Controller=c,a=function(){function a(a){this.name=a,this.bindingPrefix="chip-",this.controllers={},this.templates={},this.router=new g,this.rootElement=$("html"),this.translations={}}return a.prototype.init=function(a){var b,c,d;if(this.inited)return this.rootController;for(this.inited=!0,a&&(this.rootElement=a),this.rootController=this.createController({element:this.rootElement,name:"application"}),b=this,this.rootElement.find('script[type="text/html"]').each(function(){var a,c;return a=$(this),c=a.attr("name")||a.attr("id"),c?(b.template(c,a.html()),a.remove()):void 0});(c=this.rootElement.find("["+this.bindingPrefix+"controller]:first")).length;)d=c.attr(""+this.bindingPrefix+"controller"),c.removeAttr(""+this.bindingPrefix+"controller"),this.createController({element:c,name:d,parent:this.rootController});return this.rootController},a.prototype.template=function(a,b){if(arguments.length>1)return this.templates[a]=b,this;if(!this.templates.hasOwnProperty(a))throw'Template "'+a+'" does not exist';return $(this.templates[a].trim())},a.prototype.translate=function(a,b){var c,d,e,f;if(!b){e=this.translations;for(c in e)d=e[c],delete this.translations[c]}for(c in a)d=a[c],this.translations[c]=d;return null!=(f=this.rootController)?f.trigger("translationChange",[this.translations]):void 0},a.prototype.controller=function(a,b){return arguments.length>1?(this.controllers[a]=b,this):this.controllers[a]||window[a+"Controller"]},a.prototype.createController=function(a){var b,d,e,f,g,h,i,j=this;if(null==a&&(a={}),a.parent instanceof c?(b=function(){return c.call(this)},a.parent&&(b.prototype=a.parent),d=new b,d.parent=a.parent,a.passthrough&&(a.parent.passthrough()?d.passthrough(a.parent.passthrough()):d.passthrough(a.parent))):(d=new c,p(d),d.app=this,d.translations=this.translations),a.properties){i=a.properties;for(e in i)E.call(i,e)&&(g=i[e],d[e]=g)}return d.child=function(a){return null==a&&(a={}),a.parent=d,j.createController(a)},d.template=function(a){return j.template(a)},a.element&&((f=a.element.data("controller"))&&(a.element.off("remove.controller"),f.closeController()),a.element.on("remove.controller",function(){return d.closeController()}),d.element=a.element,a.element.data("controller",d)),a.name&&"function"==typeof(h=this.controller(a.name))&&h(d),a.element&&a.element.bindTo(d),d},a.prototype.param=function(a,b){var c,d=this;return c=function(a,c){return d.rootController.params=a.params,d.rootController.query=a.query,b(d.rootController,c)},this.router.param(a,c),this},a.prototype.route=function(a,b,c){var d,e=this;return d=function(a,b,c,f,g){var h,i;if("function"==typeof b&&b.toString().match(/\(route\)/)&&(c=b,b=null),b||(b=a.replace(/^\//,"")),"string"==typeof b){if(i=b,h=function(a,b){var c,d,h,j,k,l;for(j=e.rootController,g&&(j=g(a,b)),e.rootController.params=a.params,e.rootController.query=a.query,k=[],h=l=0;f>=0?f>=l:l>=f;h=f>=0?++l:--l)k.push("["+e.bindingPrefix+"route]");return c=e.rootElement.find(k.join(" ")+":first"),c.length&&c.attr(""+e.bindingPrefix+"route")!==i?(c.attr(""+e.bindingPrefix+"route",i),c.html(e.template(i)),d=e.createController({element:c,parent:j,name:i})):d=c.data("controller"),d.syncView()},"function"==typeof c)return c(function(b,c,e){return"/"===b&&(b=""),d(a+b,c,e,f+1,h)}),void 0}else{if("function"!=typeof b)throw new Error("route handler must be a string path or a function");h=function(a,c){return e.rootController.params=a.params,e.rootController.query=a.query,b(e.rootController,c)}}return e.router.route(a,h)},d(a,b,c,0),this},a.prototype.redirect=function(a){return this.router.redirect(a),window.scrollTo(0,0)},a.prototype.mount=function(){},a.prototype.listen=function(a){var b=this;return $(function(){var c;return a.stop?(b._routeHandler&&b.router.off("change",b._routeHandler),b._clickHandler&&b.rootElement.off("click","a[href]",b._clickHandler),b.router.listen(a)):(c=b,b._routeHandler=function(a,c){return b.rootController.trigger("urlChange",[c])},b._clickHandler=function(a){return a.isDefaultPrevented()||this.host!==location.host||this.href===location.href+"#"?void 0:(a.preventDefault(),$(this).attr("disabled")?void 0:c.redirect($(this).attr("href").replace(/^#/,"")))},b.router.on("change",b._routeHandler),b.rootElement.on("click","a[href]",b._clickHandler),b.router.listen(a))}),this},a}(),j.App=a,b=function(){function a(a,b){this.name=a,this.expr=b}return a.bindings=[],a.addBinding=function(a,b,c){var d;return"function"==typeof b&&(c=b,b=0),d={name:a,priority:b,handler:c},this.bindings[a]=d,this.bindings.push(d),this.bindings.sort(function(a,b){return b.priority-a.priority})},a.removeBinding=function(a){var b;return(b=this.bindings[a])?(delete this.bindings[a],this.bindings.splice(this.bindings.indexOf(b),1)):void 0},a.addEventBinding=function(a){return this.addBinding(a,function(b,c,d){return b.on(a,function(a){return a.preventDefault(),b.attr("disabled")?void 0:d.eval(c)})})},a.addKeyEventBinding=function(a,b,c){return this.addBinding(a,function(a,d,e){return a.on("keydown",function(f){return null!=c&&f.ctrlKey!==c&&f.metaKey!==c||f.keyCode!==b?void 0:(f.preventDefault(),a.attr("disabled")?void 0:e.eval(d))})})},a.addAttributeBinding=function(a){return this.addBinding(a,function(b,c,d){return d.watch(c,function(c){return null!=c?(b.attr(a,c),b.trigger(a+"Changed")):b.removeAttr(a)})})},a.addAttributeToggleBinding=function(a){return this.addBinding(a,function(b,c,d){return d.watch(c,function(c){return b.attr(a,c&&!0||!1)})})},a.process=function(a,b){var d,e,f,g,h,i,j=this;if(!(b instanceof c))throw new Error("A Controller is required to bind a jQuery element.");for(g=a.get(0),h=g.parentNode,i=b.app.bindingPrefix,e=$(g.attributes).toArray().filter(function(a){return 0===a.name.indexOf(i)&&j.bindings[a.name.replace(i,"")]&&void 0!==a.value}),e=e.map(function(a){var b;return b=j.bindings[a.name.replace(i,"")],{name:a.name,value:a.value,priority:b.priority,handler:b.handler}}),e=e.sort(function(a,b){return b.priority-a.priority});e.length;)if(d=e.shift(),g.hasAttribute(d.name)){if(g.removeAttribute(d.name),f=d.handler(a,d.value,b),g.parentNode!==h)return;f instanceof c&&(b=f)}return a.children().each(function(a,c){return j.process($(c),b)})},a}(),jQuery.fn.bindTo=function(a){return 0!==this.length?b.process(this,a):void 0},j.Binding=b,d=function(){function a(a,b){this.name=a,this.filter=b}return a.filters={},a.valueFilters={},a.addFilter=function(b,c,d){return null!=c&&(this.filters[b]=new a(b,c)),null!=d&&(this.valueFilters[b]=new a(b,d)),this},a.getFilter=function(a){return this.filters[a]},a.getValueFilter=function(a){return this.valueFilters[a]},a.runFilter=function(){var a,b,c,d,e,f;return b=arguments[0],d=arguments[1],e=arguments[2],a=4<=arguments.length?D.call(arguments,3):[],c=null!=(f=this.filters[d])?f.filter:void 0,c?c.apply(null,[b,e].concat(D.call(a))):e},a.runValueFilter=function(){var a,b,c,d,e,f,g;return b=arguments[0],e=arguments[1],f=arguments[2],c=arguments[3],a=5<=arguments.length?D.call(arguments,4):[],d=null!=(g=this.valueFilters[e])?g.filter:void 0,d?d.apply(null,[b,f,c].concat(D.call(a))):f},a}(),j.binding("debug",function(a,b,c){return c.watch(b,function(a){return console.info("Debug:",b,"=",a)})}),j.binding("text",function(a,b,c){return c.watch(b,function(b){return a.text(null!=b?b:"")})}),j.binding("html",function(a,b,c){return c.watch(b,function(b){return a.html(null!=b?b:"")})}),j.binding("trim",function(a){var b,c,d;for(c=a.get(0).firstChild,d=[];c;)b=c.nextSibling,c.nodeType===Node.TEXT_NODE&&c.nodeValue.match(/^\s*$/)&&c.parentNode.removeChild(c),d.push(c=b);return d}),j.binding("translate",function(a,b,c){var d,e,f,g,h,i,j,k;for(f=a.get(0).childNodes,i="",g=[],d=j=0,k=f.length;k>j;d=++j)e=f[d],3===e.nodeType?(""!==e.nodeValue.trim()||0!==d&&d!==f.length-1)&&(i+=e.nodeValue):1===e.nodeType&&(i+="%{"+g.length+"}",g.push(e));return h=function(){var b,d,e,h,j;for(j=c.translations[i]||i,b=/%{(\d+)}/g,f=[],d=0;e=b.exec(j);)h=b.lastIndex-e[0].length,d!==h&&f.push(document.createTextNode(j.slice(d,h))),f.push(g[e[1]]),d=b.lastIndex;return d!==j.length&&f.push(document.createTextNode(j.slice(d))),a.html(f)},a.on("remove",function(){return c.off("translationChange",h)}),c.on("translationChange",h),c.translations[i]?h():void 0}),j.binding("class",function(a,b,c){return c.watch(b,function(b){var c,d,e;if(Array.isArray(b)&&(b=b.join(" ")),"string"==typeof b)return a.attr("class",b);if(b&&"object"==typeof b){e=[];for(c in b)E.call(b,c)&&(d=b[c],d?e.push(a.addClass(c)):e.push(a.removeClass(c)));return e}})}),j.binding("active",function(a,b,c){var d,e;return b?c.watch(b,function(b){return b?a.addClass("active"):a.removeClass("active")}):(e=function(){return d.length&&d.get(0).href===location.href?a.addClass("active"):a.removeClass("active")},d=a.filter("a").add(a.find("a")).first(),d.on("hrefChanged",e),c.on("urlChange",e),a.on("remove",function(){return c.off("urlChange",e)}),e())}),j.binding("active-section",function(a,b,c){var d,e;return e=function(){return d.length&&0===location.href.indexOf(d.get(0).href)?a.addClass("active"):a.removeClass("active")},d=a.filter("a").add(a.find("a")).first(),d.on("hrefChanged",e),c.on("urlChange",e),a.on("remove",function(){return c.off("urlChange",e)}),e()}),j.binding("value",function(a,b,c){var d,e,f;return d="checkbox"===a.attr("type")?function(){return a.prop("checked")}:a.is(":not(input,select,textarea,option)")?function(){return a.find("input:radio:checked").val()}:function(){return a.val()},f="checkbox"===a.attr("type")?function(b){return a.prop("checked",b)}:a.is(":not(input,select,textarea,option)")?function(b){return a.find("input:radio:checked").prop("checked",!1),a.find('input:radio[value="'+b+'"]').prop("checked",!0)}:function(b){return a.val(b)},e=c.watch(b,function(a){return d()!==a?f(a):void 0}),a.is("option")?void 0:(a.is("select")?setTimeout(function(){return f(c.eval(b)),c.evalSetter(b,d())}):c.evalSetter(b,d()),a.on("change",function(){return d()!==e.oldValue?(c.evalSetter(b,d()),e.skipNextSync(),c.syncView()):void 0}))}),["click","dblclick","submit","change","focus","blur"].forEach(function(a){return j.eventBinding(a)}),o={enter:13,esc:27};for(q in o)E.call(o,q)&&(n=o[q],j.keyEventBinding(q,n));for(j.keyEventBinding("ctrl-enter",o.enter,!0),i=["href","src","id"],B=0,C=i.length;C>B;B++)q=i[B],j.attributeBinding(q);["checked","disabled"].forEach(function(a){return j.attributeToggleBinding(a)}),j.binding("if",50,function(a,b,c){var d,e,f,g;return f=c.app.bindingPrefix,g=a,e=$("<!--"+f+'if="'+b+'"-->').replaceAll(g),d=a.attr(f+"controller"),a.removeAttr(f+"controller"),c.watch(b,function(b){if(b){if(e.parent().length)return a=g.clone(),c.child({element:a,name:d,passthrough:!0}),e.replaceWith(a)}else if(!e.parent().length)return a.replaceWith(e)})}),j.binding("unless",50,function(a,b,c){var d,e,f,g;return f=c.app.bindingPrefix,g=a,e=$("<!--"+f+'unless="'+b+'"-->').replaceAll(g),d=a.attr(f+"controller"),a.removeAttr(f+"controller"),c.watch(b,function(b){if(b){if(!e.parent().length)return a.replaceWith(e)}else if(e.parent().length)return a=g.clone(),c.child({element:a,name:d,passthrough:!0}),e.replaceWith(a)})}),j.binding("each",100,function(a,b,c){var d,e,f,g,h,i,j,k,l,n,o,p,q;if(j=c.app.bindingPrefix,h=b,p=b.split(/\s+in\s+/),g=p[0],b=p[1],!g||!b)throw"Invalid "+j+'each="'+h+'". Requires the format "item in list"'+' or "key, propery in object".';return d=a.attr(j+"controller"),a.removeAttr(j+"controller"),q=g.split(/\s*,\s*/),g=q[0],k=q[1],n=a,i=$("<!--"+j+'each="'+b+'"-->').replaceAll(n),f=$(),l={},o=null,e=function(a){var b;return b=n.clone(),Array.isArray(o)?l[g]=a:(k&&(l[k]=a),l[g]=o[a]),c.child({element:b,name:d,properties:l}),b.get(0)},c.watch(b,function(a,b,c){if(o=a,c){if(Array.isArray(o)||o&&"object"==typeof o)return Array.isArray(o)||(c=m.array(Object.keys(o,b))),c.forEach(function(a){var b,c,d,g,h;for(c=[a.index,a.removed.length],g=[],b=a.index;b<a.index+a.addedCount;)d=o[b],g.push(e(d)),b++;return h=$(f.splice.apply(f,c.concat(g))),h.length&&(0===f.length-g.length&&h.eq(0).replaceWith(i),h.remove()),g.length?0===a.index?i.parent().length?i.after(g).remove():f.eq(g.length).before(g):f.eq(a.index-1).after(g):void 0})}else if(f.length&&(f.eq(0).replaceWith(i),f.remove(),f=$()),a&&!Array.isArray(a)&&"object"==typeof a&&(a=Object.keys(a)),Array.isArray(o)&&o.length)return o.forEach(function(a){return f.push(e(a))}),i.after(f).remove()})}),j.binding("partial",50,function(a,b,c){var d,e,f,g,h,i;return h=b.split(/\s+as\s+|\s+with\s+/),g=h.pop(),e=h[0],f=h[1],d=null,i={},e&&f&&c.watch(e,!0,function(a){return d[f]=a}),c.watch(g,function(b){return null!=b?(a.html(c.template(b)),e&&f&&(i[f]=c.eval(e)),d=c.child({element:a,name:b,properties:i})):void 0})}),j.binding("controller",30,function(a,b,c){return c.child({element:a,name:b})}),j.filter("filter",function(a,b,c){return Array.isArray(b)?c?b.filter(c,a):b:[]}),j.filter("map",function(a,b,c){return null!=b&&c?Array.isArray(b)?b.map(c,a):c.call(a,b):b}),j.filter("date",function(a,b){return b?(b instanceof Date||(b=new Date(a,b)),isNaN(b.getTime())?"":b.toLocaleString()):""}),j.filter("log",function(a,b,c){return null==c&&(c="Log"),console.log(c+":",b),b}),j.filter("limit",function(a,b,c){return b&&"function"==typeof b.slice?0>c?b.slice(c):b.slice(0,c):b}),j.filter("sort",function(a,b,c){return Array.isArray(b)?b.slice().sort(c):b}),k=null,j.filter("escape",function(a,b){return k||(k=$("<div></div>")),k.text(a,b||"").text()}),j.filter("p",function(a,b){var c,d;return k||(k=$("<div></div>")),d=(b||"").split(/\r?\n/),c=d.map(function(a){return k.text(a).text()||"<br>"}),"<p>"+c.join("</p><p>")+"</p>"}),j.filter("br",function(a,b){var c,d;return k||(k=$("<div></div>")),d=(b||"").split(/\r?\n/),c=d.map(function(a){return k.text(a).text()}),c.join("<br>")}),j.filter("newline",function(a,b){var c,d;return k||(k=$("<div></div>")),d=(b||"").split(/\r?\n\s*\r?\n/),c=d.map(function(a){var b;return b=a.split(/\r?\n/),c=b.map(function(a){return k.text(a).text()}),c.join("<br>")}),"<p>"+c.join("</p><p>")+"</p>"}),z=/(^|\s|\()((?:https?|ftp):\/\/[\-A-Z0-9+\u0026@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~(_|])/gi,j.filter("autolink",function(a,b,c){return c=c?' target="_blank"':"",(""+b).replace(/<[^>]+>|[^<]+/g,function(a){return"<"===a[0]?a:a.replace(z,'$1<a href="$2"'+c+">$2</a>")})}),j.filter("int",null,function(a,b){return b=parseInt(b),isNaN(b)?null:b}),j.filter("float",null,function(a,b){return b=parseInt(b),isNaN(b)?null:b}),m={},function(){var a,b,c,d,e,f,g,h,i,j;return m.object=function(a,b){var c,d,e,g;c=[];for(g in b)e=b[g],d=a[g],(void 0===d||d!==e)&&(g in a?d!==e&&c.push(f(a,"updated",g,e)):c.push(f(a,"deleted",g,e)));for(g in a)d=a[g],g in b||c.push(f(a,"new",g));return Array.isArray(a)&&a.length!==b.length&&c.push(f(a,"updated","length",b.length)),c},f=function(a,b,c,d){return{object:a,type:b,name:c,oldValue:d}},c=0,d=1,a=2,b=3,m.array=function(f,k){var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;
if(m=0,l=f.length,s=0,q=k.length,p=Math.min(l,q),v=h(f,k,p),y=i(f,k,p-v),m+=v,s+=v,l-=y,q-=y,0===l-m&&0===q-s)return[];if(m===l)return[g(m,k.slice(s,q),0)];if(s===q)return[g(m,[],l-m)];for(n=e(f,m,l,k,s,q),u=j(n),w=void 0,x=[],o=m,r=s,z=0,A=u.length;A>z;z++)t=u[z],t===c?(w&&(x.push(w),w=void 0),o++,r++):t===d?(w||(w=g(o,[],0)),w.addedCount++,o++,w.removed.push(k[r]),r++):t===a?(w||(w=g(o,[],0)),w.addedCount++,o++):t===b&&(w||(w=g(o,[],0)),w.removed.push(k[r]),r++);return w&&x.push(w),x},h=function(a,b,c){var d,e;for(d=e=0;c>=0?c>e:e>c;d=c>=0?++e:--e)if(a[d]!==b[d])return d;return c},i=function(a,b,c){var d,e,f;for(e=a.length,f=b.length,d=0;c>d&&a[--e]===b[--f];)d++;return d},g=function(a,b,c){return{index:a,removed:b,addedCount:c}},j=function(e){var f,g,h,i,j,k,l,m;for(h=e.length-1,i=e[0].length-1,f=e[h][i],g=[];h>0||i>0;)0!==h?0!==i?(l=e[h-1][i-1],m=e[h-1][i],k=e[h][i-1],j=k>m?l>m?m:l:l>k?k:l,j===l?(l===f?g.push(c):(g.push(d),f=l),h--,i--):j===m?(g.push(b),h--,f=m):(g.push(a),i--,f=k)):(g.push(b),h--):(g.push(a),i--);return g.reverse(),g},e=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q;for(l=f-e+1,g=c-b+1,h=new Array(l),i=n=0;l>=0?l>n:n>l;i=l>=0?++n:--n)h[i]=new Array(g),h[i][0]=i;for(j=o=0;g>=0?g>o:o>g;j=g>=0?++o:--o)h[0][j]=j;for(i=p=1;l>=1?l>p:p>l;i=l>=1?++p:--p)for(j=q=1;g>=1?g>q:q>g;j=g>=1?++q:--q)a[b+j-1]===d[e+i-1]?h[i][j]=h[i-1][j-1]:(k=h[i-1][j]+1,m=h[i][j-1]+1,h[i][j]=m>k?k:m);return h}}.call(this),j.equality=m}.call(this);