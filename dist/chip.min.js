var Path={version:"0.8.4",map:function(a){return Path.routes.defined.hasOwnProperty(a)?Path.routes.defined[a]:new Path.core.route(a)},root:function(a){Path.routes.root=a},rescue:function(a){Path.routes.rescue=a},history:{initial:{},pushState:function(a,b,c){Path.history.supported?(history.pushState(a,b,c),Path.dispatch(c)):Path.history.fallback&&(window.location.hash="#"+c)},popState:function(){var a=!Path.history.initial.popped&&location.href==Path.history.initial.URL;Path.history.initial.popped=!0,a||Path.dispatch(document.location.pathname)},listen:function(a){if(Path.history.supported=!(!window.history||!window.history.pushState),Path.history.fallback=a,Path.history.supported)Path.history.initial.popped="state"in window.history,Path.history.initial.URL=location.href,window.onpopstate=Path.history.popState;else if(Path.history.fallback){for(route in Path.routes.defined)"#"!=route.charAt(0)&&(Path.routes.defined["#"+route]=Path.routes.defined[route],Path.routes.defined["#"+route].path="#"+route);Path.listen()}}},match:function(a,b){var c,d,e,f,g,h={},i=null;for(i in Path.routes.defined)if(null!==i&&void 0!==i)for(i=Path.routes.defined[i],c=i.partition(),f=0;f<c.length;f++){if(d=c[f],g=a,d.search(/:/)>0)for(e=0;e<d.split("/").length;e++)e<g.split("/").length&&":"===d.split("/")[e].charAt(0)&&(h[d.split("/")[e].replace(/:/,"")]=g.split("/")[e],g=g.replace(g.split("/")[e],d.split("/")[e]));if(d===g)return b&&(i.params=h),i}return null},dispatch:function(a){var b,c;if(Path.routes.current!==a){if(Path.routes.previous=Path.routes.current,Path.routes.current=a,c=Path.match(a,!0),Path.routes.previous&&(b=Path.match(Path.routes.previous),null!==b&&null!==b.do_exit&&b.do_exit()),null!==c)return c.run(),Path.onchange&&Path.onchange(b,c),!0;null!==Path.routes.rescue&&Path.routes.rescue(),Path.onchange&&Path.onchange(b,c)}},listen:function(){var a=function(){Path.dispatch(location.hash)};""===location.hash&&null!==Path.routes.root&&(location.hash=Path.routes.root),"onhashchange"in window&&(!document.documentMode||document.documentMode>=8)?window.onhashchange=a:setInterval(a,50),""!==location.hash&&Path.dispatch(location.hash)},core:{route:function(a){this.path=a,this.action=null,this.do_enter=[],this.do_exit=null,this.params={},Path.routes.defined[a]=this}},routes:{current:null,root:null,rescue:null,previous:null,defined:{}}};Path.core.route.prototype={to:function(a){return this.action=a,this},enter:function(a){return a instanceof Array?this.do_enter=this.do_enter.concat(a):this.do_enter.push(a),this},exit:function(a){return this.do_exit=a,this},partition:function(){for(var a,b,c=[],d=[],e=/\(([^}]+?)\)/g;a=e.exec(this.path);)c.push(a[1]);for(d.push(this.path.split("(")[0]),b=0;b<c.length;b++)d.push(d[d.length-1]+c[b]);return d},run:function(){var a,b,c=!1;if(Path.routes.defined[this.path].hasOwnProperty("do_enter")&&Path.routes.defined[this.path].do_enter.length>0)for(a=0;a<Path.routes.defined[this.path].do_enter.length;a++)if(b=Path.routes.defined[this.path].do_enter[a].apply(this,null),b===!1){c=!0;break}c||Path.routes.defined[this.path].action()}},function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=[].slice,n={}.hasOwnProperty;e={},this.chip=e,"function"==typeof define&&define.amd?define("chip",e):"object"==typeof exports&&"object"==typeof module&&(module.exports=e),e.templates={},$(function(){var a,c,d;for($('script[type="text/html"]').each(function(){var a,b;return a=$(this),b=a.attr("name")||a.attr("id"),b?(e.templates[b]=a.html(),a.remove()):void 0}),d=[];(a=$("[data-controller]")).length;)c=a.attr("data-controller"),a.removeAttr("data-controller"),d.push(b.create(a,c));return d}),e.getTemplate=function(a){if(!e.templates.hasOwnProperty(a))throw'Template "'+a+'" does not exist';return $(e.templates[a])},e.route=function(a,b,c){var d;return"function"==typeof b&&(c=b),"string"!=typeof b&&(b=a.replace(/^\//,"").replace(/\/\w/,function(a){return a.slice(1).toUpperCase()})),e.route.parents||(e.route.parents=[]),d=e.route.parents.slice(),d.length&&(a=d.join("")+a),Path.map(a).to(function(){return e.runRoute(b,d)}),c?(e.route.parents.push(a),c(e.route),e.route.parents.pop()):void 0},e.runRoute=function(a,c){var d,f,g,h,i,j,k;for(h=["[data-route]"],j=0,k=c.length;k>j;j++)g=c[j],h.push("[data-route]");return h=h.join(" "),d=$(h),f=d.data("controller"),null!=f&&"function"==typeof f.teardown&&f.teardown(),i=e.getTemplate(a),d.data("controller",f).html(i),f=b.create(d,a),f.syncView()},e.listen=function(){return Path.history.listen(),Path.history.supported?$("body").on("click","a[href]",function(a){return a.preventDefault(),Path.history.pushState({},"",$(this).attr("href"))}):void 0},c=function(){function a(a,b,c){this.getter=a,this.callback=b,this.oldValue=c}return a.prototype.skipNextSync=function(){return this.skip=!0},a.prototype.sync=function(){var b,c,d;if(d=this.getter(),this.skip)delete this.skip;else if(Array.isArray(d)&&Array.isArray(this.oldValue))c=equality.array(d,this.oldValue),c.length&&this.callback(d,c);else if(d&&this.oldValue&&"object"==typeof d&&"object"==typeof this.oldValue)b=equality.object(d,this.oldValue),b.length&&this.callback(d,b);else{if(d===this.oldValue)return;this.callback(d)}return this.oldValue=a.immutable(d)},a.prototype.close=function(){return a.remove(this)},a.observers=[],a.add=function(b,c,d){var e,f;return"function"==typeof c&&(d=c,c=!1),f=b(),e=new a(b,d,this.immutable(f)),this.observers.push(e),c||d(f),e},a.remove=function(a){var b;return b=this.observers.indexOf(a),-1!==b?(this.observers.splice(b,1),!0):!1},a.syncing=!1,a.rerun=!1,a.cycles=0,a.max=10,a.timeout=null,a.sync=function(a){var b=this;if(this.syncing)return this.rerun=!0,!1;if(a)return this.timeout?!1:(this.timeout=setTimeout(function(){return b.timeout=null,b.sync()},0),!0);for(this.syncing=!0,this.rerun=!0,this.cycles=0;this.rerun;){if(++this.cycles===this.max)throw"Infinite observer syncing, an observer is calling Observer.sync() too many times";this.rerun=!1;for(var c=0;c<this.observers.length;c++)this.observers[c].sync()}return this.syncing=!1,this.cycles=0,!0},a.immutable=function(a){return Array.isArray(a)?a.slice():a&&"object"==typeof a?this.copyObject(a):a},a.copyObject=function(a){var b,c,d;b={};for(c in a)d=a[c],b[c]=d;return b},a}(),this.Observer=c,"function"==typeof define&&define.amd?define("chip/observer",function(){return c}):"object"==typeof exports&&"object"==typeof module&&(e.Observer=c),b=function(){function a(){}return a.prototype.watch=function(b,d,e){var f,g;return f=a.createBoundFunction(this,b),this.hasOwnProperty("_observers")||(this._observers=[]),g=c.add(f,d,e),this._observers.push(g),g},a.prototype.eval=function(b){return a.createFunction(b).call(this)},a.prototype.getBoundEval=function(){var b,c;return b=arguments[0],c=2<=arguments.length?m.call(arguments,1):[],a.createBoundFunction(this,b,c)},a.prototype.close=function(){var a,b,c,d;if(this._observers){for(d=this._observers,b=0,c=d.length;c>b;b++)a=d[b],a.close();this._observers.length=0}},a.prototype.syncView=function(a){return c.sync(a)},a.prototype.syncNow=function(){var a,b,c,d,e;for(d=this._observers,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.sync());return e},a.keywords=["this","window","true","false"],a.definitions={},a.define=function(a,b){return this.definitions[a]=b},a.getDefinition=function(a){if(!this.definitions.hasOwnProperty(a))throw'Controller definition "'+a+'" does not exist';return this.definitions[a]},a.create=function(b,c,d,e){var f,g,h,i;if("string"==typeof c&&(e=d,d=c,c=void 0),c?(f=function(){},c&&(f.prototype=c),g=new f):g=new a,b.on("elementRemove",function(){return g.close()}),g.element=b,e)for(h in e)n.call(e,h)&&(i=e[h],g[h]=i);return d&&this.getDefinition(d)(g),b.bindTo(g),g},a.exprCache={},a.createFunction=function(a,b){var c,d,e,f;if(null==b&&(b=[]),f=i(a,b),d=this.exprCache[f])return d;try{e=-1===f.indexOf("(")?"try{return "+f+"}catch(e){}":"try{return "+f+"}catch(e){throw"+(" 'Error processing binding expression `"+a.replace(/'/g,"\\'")+"` ' + e}"),d=this.exprCache[f]=Function.apply(null,m.call(b).concat([e]))}catch(g){throw c=g,"Error evaluating code for observer binding: `"+a+"` with error: "+c.message}return d},a.createBoundFunction=function(b,c,d){var e;return e=a.createFunction(c,d),e.bind(b)},a}(),$.event.special.elementRemove={remove:function(a){return a.handler()}},j=/[a-z$_\$][a-z_\$0-9\.-]*\s*:?|'|"/gi,i=function(a,c){var d,e,f,g;for(d=b.keywords.concat(c),g="",e=0;f=j.exec(a);)if(f)if(f=f[0],g+=a.slice(e,j.lastIndex-f.length),"'"===f||'"'===f){for(e=j.lastIndex;e<a.length;)if(e=a.indexOf(f,e)+1,0===e&&(e=a.length),"\\"!==a[e-2]){g+=a.slice(j.lastIndex-1,e);break}j.lastIndex=e}else"."===a[j.lastIndex-f.length-1]?(g+=f,e=j.lastIndex):(":"!==f.slice(-1)&&-1===d.indexOf(f.split(/\.|\(/).shift())&&(g+="this."),g+=f,e=j.lastIndex);return g+=a.slice(e)},this.Controller=b,"function"==typeof define&&define.amd?define("chip/controller",function(){return b}):"object"==typeof exports&&"object"==typeof module&&(e.Controller=b),a=function(){function a(a,b){this.name=a,this.expr=b}return a.prefix="data-",a.blockHandlers={},a.handlers={},a.addHandler=function(a,b){return this.handlers[a]=b},a.addBlockHandler=function(a,b){return this.blockHandlers[a]=b},a.addEventHandler=function(a){return this.addHandler(a,function(b,c,d){return b.on(a,function(a){return a.preventDefault(),d.eval(c)})})},a.addKeyEventHandler=function(a,b){return this.addHandler(a,function(a,c,d){return a.on("keydown",function(a){return a.keyCode===b?(a.preventDefault(),d.eval(c)):void 0})})},a.addAttributeHandler=function(a){return this.addHandler(a,function(b,c,d){return d.watch(c,function(c){return null!=c?b.attr(a,c):b.removeAttr(a)})})},a.addAttributeToggleHandler=function(a){return this.addHandler(a,function(b,c,d){return d.watch(c,function(c){return b.prop(a,c||!1)})})},a.process=function(c,d){var e,f,g,h,i,j;for(d||(d=b.create(c)),h=new RegExp("^"+a.prefix),i=function(a){var b,c,e,f,i,j;for(i=a.get(0),f=null,c=Array.prototype.slice.call(i.attributes).filter(function(a){return h.test(a.name)&&g[a.name.replace(h,"")]}),j=[];c.length;)b=c.shift(),i.hasAttribute(b.name)&&(f=g[b.name.replace(h,"")],e=b.value,i.removeAttribute(b.name),j.push(f(a,e,d)));return j},g=this.blockHandlers,j="["+this.prefix+Object.keys(g).join("],["+this.prefix)+"]";(e=c.find(j)).length;)i(e.first());return g=this.handlers,j="["+this.prefix+Object.keys(g).join("],["+this.prefix)+"]",f=c.filter(j).add(c.find(j)),f.each(function(){return i(jQuery(this))})},a}(),jQuery.fn.bindTo=function(b){return a.process(this,b)},this.Binding=a,"function"==typeof define&&define.amd?define("chip/binding",function(){return a}):"object"==typeof exports&&"object"==typeof module&&(e.Binding=a),a.addHandler("if",function(a,b,c){return c.watch(b,function(b){return b?a.show():a.hide()})}),a.addHandler("bind",function(a,b,c){return c.watch(b,function(b){return a.text(null!=b?b:"")})}),a.addHandler("bind-html",function(a,b,c){return c.watch(b,function(b){return a.html(null!=b?b:"")})}),a.addHandler("class",function(a,b,c){return c.watch(b,function(b){var c,d,e;if(Array.isArray(b)&&(b=b.join(" ")),"string"==typeof b)return a.attr("class",b);if(b&&"object"==typeof b){e=[];for(c in b)n.call(b,c)&&(d=b[c],d?e.push(a.addClass(c)):e.push(a.removeClass(c)));return e}})}),a.addHandler("active",function(a,b,c){var d,e;return b?c.watch(b,function(b){return b?a.addClass("active"):a.removeClass("active")}):(e=function(){return d.length&&d.get(0).href===location.href?a.addClass("active"):a.removeClass("active")},d=a.filter('a[href],a[data-attr^="href:"]').add(a.find('a[href],a[data-attr^="href:"]')).first(),d.attr("data-href")&&d.on("hrefChanged",e),$(document).on("urlChange",e),a.on("elementRemove",function(){return $(document).off("urlChange",e)}),e())}),Path.onchange=function(){return $(document).trigger("urlChange")},a.addHandler("value",function(a,b,c){var d,e;return d=c.watch(b,function(b){return a.val()!==b?a.val(b):void 0}),e=c.getBoundEval(b+" = value","value"),a.on("keydown keyup",function(){return a.val()!==d.oldValue?(e(a.val()),d.skipNextSync(),c.syncView()):void 0})}),["click","dblclick","submit","change","focus","blur"].forEach(function(b){return a.addEventHandler(b)}),g={enter:13,esc:27};for(h in g)n.call(g,h)&&(f=g[h],a.addKeyEventHandler(h,f));for(d=["href","src"],k=0,l=d.length;l>k;k++)h=d[k],a.addAttributeHandler(h);["checked","disabled"].forEach(function(b){return a.addAttributeToggleHandler(b)}),a.addBlockHandler("repeat",function(a,c,d){var e,f,g,h,i,j,k;return k=c.split(/\s+in\s+/),i=k[0],c=k[1],e=a.attr("data-controller"),a.removeAttr("data-controller"),j=a,a=$('<script type="text/repeat-placeholder"><!--data-repeat="'+c+'"--></script>').replaceAll(j),g=$(),h={},f=function(a){var c;return c=j.clone(),h[i]=a,b.create(c,d,e,h),c.get(0)},d.watch(c,function(b,c){if(c){if(Array.isArray(b))return c.forEach(function(c){var d,e,h,i,j;for(e=[c.index,c.removed.length],i=[],d=c.index;d<c.index+c.addedCount;)h=b[d],i.push(f(h)),d++;return j=g.splice.apply(g,e.concat(i)),$(j).remove(),0===c.index?a.after(i):g.eq(c.index-1).after(i)})}else if(g.remove(),g=$(),Array.isArray(b))return b.forEach(function(a){return g.push(f(a))}),a.after(g)})}),a.addBlockHandler("partial",function(a,c,d){var f,g,i,j;return j=c.split(/\s+as\s+\s+with\s+/),h=j.pop(),c=j[0],g=j[1],c&&g&&(f={},f[g]=d.eval(c),d.watch(c,!0,function(a){return i[g]=a})),a.html(e.getTemplate(h)),i=b.create(a,d,h,f)}),a.addBlockHandler("controller",function(a,c,d){return b.create(a,d,c)}),function(){var a,b,c,d,f,g,h,i,j,k,l;return g={},g.object=function(a,b){var c,d,e,f;c=[];for(f in b)e=b[f],d=a[f],(void 0===d||d!==e)&&(f in a?d!==e&&c.push(h(a,"updated",f,e)):c.push(h(a,"deleted",f,e)));for(f in a)d=a[f],f in b||c.push(h(a,"new",f));return Array.isArray(a)&&a.length!==b.length&&c.push(h(a,"updated","length",b.length)),c},h=function(a,b,c,d){return{object:a,type:b,name:c,oldValue:d}},c=0,d=1,a=2,b=3,g.array=function(e,g){var h,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(m=0,h=e.length,s=0,q=g.length,p=Math.min(h,q),v=j(e,g,p),y=k(e,g,p-v),m+=v,s+=v,h-=y,q-=y,0===h-m&&0===q-s)return[];if(m===h)return[i(m,g.slice(s,q),0)];if(s===q)return[i(m,[],h-m)];for(n=f(e,m,h,g,s,q),u=l(n),w=void 0,x=[],o=m,r=s,z=0,A=u.length;A>z;z++)t=u[z],t===c?(w&&(x.push(w),w=void 0),o++,r++):t===d?(w||(w=i(o,[],0)),w.addedCount++,o++,w.removed.push(g[r]),r++):t===a?(w||(w=i(o,[],0)),w.addedCount++,o++):t===b&&(w||(w=i(o,[],0)),w.removed.push(g[r]),r++);return w&&x.push(w),x},j=function(a,b,c){var d,e;for(d=e=0;c>=0?c>e:e>c;d=c>=0?++e:--e)if(a[d]!==b[d])return d;return length},k=function(a,b,c){var d,e,f;for(e=a.length,f=b.length,d=0;c>d&&a[--e]===b[--f];)d++;return d},i=function(a,b,c){return{index:a,removed:b,addedCount:c}},l=function(e){var f,g,h,i,j,k,l,m;for(h=e.length-1,i=e[0].length-1,f=e[h][i],g=[];h>0||i>0;)0!==h?0!==i?(l=e[h-1][i-1],m=e[h-1][i],k=e[h][i-1],j=k>m?l>m?m:l:l>k?k:l,j===l?(l===f?g.push(c):(g.push(d),f=l),h--,i--):j===m?(g.push(b),h--,f=m):(g.push(a),i--,f=k)):(g.push(b),h--):(g.push(a),i--);return g.reverse(),g},f=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q;for(l=f-e+1,g=c-b+1,h=new Array(l),i=n=0;l>=0?l>n:n>l;i=l>=0?++n:--n)h[i]=new Array(g),h[i][0]=i;for(j=o=0;g>=0?g>o:o>g;j=g>=0?++o:--o)h[0][j]=j;for(i=p=1;l>=1?l>p:p>l;i=l>=1?++p:--p)for(j=q=1;g>=1?g>q:q>g;j=g>=1?++q:--q)a[b+j-1]===d[e+i-1]?h[i][j]=h[i-1][j-1]:(k=h[i-1][j]+1,m=h[i][j-1]+1,h[i][j]=m>k?k:m);return h},this.equality=g,"function"==typeof define&&define.amd?define("chip/equality",function(){return g}):"object"==typeof exports&&"object"==typeof module?e.equality=g:void 0}.call(this)}.call(this);